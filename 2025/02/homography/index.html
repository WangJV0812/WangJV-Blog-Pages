<!doctype html><html><!doctype html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>homography - WangJV Blog</title><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="homography"><meta itemprop=description content="假设我们有两个坐标系 $\mathcal F_a, \ \mathcal F_b$，有一个点 $P$ 在一个平面上。在两个坐标系下，这个点可以描述为 $\rho_a, \rho_b$；对应的平面可以通过法向量和截距来描述：$\{n_a. d_a\}, \{n_b. d_b\}$。
此外，该点有在图像坐标系下的描述 $p_a, p_b$ 和对应的相机矩阵 $K_a, K_b$。那么可以写出：
$$ \begin{aligned} p_a = \frac{1}{z_a} K_a \rho_a \\ p_b = \frac{1}{z_b} K_b \rho_b \end{aligned} $$此外， 由于该点在对应的平面上，有平面约束：
$$ \begin{aligned} n^T_a \rho_a + d_a = 0 \\ n^T_b \rho_b + d_b = 0 \end{aligned} $$那么，将平面约束中的 $\rho$ 通过投影矩阵转换为像素坐标，有：
$$ \begin{aligned} &amp;z_a n^T_a K_a^{-1} p_a + d_a = 0\\ &amp;z_a = -\frac{d_a}{n^T_a K_a^{-1} p_a}\\ &amp;z_b n^T_b K_b^{-1} p_b + d_b = 0\\ &amp;z_b = -\frac{d_b}{n^T_b K_b^{-1} p_b}\\ \end{aligned} $$带入到 $\rho_a, \rho_b$ 的表达式中，有："><meta itemprop=datePublished content="2025-02-14T17:13:56+08:00"><meta itemprop=dateModified content="2025-02-14T17:13:56+08:00"><meta itemprop=wordCount content="236"><meta property="og:url" content="https://wangjv0812.github.io/WangJV-Blog-Pages/2025/02/homography/"><meta property="og:site_name" content="WangJV Blog"><meta property="og:title" content="homography"><meta property="og:description" content="假设我们有两个坐标系 $\mathcal F_a, \ \mathcal F_b$，有一个点 $P$ 在一个平面上。在两个坐标系下，这个点可以描述为 $\rho_a, \rho_b$；对应的平面可以通过法向量和截距来描述：$\{n_a. d_a\}, \{n_b. d_b\}$。
此外，该点有在图像坐标系下的描述 $p_a, p_b$ 和对应的相机矩阵 $K_a, K_b$。那么可以写出：
$$ \begin{aligned} p_a = \frac{1}{z_a} K_a \rho_a \\ p_b = \frac{1}{z_b} K_b \rho_b \end{aligned} $$此外， 由于该点在对应的平面上，有平面约束：
$$ \begin{aligned} n^T_a \rho_a + d_a = 0 \\ n^T_b \rho_b + d_b = 0 \end{aligned} $$那么，将平面约束中的 $\rho$ 通过投影矩阵转换为像素坐标，有：
$$ \begin{aligned} &amp;z_a n^T_a K_a^{-1} p_a + d_a = 0\\ &amp;z_a = -\frac{d_a}{n^T_a K_a^{-1} p_a}\\ &amp;z_b n^T_b K_b^{-1} p_b + d_b = 0\\ &amp;z_b = -\frac{d_b}{n^T_b K_b^{-1} p_b}\\ \end{aligned} $$带入到 $\rho_a, \rho_b$ 的表达式中，有："><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-14T17:13:56+08:00"><meta property="article:modified_time" content="2025-02-14T17:13:56+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="homography"><meta name=twitter:description content="假设我们有两个坐标系 $\mathcal F_a, \ \mathcal F_b$，有一个点 $P$ 在一个平面上。在两个坐标系下，这个点可以描述为 $\rho_a, \rho_b$；对应的平面可以通过法向量和截距来描述：$\{n_a. d_a\}, \{n_b. d_b\}$。
此外，该点有在图像坐标系下的描述 $p_a, p_b$ 和对应的相机矩阵 $K_a, K_b$。那么可以写出：
$$ \begin{aligned} p_a = \frac{1}{z_a} K_a \rho_a \\ p_b = \frac{1}{z_b} K_b \rho_b \end{aligned} $$此外， 由于该点在对应的平面上，有平面约束：
$$ \begin{aligned} n^T_a \rho_a + d_a = 0 \\ n^T_b \rho_b + d_b = 0 \end{aligned} $$那么，将平面约束中的 $\rho$ 通过投影矩阵转换为像素坐标，有：
$$ \begin{aligned} &amp;z_a n^T_a K_a^{-1} p_a + d_a = 0\\ &amp;z_a = -\frac{d_a}{n^T_a K_a^{-1} p_a}\\ &amp;z_b n^T_b K_b^{-1} p_b + d_b = 0\\ &amp;z_b = -\frac{d_b}{n^T_b K_b^{-1} p_b}\\ \end{aligned} $$带入到 $\rho_a, \rho_b$ 的表达式中，有："><link rel=stylesheet type=text/css media=screen href=https://wangjv0812.github.io/WangJV-Blog-Pages/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://wangjv0812.github.io/WangJV-Blog-Pages/css/main.css><link id=dark-scheme rel=stylesheet type=text/css href=https://wangjv0812.github.io/WangJV-Blog-Pages/css/dark.css><script src=https://wangjv0812.github.io/WangJV-Blog-Pages/js/main.js></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["\\(","\\)"],["$","$"]]},loader:{load:["ui/safe"]}}</script></head><body><div class="container wrapper"><div class=header><h1 class=site-title><a href=https://wangjv0812.github.io/WangJV-Blog-Pages/>WangJV Blog</a></h1><div class=site-description><nav class="nav social"><ul class=flat></ul></nav></div><nav class=nav><ul class=flat></ul></nav></div><div class=post><div class=post-header><div class=meta><div class=date><span class=day>14</span>
<span class=rest>Feb 2025</span></div></div><div class=matter><h1 class=title>homography</h1></div></div><p>假设我们有两个坐标系 $\mathcal F_a, \ \mathcal F_b$，有一个点 $P$ 在一个平面上。在两个坐标系下，这个点可以描述为 $\rho_a, \rho_b$；对应的平面可以通过法向量和截距来描述：$\{n_a. d_a\}, \{n_b. d_b\}$。</p><p>此外，该点有在图像坐标系下的描述 $p_a, p_b$ 和对应的相机矩阵 $K_a, K_b$。那么可以写出：</p>$$
\begin{aligned}
p_a = \frac{1}{z_a} K_a \rho_a \\
p_b = \frac{1}{z_b} K_b \rho_b
\end{aligned}
$$<p>此外， 由于该点在对应的平面上，有平面约束：</p>$$
\begin{aligned}
n^T_a \rho_a + d_a = 0 \\
n^T_b \rho_b + d_b = 0
\end{aligned}
$$<p>那么，将平面约束中的 $\rho$ 通过投影矩阵转换为像素坐标，有：</p>$$
\begin{aligned}
&z_a n^T_a K_a^{-1} p_a + d_a = 0\\
&z_a = -\frac{d_a}{n^T_a K_a^{-1} p_a}\\
&z_b n^T_b K_b^{-1} p_b + d_b = 0\\
&z_b = -\frac{d_b}{n^T_b K_b^{-1} p_b}\\
\end{aligned}
$$<p>带入到 $\rho_a, \rho_b$ 的表达式中，有：</p>$$
\begin{aligned}
\rho_a = -\frac{d_a}{n^T_a K_a^{-1} p_a} K_a^{-1} p_a \\
\rho_b = -\frac{d_b}{n^T_b K_b^{-1} p_b} K_b^{-1} p_b
\end{aligned}
$$<p>我们知道，$\rho_a, \rho_b$ 之间有一个变换矩阵 $T_{ab}$，有：</p>$$
\rho_b = C_ba \rho_a + r_b^{ba}
$$<p>将 $\rho_a, \rho_b$ 变换为像素坐标，有：</p>$$
\begin{aligned}
z_b K_b^{-1} p_b &= C_{ba} z_a K_a^{-1} p_a + r_b^{ba}\\
p_b &= \frac{z_a}{z_b} K_b C_{ba} K_a^{-1} p_a + \frac{1}{z_b}K_b r_b^{ba}
\end{aligned}
$$<p>将 $\frac{1}{z_b}$ 变换为 $\frac{z_a}{z_b}\frac{1}{z_a}$ ，且带入 $r_b^{ab} = -C_{ba} r_a^{ba}$，有：</p>$$
\begin{aligned}
p_b &= \frac{z_a}{z_b} K_b C_{ba} K_a^{-1} p_a + \frac{z_a}{z_b} K_b C_{ba} r_a^{ba}\frac{n^T_a K_a^{-1} p_a}{d_a}\\
&= \frac{z_a}{z_b} K_b C_{ba} K_a^{-1} p_a + \frac{z_a}{z_b} K_b C_{ba} r_a^{ba}\frac{n^T_a}{d_a} K_a^{-1} p_a\\
&= \frac{z_a}{z_b} K_b C_{ba} \left(
1 + \frac{r_a^{ba}n^T_a}{d_a}
\right)K_a^{-1}p_a
\end{aligned}
$$<p>其中 $\frac{z_a}{z_b}$ 为一个系数，可以被齐次坐标吸收。有：</p>$$
p_b = K_b C_{ba} \left(
1 + \frac{r_a^{ba}n^T_a}{d_a}
\right)K_a^{-1}p_a
$$<p>其中：</p>$$
H_{ba} = C_{ba} \left(
1 + \frac{r_a^{ba} n_a^T}{d_a}
\right)
$$<p>我们可以写出：</p>$$
K_b^{-1} p_b = H_{ba} K_a^{-1} p_a
$$<p>我们可以这样理解：</p><ol><li>$K_b^{-1} p_b$ 和 $K_a^{-1} p_a$ 为归一化坐标系下的点</li><li>$H_{ba}$ 为一个 $3 \times 3$ 的矩阵，描述了两个归一化坐标系之间的变换</li></ol><hr class=footer-separator><div class=tags></div><div class=back><a href=https://wangjv0812.github.io/WangJV-Blog-Pages/><span aria-hidden=true>← Back</span></a></div><div class=back></div></div></div><div class="footer wrapper"><nav class=nav><div>2025</div></nav></div></body></html>