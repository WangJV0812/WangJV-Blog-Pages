<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>From Diffusion to Diffusion Language Model | WangJV Blog</title><meta name=keywords content="ç¥ç»ç½‘ç»œ,ç”Ÿæˆæ¨¡å‹,diffusion,è¯­è¨€æ¨¡å‹"><meta name=description content="
å¯¹äºç°åœ¨çš„å¤§æ¨¡å‹ï¼Œæ™®éä½¿ç”¨è‡ªå›å½’æ¨¡å‹ã€‚å¯¹äºä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ–‡æœ¬ï¼Œè‡ªå›å½’æ¨¡å‹å°†å…¶åˆ†è§£ä¸ºï¼š
$$
P(x_{1:n}) = \prod_{i=1}^n P(x_i \mid x_{"><meta name=author content="WangJV"><link rel=canonical href=https://wangjv0812.cn/2025/11/from-diffusion-to-diffusion-language-model/><link crossorigin=anonymous href=https://wangjv0812.cn/assets/css/stylesheet.2211ca3164be7830024f6aad2b3a2e520843a64f8f048445c3401c1249aa051d.css integrity="sha256-IhHKMWS+eDACT2qtKzouUghDpk+PBIRFw0AcEkmqBR0=" rel="preload stylesheet" as=style><link rel=icon href=https://wangjv0812.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wangjv0812.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wangjv0812.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://wangjv0812.cn/apple-touch-icon.png><link rel=mask-icon href=https://wangjv0812.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://wangjv0812.cn/2025/11/from-diffusion-to-diffusion-language-model/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["\\(","\\)"],["$","$"]],processEscapes:!0,processEnvironments:!0,tags:"ams"},chtml:{scale:1,minScale:.5,matchFontHeight:!1,displayAlign:"center",displayIndent:"0",mtextInheritFont:!1,merrorInheritFont:!0,mathmlSpacing:!1,skipHtmlTags:["script","noscript","style","textarea","pre","code","a"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"},svg:{scale:1,minScale:.5,mtextInheritFont:!1,merrorInheritFont:!0,mathmlSpacing:!1,skipHtmlTags:["script","noscript","style","textarea","pre","code","a"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"},options:{enableMenu:!0,menuOptions:{settings:{zoom:"Click"}}},loader:{load:["ui/safe","a11y/assistive-mml"]},startup:{ready(){MathJax.startup.defaultReady();const e=new ResizeObserver(e=>{MathJax.typesetPromise()});e.observe(document.body)}}},window.innerWidth<=768&&(MathJax.chtml=MathJax.chtml||{},MathJax.chtml.scale=.9)</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><style>.MathJax{outline:0}@media(max-width:768px){.MathJax{font-size:90%!important}.MathJax_Display{overflow-x:auto;overflow-y:hidden;padding:0!important;margin:1em 0!important}.MathJax_CHTML{line-height:1.2!important}}mjx-container[jax=CHTML][display=true]{overflow-x:auto;overflow-y:hidden;padding:1px 0}</style><meta property="og:url" content="https://wangjv0812.cn/2025/11/from-diffusion-to-diffusion-language-model/"><meta property="og:site_name" content="WangJV Blog"><meta property="og:title" content="From Diffusion to Diffusion Language Model"><meta property="og:description" content="
å¯¹äºç°åœ¨çš„å¤§æ¨¡å‹ï¼Œæ™®éä½¿ç”¨è‡ªå›å½’æ¨¡å‹ã€‚å¯¹äºä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ–‡æœ¬ï¼Œè‡ªå›å½’æ¨¡å‹å°†å…¶åˆ†è§£ä¸ºï¼š
$$ P(x_{1:n}) = \prod_{i=1}^n P(x_i \mid x_{"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-04T18:35:25+08:00"><meta property="article:modified_time" content="2025-11-04T18:35:25+08:00"><meta property="article:tag" content="ç¥ç»ç½‘ç»œ"><meta property="article:tag" content="ç”Ÿæˆæ¨¡å‹"><meta property="article:tag" content="Diffusion"><meta property="article:tag" content="è¯­è¨€æ¨¡å‹"><meta property="og:image" content="https://wangjv0812.cn/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://wangjv0812.cn/"><meta name=twitter:title content="From Diffusion to Diffusion Language Model"><meta name=twitter:description content="
å¯¹äºç°åœ¨çš„å¤§æ¨¡å‹ï¼Œæ™®éä½¿ç”¨è‡ªå›å½’æ¨¡å‹ã€‚å¯¹äºä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ–‡æœ¬ï¼Œè‡ªå›å½’æ¨¡å‹å°†å…¶åˆ†è§£ä¸ºï¼š
$$
P(x_{1:n}) = \prod_{i=1}^n P(x_i \mid x_{"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wangjv0812.cn/posts/"},{"@type":"ListItem","position":2,"name":"From Diffusion to Diffusion Language Model","item":"https://wangjv0812.cn/2025/11/from-diffusion-to-diffusion-language-model/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"From Diffusion to Diffusion Language Model","name":"From Diffusion to Diffusion Language Model","description":"\nå¯¹äºç°åœ¨çš„å¤§æ¨¡å‹ï¼Œæ™®éä½¿ç”¨è‡ªå›å½’æ¨¡å‹ã€‚å¯¹äºä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ–‡æœ¬ï¼Œè‡ªå›å½’æ¨¡å‹å°†å…¶åˆ†è§£ä¸ºï¼š\n$$ P(x_{1:n}) = \\prod_{i=1}^n P(x_i \\mid x_{","keywords":["ç¥ç»ç½‘ç»œ","ç”Ÿæˆæ¨¡å‹","diffusion","è¯­è¨€æ¨¡å‹"],"articleBody":"\nå¯¹äºç°åœ¨çš„å¤§æ¨¡å‹ï¼Œæ™®éä½¿ç”¨è‡ªå›å½’æ¨¡å‹ã€‚å¯¹äºä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ–‡æœ¬ï¼Œè‡ªå›å½’æ¨¡å‹å°†å…¶åˆ†è§£ä¸ºï¼š\n$$ P(x_{1:n}) = \\prod_{i=1}^n P(x_i \\mid x_{","wordCount":"10","inLanguage":"en","image":"https://wangjv0812.cn/","datePublished":"2025-11-04T18:35:25+08:00","dateModified":"2025-11-04T18:35:25+08:00","author":{"@type":"Person","name":"WangJV"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wangjv0812.cn/2025/11/from-diffusion-to-diffusion-language-model/"},"publisher":{"@type":"Organization","name":"WangJV Blog","logo":{"@type":"ImageObject","url":"https://wangjv0812.cn/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wangjv0812.cn/ accesskey=h title="WangJV Blog (Alt + H)">WangJV Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wangjv0812.cn/ title=Home><span>Home</span></a></li><li><a href=https://wangjv0812.cn/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://wangjv0812.cn/resources/ title=Resources><span>Resources</span></a></li><li><a href=https://wangjv0812.cn/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://wangjv0812.cn/search/ title="ğŸ” Search (Alt + /)" accesskey=/><span>ğŸ” Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wangjv0812.cn/>Home</a>&nbsp;Â»&nbsp;<a href=https://wangjv0812.cn/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">From Diffusion to Diffusion Language Model</h1><div class=post-meta><span title='2025-11-04 18:35:25 +0800 +0800'>November 4, 2025</span>&nbsp;Â·&nbsp;WangJV&nbsp;|&nbsp;<a href=https://github.com/WangJV0812/WangJV-Blog-Source/tree/master/content/posts/From%20Diffusion%20to%20Diffusion%20Language%20Model/Index.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#1-æ— ç›‘ç£å­¦ä¹ å’Œæµå½¢å‡è¯´>1. æ— ç›‘ç£å­¦ä¹ å’Œæµå½¢å‡è¯´</a></li><li><a href=#2-continuous-diffusion>2. Continuous Diffusion</a><ul><li><a href=#21-forward-process>2.1. Forward Process</a></li><li><a href=#22-backward-process>2.2. Backward Process</a></li><li><a href=#23-diffusion-çš„æ¨ç†>2.3. diffusion çš„æ¨ç†</a></li><li><a href=#24-è®­ç»ƒ>2.4. è®­ç»ƒ</a></li></ul></li><li><a href=#3-ç¦»æ•£æ¦‚ç‡åˆ†å¸ƒçš„æ‰©æ•£è¿‡ç¨‹>3. ç¦»æ•£æ¦‚ç‡åˆ†å¸ƒçš„æ‰©æ•£è¿‡ç¨‹</a><ul><li><a href=#31-forward-diffusion>3.1. forward diffusion</a></li><li><a href=#32-reversed-diffusion>3.2. reversed diffusion</a></li><li><a href=#33-training>3.3. training</a></li></ul></li><li><a href=#4-å¸¸è§çš„-diffusion-language-model-ç»“æ„>4. å¸¸è§çš„ diffusion Language Model ç»“æ„</a><ul><li><a href=#41-masked-diffusion-model>4.1. Masked Diffusion Model</a></li><li><a href=#42-block-diffusion-model>4.2. Block Diffusion Model</a></li><li><a href=#43-flexible-length-masked-diffusion>4.3. Flexible-Length Masked Diffusion</a></li></ul></li><li><a href=#reference>Reference</a></li><li><a href=#appendix>Appendix</a><ul><li><a href=#appendix-a-diffusion-training-è¿‡ç¨‹çš„æ¨å¯¼>Appendix A. diffusion training è¿‡ç¨‹çš„æ¨å¯¼</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p><img alt="alt text" loading=lazy src=https://wangjv0812.cn/2025/11/from-diffusion-to-diffusion-language-model/posts/From%20Diffusion%20to%20Diffusion%20Language%20Model/Images/DLMinrecentyear.png></p><p>å¯¹äºç°åœ¨çš„å¤§æ¨¡å‹ï¼Œæ™®éä½¿ç”¨è‡ªå›å½’æ¨¡å‹ã€‚å¯¹äºä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ–‡æœ¬ï¼Œè‡ªå›å½’æ¨¡å‹å°†å…¶åˆ†è§£ä¸ºï¼š</p>$$
P(x_{1:n}) = \prod_{i=1}^n P(x_i \mid x_{<i}) $$<p>è¿™ä¹Ÿæ˜¯åœ¨åšè‡ªå›å½’æ—¶ï¼Œä½¿ç”¨ Decoder Only çš„åŸå› ã€‚ä½†æ˜¯ä¸€ä¸ªæ¸…æ™°çš„é—®é¢˜æ˜¯ï¼Œè‡ªå›å½’æ¨¡å‹æ˜¯è‡ªç„¶è¯­è¨€æ¨¡å‹çš„å”¯ä¸€é€‰æ‹©å—ï¼Ÿç­”æ¡ˆå¯èƒ½ä¸æ˜¯100%çš„ä¸ã€‚diffusion ä¼¼ä¹æ˜¯ä¸€ä¸ªå¾ˆç¬¦åˆç›´æ¥çš„æ¨ç†è¿‡ç¨‹ï¼Œå®ƒä¼šå…ˆå†™å‡ºä¸€ä¸ªæ–‡æœ¬çš„è‰ç¨¿ï¼Œä¹‹åå†å¯¹è‰ç¨¿ä¸æ–­ä¿®æ”¹ï¼ˆé™å™ªï¼‰ï¼Œæœ€ç»ˆå¾—åˆ°å®Œæ•´çš„æ–‡æœ¬ã€‚</p><h2 id=1-æ— ç›‘ç£å­¦ä¹ å’Œæµå½¢å‡è¯´>1. æ— ç›‘ç£å­¦ä¹ å’Œæµå½¢å‡è¯´<a hidden class=anchor aria-hidden=true href=#1-æ— ç›‘ç£å­¦ä¹ å’Œæµå½¢å‡è¯´>#</a></h2><p>å¯¹äºç»å…¸çš„æ— ç›‘ç£å­¦ä¹ ä»»åŠ¡ï¼Œæˆ‘ä»¬é¢å¯¹çš„æ˜¯å·¨é‡çš„ã€å¸¸å¸¸é«˜ç»´çš„ã€æ²¡æœ‰äººå·¥æå–ç‰¹å¾çš„åŸå§‹æ•°æ®ã€‚æ— ç›‘ç£å­¦ä¹ æœ€æ ¸å¿ƒçš„ä»»åŠ¡æ˜¯åœ¨æ‰¾åˆ°è¿™äº›æ•°æ®ä¹‹é—´çš„ç›¸å¯¹å…³ç³»æå–å‡ºæ•°æ®çš„å†…åœ¨ç»“æ„ã€‚æˆ‘ä»¬ä¸å¦¨ä»¥å›¾åƒç”Ÿæˆä»»åŠ¡ä¸¾ä¾‹å­ï¼Œå¯¹äºä¸€ä¸ªå°ºå¯¸ä¸º $1920\times 1080$ çš„å›¾ç‰‡ï¼Œå…¶åƒç´ æ€»é‡ä¸º $2073600$ã€‚ä½†æ˜¯è¿™äº›ç»´åº¦ä¹‹ä¸å¯èƒ½æ˜¯ç‹¬ç«‹çš„ï¼ˆå› ä¸ºå¦‚æœå®Œå…¨ç‹¬ç«‹ï¼Œåªèƒ½å¾—åˆ°æ²¡æœ‰ä»»ä½•ä¿¡æ¯çš„çº¯å™ªå£°ï¼‰ï¼Œæ•°æ®çš„ç»´åº¦ä¹‹é—´å­˜åœ¨ç€å¤æ‚çš„ç›¸å…³æ€§è´¨ã€‚æ¢å¥è¯è¯´ï¼Œå¯¹äºå›¾åƒæ•°æ®ï¼Œæ•°æ®ç‚¹å¹¶ä¸æ˜¯å‡åŒ€çš„åˆ†å¸ƒåœ¨ $2073600$ ç»´çš„ç©ºé—´ä¸­ï¼Œå®ƒåªåˆ†å¸ƒåœ¨ç©ºé—´ä¸­çš„ä¸€å°éƒ¨åˆ†åŒºåŸŸï¼Œæˆ–è€…ç”¨å¾®åˆ†å‡ ä½•çš„è¯­è¨€æè¿°ï¼Œæ•°æ®åˆ†å¸ƒåœ¨ä¸€ä¸ªé«˜ç»´ç©ºé—´ä¸­çš„ä¸€æ¡æµå½¢ï¼ˆmanifoldï¼‰ä¸Šã€‚è¿™å°±æ˜¯æµå½¢å‡è¯´ï¼ˆmanifold hypothesisï¼‰ï¼Œå®ƒæ˜¯æ— ç›‘ç£å­¦ä¹ çš„ç†è®ºåŸºç¡€ã€‚é‚£ä¹ˆæ— ç›‘ç£å­¦ä¹ çš„ä»»åŠ¡å°±å˜æˆäº†å¦‚ä½•ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œæ¥å»ºæ¨¡è¿™æ¡æµå½¢ã€‚ä¸€ä¸ªå¾ˆæ˜¾ç„¶çš„æµå½¢å»ºæ¨¡å·¥å…·æ˜¯ä½¿ç”¨æ¦‚ç‡åˆ†å¸ƒï¼Œå¯¹äºä¸æ•°æ®æµå½¢ä¸Šçš„ç‚¹ï¼Œæ¦‚ç‡èµ‹ $0$ å°±å¥½äº†ã€‚</p><p>å…³äºæµå½¢å‡è¯´çš„æ›´å¤šè®¨è®ºï¼Œå¯ä»¥å‚è€ƒ <a href=https://wangjv0812.cn/2025/08/noise-contrastive-estimation/#1-%E5%8A%A8%E6%9C%BA>Noise Contrastive Estimation/1. åŠ¨æœº</a> ä¸­å¯¹äºä½¿ç”¨æ¦‚ç‡åˆ†å¸ƒå»ºæ¨¡æ•°æ®åˆ†å¸ƒæµå½¢çš„è®¨è®ºã€‚</p><h2 id=2-continuous-diffusion>2. Continuous Diffusion<a hidden class=anchor aria-hidden=true href=#2-continuous-diffusion>#</a></h2><p>Diffusion æ¨¡å‹å¯èƒ½æ˜¯ç›®å‰æœ€æˆåŠŸçš„é«˜ç»´è¿ç»­æ•°æ®çš„å»ºæ¨¡å·¥å…·ã€‚ç›¸æ¯”äº <a href=https://wangjv0812.cn/2025/10/variational-autoencoder/>VAE</a>ã€GANã€<a href=https://wangjv0812.cn/2025/08/scorematching/>Score Matching</a> ç­‰ï¼ŒDiffusion å¾ˆæ ¸å¿ƒçš„ä¼˜åŠ¿åœ¨äº<strong>å®ƒæ˜¾ç¤ºå¼çš„ç»™å‡ºäº†ä¸€æ¡å›¾åƒç”Ÿæˆçš„è·¯å¾„ï¼ˆä»å™ªå£°åˆ°æ•°æ®ï¼‰ï¼Œå¤§å¤§å‡å°‘äº†ç”Ÿæˆå™¨æ‰€éœ€è¦æœç´¢çš„ç©ºé—´èŒƒå›´</strong>ã€‚å¦‚æœä½ ç°åœ¨å¯¹è¿™å¥è¯ä¸€å¤´é›¾æ°´ï¼Œä¸å¦¨å…ˆå¯¹å®ƒæœ‰ä¸€ä¸ªå¤§æ¦‚çš„å°è±¡ï¼Œçœ‹å®Œæœ¬èŠ‚åå¾ˆå¤§æ¦‚ç‡ä¼šæœ‰ä¸€ä¸ªè·Ÿæ·±åˆ»çš„è®¤è¯†ã€‚</p><p>Diffusion æ¨¡å‹å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªè¿‡ç¨‹ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ol><li>Forward Processï¼Œå‘åŸå§‹æ•°æ®æ·»åŠ å™ªå£°ï¼Œäº‹å®ä¸Šå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ•°æ®å¢å¼ºçš„è¿‡ç¨‹ã€‚</li><li>Backward Processï¼Œä»å™ªå£°ä¸­æ¢å¤æ•°æ®çš„è¿‡ç¨‹ï¼Œå¯ä»¥ç†è§£ä¸º Diffusion çš„æ¨ç†ã€‚</li><li>è®­ç»ƒè¿‡ç¨‹ï¼Œè®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œæ¥å­¦ä¹  Backward Processã€‚</li></ol><h3 id=21-forward-process>2.1. Forward Process<a hidden class=anchor aria-hidden=true href=#21-forward-process>#</a></h3><p>å¯¹äºä¸€ä¸ªæ•°æ®æ ·æœ¬ $x$ï¼Œä¸å¦¨å°†å…¶æ ‡è®°ä¸º $x_0$ï¼Œåœ¨åé¢çš„è®¨è®ºä¸­ï¼Œå¯ä»¥å°† $x_0$ è§†ä½œä¸€ä¸ªç¡®å®šæ€§å˜é‡ã€‚Diffusion è¿‡ç¨‹æ¯ä¸€æ­¥éƒ½å‘åŸå§‹æ•°æ®æ·»åŠ ä¸€ä¸ªå¾ˆå°çš„å™ªå£°ï¼Œæ·»åŠ å™ªå£°çš„è¿‡ç¨‹ä¸å¦¨ç”¨ä¸€ä¸ªæ¡ä»¶æ¦‚ç‡æè¿°ï¼š</p>$$
p(x_t \mid x_{t-1}) = \mathcal{N}(x_t; \sqrt{1 - \beta_t} x_{t-1}, \beta_t I)
$$<p>å…¶ä¸­ $\beta_t \in (0, 1)$ï¼Œæ˜¯ä¸€ä¸ªç”¨äºæ§åˆ¶å™ªå£°å¤§å°çš„è¶…å‚æ•°ã€‚æˆ‘ä»¬å¸Œæœ›æ±‚å¾— $x_t$ åœ¨ $x_0$ ä¸‹çš„æ¡ä»¶åˆ†å¸ƒï¼š</p>$$
p(x_t \mid x_0) = \int p(x_{t:1} \mid x_0) dx_{t-1: 1}
$$<p>ä½†æ˜¯è¿™ä¸ªå½¢å¼å‡ ä¹æ˜¯æ— æ³•è®¡ç®—çš„ï¼Œå¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é«˜æ–¯åˆ†å¸ƒçš„ä¼ é€’æ€§æ¨å¯¼ï¼š</p>$$
x_t = \sqrt{1-\beta_t} x_{t-1} + \sqrt{\beta_t} \epsilon_{t-1}, \quad \epsilon_{t-1} \sim \mathcal{N}(0, I)
$$<p>å°†ä¸Šé¢çš„å½¢å¼è¿­ä»£å±•å¼€ï¼Œæœ‰ï¼š</p>$$
\begin{aligned}
x_t
&= \sqrt{1-\beta_t} x_{t-1} + \sqrt{\beta_t} \epsilon_{t-1}\\
&= \sqrt{1-\beta_t} \left(\sqrt{1-\beta_{t-1}} x_{t-1} + \sqrt{\beta_{t-1}} \epsilon_{t-1}\right) + \sqrt{\beta_t} \epsilon_{t-1}\\
&= \sqrt{(1-\beta_t)((1-\beta_{t-1}))}x_{t-1} + \sqrt{(1 - \beta_t)\beta_{t-1}} \epsilon_{t-1} + \sqrt{\beta_t} \epsilon_{t-1}\\
\end{aligned}
$$<p>åå¤è¿­ä»£åˆ° $x_0$ï¼Œæœ‰ï¼š</p>$$
x_t = \left(\prod_i^t \sqrt{1 - \beta_i} x_0 \right) + \sum_i^t \left(\sqrt{\beta_i} \prod_{j=i+1}^t \sqrt{1 - \beta_j} \right)\epsilon_i
$$<p>ä¸å¦¨ä»¤ï¼š</p>$$
\alpha_t = \prod_{i=1}^t (1 - \beta_i)
$$<p>ä½¿ç”¨é€’æ¨æ³•ä¸éš¾å¯¼å‡ºï¼š</p>$$
\begin{aligned}
1 - \alpha_t
&= 1 - \prod_{i=1}^t (1 - \beta_i)\\
&= \sum_{i=1}^t \left(\beta_i \prod_{j=i+1}^t (1 - \beta_j)\right)
\end{aligned}
$$<p>é‚£ä¹ˆä¸Šé¢çš„å¼å­å¯ä»¥ç®€åŒ–ä¸ºï¼š</p>$$
x_t = \sqrt{\alpha_t} x_0 + \sqrt{1 - \alpha_t} \epsilon, \quad \epsilon \sim \mathcal{N}(0, I)
$$<p>é‚£ä¹ˆæœ‰ï¼š</p>$$
p(x_t\mid x_0) = \mathcal N(x_t; \sqrt{\alpha_t} x_0, (1 - \alpha_t) I)
$$<p><img alt="forward process diffusion noise" loading=lazy src=https://wangjv0812.cn/2025/11/from-diffusion-to-diffusion-language-model/posts/From%20Diffusion%20to%20Diffusion%20Language%20Model/Images/diffusionnoise.jpg></p><h3 id=22-backward-process>2.2. Backward Process<a hidden class=anchor aria-hidden=true href=#22-backward-process>#</a></h3><p>å¯¹äºæ¨ç†ï¼Œæˆ‘ä»¬å¸Œæœ›å¯¹ $p(x_0)$ é‡‡æ ·æ¥ç”Ÿæˆæ•°æ®ã€‚å¯¹äº $p(x_0)$ï¼Œæˆ‘ä»¬æœ‰ï¼š</p>$$
\begin{aligned}
p(x_0)
&= \int p(x_{0: T}) dx_{1:T}\\
&= \int p(x_T) \prod_{t=1}^T p(x_{t-1} \mid x_t) dx_{1:T}
\end{aligned}
$$<p>æˆ‘ä»¬å¯ä»¥ä¸ç›´æ¥å¯¹ $p(x_0)$ é‡‡æ ·ï¼Œè€Œæ˜¯å¯¹è”åˆåˆ†å¸ƒ $p(x_{0: T})$ é‡‡æ ·ã€‚å°†å…¶ä¸­å…³äº $x_0$ çš„éƒ¨åˆ†æ‹¿å‡ºæ¥ï¼Œå°±ç­‰ä»·äºå¯¹ $p(x_0)$ é‡‡æ ·ã€‚é‚£ä¹ˆåªè¦èƒ½å¯¹ $p(x_{t-1}\mid x_t)$ å»ºæ¨¡ï¼Œå°±å¯ä»¥å®ç°å¯¹ $p(x_0)$ çš„é‡‡æ ·ã€‚ä½†æ˜¯å¦‚æœä½ ä¹‹å‰çœ‹è¿‡ Diffusion ç›¸å…³çš„è®ºæ–‡ï¼Œä¼šå‘ç°å‡ ä¹æ²¡æœ‰ç›´æ¥å­¦ä¹  $p(x_{t-1}\mid x_t)$ çš„ï¼Œè€Œæ˜¯å­¦ä¹  $p(x_{t-1}\mid x_t, x_0)$ã€‚</p><p>è¿™ä¸ªåŸå› å…¶å®å¾ˆå¥½ç†è§£ã€‚å¯¹äº $p(x_{t-1}\mid x_t)$ï¼Œå¯ä»¥ç”¨è´å¶æ–¯å…¬å¼è¡¨ç¤ºï¼š</p>$$
p(x_{t-1} \mid x_t) = \frac{p(x_t \mid x_{t-1}) p(x_{t-1})}{p(x_t)}
$$<p>å…¶ä¸­ $p(x_{t-1})$ æ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„åˆ†å¸ƒï¼Œæ ¹æ®æ­£å‘è¿‡ç¨‹çš„é©¬å°”å¯å¤«æ€§ï¼Œå¯ä»¥ç”¨è´å¶æ–¯å®šç†æ¥æè¿°ï¼š</p>$$
p(x_{t-1}) = \int p(x_{t-1} \mid x_0) p(x_0) dx_0
$$<p>ä»è¿™ä¸ªå½¢å¼ä¸éš¾çœ‹å‡ºï¼Œ $p(x_{t-1})$ å¹¶ä¸æ˜¯ä¸€ä¸ªç®€å•çš„åˆ†å¸ƒï¼Œå®ƒå¯èƒ½æ¥è‡ªäºå¾ˆå¤šæˆªç„¶ä¸åŒçš„ $x_0$ï¼Œæˆ‘ä»¬å‡ ä¹å¯ä»¥è¯´ï¼Œå®ƒä¸€å®šæ˜¯å¤šå³°çš„ï¼Œä¸€å®šæ— æ³•ç”¨ä¸€ä¸ªç®€å•çš„ gaussian åˆ†å¸ƒæ¥æè¿°ã€‚é‚£ä¹ˆ $p(x_{t-1} \mid x_t)$ ä¹Ÿä¼šæ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„åˆ†å¸ƒï¼Œç›´æ¥å¯¹å®ƒå»ºæ¨¡å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ã€‚è¿™å¾ˆå®¹æ˜“ç†è§£ï¼Œ$x_{t}$ çš„ä¿¡æ¯å®¹é‡ä¸€å®šæ˜¯å°äº $x_{t-1}$ çš„ï¼Œæ›´æ˜¾è‘—çš„å°äº $x_0$ã€‚åœ¨ $x_{t}$ åˆ° $x_{t-1}$ çš„æ˜ å°„å‡ ä¹ä¸€å®šä¸æ˜¯ä¸€å¯¹å¤šçš„ã€‚å¯èƒ½å¾ˆå¤šç›¸ä¼¼çš„æ•°æ®è¢«æ˜ å°„åˆ°äº†åŒä¸€ä¸ª $x_t$ çš„æ•°æ®ç‚¹ä¸Šï¼Œå› æ­¤ $p(x_{t-1}\mid x_t)$ ä¸€å®šæ˜¯å¤šå³°çš„ã€‚Jonathan Ho å¤©æ‰èˆ¬çš„æå‡ºäº† x_0 reparameterization trickã€‚</p><p>æˆ‘ä»¬ä¸å¦¨åœ¨æ¡ä»¶ä¸­å¼•å…¥ $x_0$ï¼Œé‚£ä¹ˆæœ‰ï¼š</p>$$
\begin{aligned}
p(x_{t-1} \mid x_t, x_0)
= \frac{p(x_t\mid x_{t-1}, x_0) p(x_{t-1}\mid x_0)}{p(x_t\mid x_0)}
\end{aligned}
$$<p>æ ¹æ®æ­£å‘è¿‡ç¨‹çš„é©¬å°”å¯å¤«æ€§ï¼Œæœ‰ï¼š</p>$$
\begin{gathered}
p(x_t\mid x_{t-1}, x_0) = p(x_t\mid x_{t-1}) = \mathcal N(x_t \mid \sqrt{\alpha_t} x_{t-1}, \beta_t I)\\
p(x_{t-1}\mid x_0) = \mathcal N(x_{t-1} \mid \sqrt{\alpha_{t-1}} x_0, (1 - \alpha_{t-1}) I)\\
p(x_t\mid x_0) = \mathcal N(x_t \mid \sqrt{\alpha_t} x_0, (1 - \alpha_t) I)
\end{gathered}
$$<p>ç”±äºä¸Šé¢ä¸‰ä¸ªåˆ†å¸ƒéƒ½æ˜¯é«˜æ–¯åˆ†å¸ƒï¼Œæ ¹æ®é«˜æ–¯åˆ†å¸ƒçš„ä¹˜ç§¯ä»ç„¶æ˜¯é«˜æ–¯åˆ†å¸ƒçš„æ€§è´¨ï¼Œä¸éš¾æ¨å¯¼å‡ºï¼š</p>$$
p(x_{t-1}\mid x_t, x_0) = \mathcal N(x_{t-1}; \tilde \mu_t(x_t, x_0), \tilde \beta_t I)
$$<p>å…¶ä¸­ï¼š</p>$$
\begin{aligned}
\mu_t(x_t, x_0) &= \frac{\sqrt{\alpha_t}(1 - \bar{\alpha}_{t-1})}{1 - \bar{\alpha}_t} \mathbf{x}_t + \frac{\sqrt{\bar{\alpha}_{t-1}}\beta_t}{1 - \bar{\alpha}_t} \mathbf{x}_0\\
\beta_t &= \frac{1 - \bar{\alpha}_{t-1}}{1 - \bar{\alpha}_t} \beta_t
\end{aligned}
$$<p>å› æ­¤æˆ‘ä»¬åªéœ€è¦ç¥ç»ç½‘ç»œå»é¢„æµ‹ $x_0$ å°±å¥½äº†ã€‚è¿™æ˜¯ diffusion é‡å‚æ•°åŒ–çš„æ–¹æ³•ä¹‹ä¸€ï¼Œç”±äºç›´æ¥é¢„æµ‹çš„åŸå§‹æ•°æ®ï¼Œåœ¨å›¾åƒç­‰ä»»åŠ¡ä¸­æ¯”è¾ƒç›´è§‚ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯ï¼Œä¸éš¾å‘ç°ï¼š</p>$$
x_0 = \frac{1}{\sqrt{\alpha_t}} \left(x_t - \sqrt{1 - \alpha_t} \epsilon\right)
$$<p>é‚£ä¹ˆç­‰ä»·çš„ï¼Œå¯ä»¥è®©ç¥ç»ç½‘ç»œå»é¢„æµ‹å™ªå£° $\epsilon$ï¼Œç„¶åé€šè¿‡ä¸Šé¢çš„å…¬å¼è®¡ç®— $x_0$ã€‚è¿™ç§æ–¹æ³•åœ¨å®è·µä¸­å¾€å¾€æ•ˆæœæ›´å¥½ä¸€äº›ï¼Œè¿™ä¸ªæ–¹æ³•å’Œè®­ç»ƒæ›´å¯¹é½ä¸€äº›ã€‚æˆ‘ä»¬ç§°ä¹‹ä¸º $\epsilon$ reparameterization trickã€‚é‚£ä¹ˆæœ€ç»ˆçš„åå‘è¿‡ç¨‹å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>$$
\begin{aligned}
p(x_{t-1} \mid x_t, x_0)
&\sim \mathcal N(x_{t-1}\mid \tilde \mu_t, \tilde \beta I)
\end{aligned}
$$<p>å…¶ä¸­ï¼š</p>$$
\begin{aligned}
&\tilde{\mu}_t = \frac{1}{\sqrt{\alpha_t}} \Big( \mathbf{x}_t - \frac{1 - \alpha_t}{\sqrt{1 - \bar{\alpha}_t}} \boldsymbol{\epsilon}_t \Big)\\
&\tilde \beta_t = \frac{1 - \bar{\alpha}_{t-1}}{1 - \bar{\alpha}_t} \beta_t
\end{aligned}
$$<h3 id=23-diffusion-çš„æ¨ç†>2.3. diffusion çš„æ¨ç†<a hidden class=anchor aria-hidden=true href=#23-diffusion-çš„æ¨ç†>#</a></h3><p>æˆ‘ä»¬å¸Œæœ›å¯ä»¥é€šè¿‡å¯¹ $p(x_0)$ é‡‡æ ·ï¼Œå®ç°æ•°æ®ç”Ÿæˆã€‚ä½†æ˜¯å°±åƒä¸Šä¸€ç« è¯´è¿‡çš„ï¼Œè¿™å¾ˆéš¾ã€‚æˆ‘ä»¬è½¬è€Œå¯¹è„¸å¾ˆåˆ†å¸ƒé‡‡æ ·ã€‚å½“æˆ‘ä»¬ä½¿ç”¨ $p(x_{t-1}\mid x_t, x_0)$ æ—¶ï¼Œè¿™ä¸ªè”åˆåˆ†å¸ƒå¯ä»¥å†™æˆï¼š</p>$$
p(x_{1:T} \mid x_0) = p(x_T) \prod_{i=1}^{T-1} p(x_{t}\mid x_{t+1}, x_0)
$$<p>å†™æˆè¿™ä¸ªå½¢å¼æ˜¯å› ä¸º $p(x_0\mid x_1, x_0)$ äº‹å®ä¸Šåº”è¯¥è®¤ä¸ºæ˜¯ç¡®å®šæ€§çš„ï¼Œæ²¡æœ‰æ„ä¹‰ã€‚å› æ­¤å¸¸è§çš„ diffusion ä¸€èˆ¬éƒ½åªèƒ½æ¨ç†åˆ° $x_1$ è¿™ä¸€æ­¥ã€‚æ¨ç†è¿‡ç¨‹å¯ä»¥è¿™æ ·ç†è§£ï¼š</p><ol><li>å¯¹ $p(x_T) \sim \mathcal N(0, I)$ é‡‡æ ·ï¼Œå¾—åˆ° $x_T$ã€‚</li><li>å°†é‡‡æ ·å¾—åˆ°çš„ $x_T$ ä»£å…¥ $p(x_{T-1}\mid x_T, x_0)$ï¼Œå¾—åˆ°å¯¹åº”çš„åˆ†å¸ƒå½¢å¼ï¼Œå†è¿›è¡Œé‡‡æ ·ï¼Œå¾—åˆ° $x_{T-1}$ã€‚</li><li>é‡å¤ä¸Šé¢çš„è¿‡ç¨‹ï¼Œç›´åˆ° $x_1$ã€‚</li></ol><p>è¿™äº‹å®ä¸Šå°±æ˜¯å¯¹ $p(x_{1:T} \mid x_0) = p(x_T) \prod_{i=1}^{T-1} p(x_{t}\mid x_{t+1}, x_0)$ çš„è’™ç‰¹å¡æ´›é‡‡æ ·ã€‚</p><h3 id=24-è®­ç»ƒ>2.4. è®­ç»ƒ<a hidden class=anchor aria-hidden=true href=#24-è®­ç»ƒ>#</a></h3><p>æˆ‘ä»¬å‡è®¾æ•°æ®é›† $\{x^0, x^1, \cdots, x^n\}$ æ˜¯ä»ä¸€ä¸ªç†æƒ³åˆ†å¸ƒ $p(x)$ ä¸­é‡‡æ ·å¾—åˆ°çš„ï¼Œå¸Œæœ›æˆ‘ä»¬ç¥ç»ç½‘ç»œå­¦ä¹ åˆ°çš„æ¨¡å‹</p>$$
p_\theta(x) = \int p(x_T)\prod_{t=1}^T p(x_{t-1}\mid x_t; \theta) dx_{1:T}
$$<p>é‚£ä¹ˆå¯ä»¥ç”¨ KL æ•£åº¦è¡¡é‡äºŒè€…ä¹‹é—´çš„ç›¸ä¼¼æ€§å¹¶ç”¨äºä¼˜åŒ–ï¼š</p>$$
\begin{aligned}
&\arg\min_\theta D_{KL}(p(x)\| p_\theta(x))\\
=& \arg\max_\theta \int p(x) \bigg (\log p_\theta(x) - \log p(x)\bigg) dx\\
=& \arg\min_\theta \int p(x) \log p(x)dx\\
=& \arg\max_\theta \mathbb{E}_{x \sim p(x)} [\log p_\theta(x)]\\
\sim& \arg\max_\theta \sum_{i=1}^n \log p_\theta(x^i)
\end{aligned}
$$<p>è¿™å°±æ˜¯æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€‚å› æ­¤æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯ä¼˜åŒ–å¯¹æ•°ä¼¼ç„¶ã€‚ä½†æ˜¯ç›´æ¥ç”¨è¿™ä¸ªå½¢å¼æ— æ³•ç›´æ¥ä¼˜åŒ– diffusion æ‰€å¼•å…¥çš„æ½œå˜é‡($x_{1:T}$)ï¼Œéœ€è¦ä½¿ç”¨ ELBO æ¥ä¼˜åŒ–ï¼š</p>$$
\begin{aligned}
\log p(x)
&= \log \int p(x_{0: T}) dx_{1:T}\\
&= \log \int p(x_{1:T} \mid x_0) \frac{p(x_{0: T})}{p(x_{1:T} \mid x_0)} dx_{1:T}\\
&= \log \mathbb E_{x\sim p(x_{1:T} \mid x_0)}\bigg[ \frac{p(x_{0: T})}{p(x_{1:T} \mid x_0)} \bigg]
\end{aligned}
$$<p>æˆ‘ä»¬çŸ¥é“ï¼Œ$\log$ æ˜¯ä¸€ä¸ªå‡¹å‡½æ•°ï¼Œè€ŒæœŸæœ›ç®—å­æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŠ æ€§æ“ä½œã€‚é‚£æ ¹æ® Jensen ä¸ç­‰å¼ï¼Œæœ‰ï¼š</p>$$
\begin{aligned}
\log p(x)
&\geq \mathbb E_{x\sim p(x_{1:T} \mid x_0)}\bigg[ \log \frac{p(x_{0: T})}{p(x_{1:T} \mid x_0)} \bigg]\\
\end{aligned}
$$<p>å°†æ­£å‘è¿‡ç¨‹å’Œåå‘è¿‡ç¨‹çš„å½¢å¼å¸¦å…¥ï¼Œä¸éš¾è®¡ç®—å‡ºï¼š</p>$$
\begin{aligned}
\log p(x)
&\geq \mathbb E_{q(x_{0:T})} \Big[ \log\frac{q(x_{1:T}\vert x_0)}{p_\theta(x_{0:T})} \Big]\\
&= \mathbb{E}_q [\underbrace{D_\text{KL}(q(\mathbf{x}_T \vert \mathbf{x}_0) \parallel p_\theta(\mathbf{x}_T))}_{L_T} + \sum_{t=2}^T \underbrace{D_\text{KL}(q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0) \parallel p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t))}_{L_{t-1}} \underbrace{- \log p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)}_{L_0} ]
\end{aligned}
$$<p>å¸¦å…¥è§£æçš„é«˜æ–¯åˆ†å¸ƒ KL æ•£åº¦çš„å½¢å¼ï¼Œæœ‰ï¼š</p>$$
\begin{aligned}
L_t^\text{simple}
&= \mathbb{E}_{t \sim [1, T], {x}_0, {\epsilon}_t} \Big[\|{\epsilon}_t - {\epsilon}_\theta({x}_t, t)\|^2 \Big] \\
&= \mathbb{E}_{t \sim [1, T], {x}_0, {\epsilon}_t} \Big[\|{\epsilon}_t - {\epsilon}_\theta(\sqrt{\bar{\alpha}_t}{x}_0 + \sqrt{1 - \bar{\alpha}_t}{\epsilon}_t, t)\|^2 \Big]
\end{aligned}
$$<h2 id=3-ç¦»æ•£æ¦‚ç‡åˆ†å¸ƒçš„æ‰©æ•£è¿‡ç¨‹>3. ç¦»æ•£æ¦‚ç‡åˆ†å¸ƒçš„æ‰©æ•£è¿‡ç¨‹<a hidden class=anchor aria-hidden=true href=#3-ç¦»æ•£æ¦‚ç‡åˆ†å¸ƒçš„æ‰©æ•£è¿‡ç¨‹>#</a></h2><p>å¯¹äºè‡ªç„¶æ–‡æœ¬ï¼Œä¸€ä¸ªå¾ˆç›´æ¥çš„æ€è·¯æ˜¯åˆ¶ä½œä¸€ä¸ªè¯æ±‡è¡¨ï¼Œå°†æ–‡æœ¬ä¸­çš„ä»»æ„ä¸€ä¸ª Token çœ‹ä½œä¸€ä¸ªç§ç±»å…³äº vocab çš„ç¦»æ•£åˆ†å¸ƒã€‚å› æ­¤å¦‚æœæˆ‘ä»¬èƒ½è§£å†³åœ¨ç¦»æ•£åˆ†å¸ƒä¸Šçš„å‰å‘å’Œåå‘æ‰©æ•£é—®é¢˜ï¼Œå°±å¯ä»¥åœ¨è‡ªç„¶è¯­è¨€æ¨¡å‹ä¸Šä½¿ç”¨æ‰©æ•£æ¨¡å‹äº†ã€‚å¯¹äºä¸€ä¸ªç¡®å®šæ€§çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶çœ‹ä½œä¸€ä¸ª one-hot å‘é‡ $\mathbf{x}_0$ã€‚åŒæ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶åˆ†è§£ä¸º forward diffusionã€reversed diffusion å’Œ training æ¥ç†è§£ã€‚</p><h3 id=31-forward-diffusion>3.1. forward diffusion<a hidden class=anchor aria-hidden=true href=#31-forward-diffusion>#</a></h3><p>forward diffusion å¸Œæœ›å®ç°ä¸€ä¸ªæ¡ä»¶æœŸæœ› $p(x_{t}\mid x_{t-1})$ï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªçŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œå’Œè¿ç»­ diffusion ä¸€æ ·ï¼Œå°†å…¶é€æ­¥è½¬æ¢åˆ°ä¸€ä¸ªç‰¹æ®Šçš„åˆ†å¸ƒä¸Šã€‚åœ¨ç¦»æ•£åˆ†å¸ƒä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªåˆ†ç±»è½¬ç§»åˆ†å¸ƒ (categorical transition distribution) $\text{Cat}$ æ¥å®šä¹‰è¿™ä¸ªè½¬ç§»è¿‡ç¨‹ï¼š</p>$$
p(x_t\mid x_{t-1}) = \text{Cat} (x_t; p = x_{t-1}Q_t)
$$<p>å…¶ä¸­ï¼Œ$Q_t$ æ˜¯çŠ¶æ€è½¬ç§»çŸ©é˜µã€‚ä¸åŒçš„çŠ¶æ€è½¬ç§»å¯ä»¥å°†åˆ†å¸ƒè½¬ç§»åˆ°ä¸åŒçš„ç‰¹æ®Šåˆ†å¸ƒä¸Šã€‚ç‰¹æ®Šåˆ†å¸ƒçš„é€‰æ‹©æœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬è¿™é‡Œä¸¾å‡ ä¸ªå¸¸è§çš„ä¾‹å­ï¼š</p><h4 id=311-uniform-distribution>3.1.1. uniform distribution<a hidden class=anchor aria-hidden=true href=#311-uniform-distribution>#</a></h4><p>$Q_t = (1-\beta_t)I + \frac{\beta_t}{K} \mathbf{1}\mathbf{1}^\top$ å¯ä»¥äº§ç”Ÿä¸€ä¸ªå‡åŒ€çš„ç¨³æ€åˆ†å¸ƒã€‚è¿™ä¸ªå‡åŒ€è½¬ç§»çŸ©é˜µçœ‹èµ·æ¥åƒï¼š</p>$$
Q_t^{\text{uniform}} = \begin{bmatrix} 1 - \frac{K-1}{K}\beta_t & \frac{\beta_t}{K} & \cdots & \frac{\beta_t}{K} \\ \frac{\beta_t}{K} & 1 - \frac{K-1}{K}\beta_t & \cdots & \frac{\beta_t}{K} \\ \vdots & \vdots & \ddots & \vdots \\ \frac{\beta_t}{K} & \frac{\beta_t}{K} & \cdots & 1 - \frac{K-1}{K}\beta_t \end{bmatrix}
$$<h4 id=312-absorbing>3.1.2. Absorbing<a hidden class=anchor aria-hidden=true href=#312-absorbing>#</a></h4><p>$Q_t = (1-\beta_t)I + \beta_t \mathbf{1} e_m^\top$ï¼Œå…¶ä¸­ $e_m$ æ˜¯ä¸€ä¸ªåœ¨å¸æ”¶çŠ¶æ€ä¸Šä¸º 1ï¼Œå…¶ä½™ä½ç½®ä¸º 0 çš„å‘é‡ã€‚è¯å…ƒï¼ˆTokensï¼‰è¦ä¹ˆä¿æŒä¸å˜ï¼Œè¦ä¹ˆä»¥æ¦‚ç‡ $\beta_t$ è¢«æ˜ å°„åˆ°ä¸€ä¸ªç‰¹æ®Šçš„ [MASK] è¯å…ƒã€‚è¿™ä¸ªå¸æ”¶è½¬ç§»çŸ©é˜µçœ‹èµ·æ¥åƒï¼š</p>$$
Q_t^{\text{absorb}} = \begin{bmatrix} 1 - \beta_t & 0 & \cdots & 0 & \beta_t \\ 0 & 1 - \beta_t & \cdots & 0 & \beta_t \\ \vdots & \vdots & \ddots & \vdots & \vdots \\ 0 & 0 & \cdots & 1 - \beta_t & \beta_t \\ 0 & 0 & \cdots & 0 & 1 \end{bmatrix}
$$<h3 id=32-reversed-diffusion>3.2. reversed diffusion<a hidden class=anchor aria-hidden=true href=#32-reversed-diffusion>#</a></h3><p>ç±»ä¼¼äº continuous diffusionï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ $x_0$ reparameterization trick æ¥ç®€åŒ–åå‘è¿‡ç¨‹çš„å»ºæ¨¡ã€‚å› ä¸ºç¦»æ•£åˆ†å¸ƒæ˜¯æœ‰é™çš„ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºç²¾ç¡®çš„åéªŒåˆ†å¸ƒ</p>$$
p_\theta(x_{t-1}\mid x_t) \propto \sum_{x_0} p(x_{t-1}\mid x_t, x_0) p(x_0\mid x_t)
$$<p>å…¶ä¸­ $p(x_0\mid x_t)$ æ˜¯ç¥ç»ç½‘ç»œï¼Œè¾“å…¥ $x_t$ï¼Œé¢„æµ‹å‡º $x_0$ çš„åˆ†å¸ƒã€‚</p><h3 id=33-training>3.3. training<a hidden class=anchor aria-hidden=true href=#33-training>#</a></h3><p>æŸå¤±å‡½æ•°ç»“åˆäº†å˜åˆ†ä¸‹ç•Œ $\mathcal{L}_{\text{vb}}$ å’Œä¸€ä¸ªè¾…åŠ©çš„äº¤å‰ç†µå»å™ªé¡¹ $\mathcal{L}_{\text{ce}}$ï¼š</p>$$
\begin{aligned}
&\mathcal{L}_\lambda = \mathcal{L}_{\text{vb}} + \lambda \mathcal{L}_{\text{ce}}\\
&\begin{aligned}
\mathcal{L}_{\text{vb}}
&= \mathbb{E}_{q(\mathbf{x}_0)}[\underbrace{\text{KL}(q(\mathbf{x}_T | \mathbf{x}_0) \| p(\mathbf{x}_T))}_{\mathcal{L}_T}]\\
&+ \sum_{t=2}^T \mathbb{E}_{q(\mathbf{x}_t|\mathbf{x}_0)}[\underbrace{\text{KL}(q(\mathbf{x}_{t-1} | \mathbf{x}_t, \mathbf{x}_0) \| p_\theta(\mathbf{x}_{t-1} | \mathbf{x}_t))}_{\mathcal{L}_{t-1}}]\\
&-\underbrace{\mathbb{E}_{q(\mathbf{x}_1|\mathbf{x}_0)}[\log p_\theta(\mathbf{x}_0 | \mathbf{x}_1)]}_{\mathcal{L}_0}
\end{aligned}\\
&\mathcal{L}_{\text{ce}} = \mathbb{E}_{q(\mathbf{x}_0)}\mathbb{E}_{q(\mathbf{x}_t|\mathbf{x}_0)}[-\log \tilde{p}_\theta(\mathbf{x}_0|\mathbf{x}_t)]
\end{aligned}
$$<p>åœ¨ $\mathcal{L}_{\text{vb}}$ ä¸­ï¼Œ</p><ul><li>$\mathcal{L}_T$ æ˜¯å‰å‘è¿‡ç¨‹çš„ç»ˆç«¯åˆ†å¸ƒ $q(\mathbf{x}_T | \mathbf{x}_0)$ ä¸å…ˆéªŒåˆ†å¸ƒ $p(\mathbf{x}_T)$ ä¹‹é—´çš„ KL æ•£åº¦ã€‚</li><li>$\mathcal{L}_{t-1}$ æ˜¯åœ¨æ¯ä¸ªä¸­é—´æ­¥éª¤ä¸­ï¼Œå‰å‘è¿‡ç¨‹çš„åéªŒåˆ†å¸ƒ $q(\mathbf{x}_{t-1} | \mathbf{x}_t, \mathbf{x}_0)$ ä¸å­¦ä¹ åˆ°çš„åå‘æ¨¡å‹ $p_\theta(\mathbf{x}_{t-1} | \mathbf{x}_t)$ ä¹‹é—´çš„ KL æ•£åº¦ã€‚</li><li>$\mathcal{L}_0$ æ˜¯ä½¿ç”¨åå‘æ¨¡å‹ä» $\mathbf{x}_1$ é‡å»º $\mathbf{x}_0$ çš„äº¤å‰ç†µæŸå¤±ã€‚</li></ul><p>è¿™ä¸ªåˆ†è§£å’Œ continuous diffusion çš„è®­ç»ƒè¿‡ç¨‹å®Œå…¨ç›¸åŒï¼Œæˆ‘ä»¬ä¸åšæ›´å¤šçš„è®¨è®ºã€‚</p><p><img alt="difference between autoregressive and diffusion" loading=lazy src=https://wangjv0812.cn/2025/11/from-diffusion-to-diffusion-language-model/posts/From%20Diffusion%20to%20Diffusion%20Language%20Model/Images/diff_in_ar_df.png></p><h2 id=4-å¸¸è§çš„-diffusion-language-model-ç»“æ„>4. å¸¸è§çš„ diffusion Language Model ç»“æ„<a hidden class=anchor aria-hidden=true href=#4-å¸¸è§çš„-diffusion-language-model-ç»“æ„>#</a></h2><h3 id=41-masked-diffusion-model>4.1. Masked Diffusion Model<a hidden class=anchor aria-hidden=true href=#41-masked-diffusion-model>#</a></h3><p>åŸºäºæˆ‘ä»¬å‰é¢è®¨è®ºçš„ absorbing forward diffusionï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªå›ºå®šçš„ Token <code>[MASK]</code>ï¼Œå¹¶ä½¿ç”¨å¸æ”¶çŠ¶æ€è½¬ç§»çŸ©é˜µè¿›è¡Œå‰å‘æ‰©æ•£ã€‚è¿™æ ·ï¼Œéšç€æ—¶é—´æ­¥é•¿çš„å¢åŠ ï¼Œè¾“å…¥åºåˆ—ä¸­çš„è¯å…ƒä¼šé€æ¸è¢«æ›¿æ¢ä¸º <code>[MASK]</code>ï¼Œæœ€ç»ˆæ•´ä¸ªåºåˆ—å˜ä¸ºå…¨ <code>[MASK]</code>ã€‚åœ¨åå‘æ‰©æ•£è¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹å­¦ä¹ ä»éƒ¨åˆ†æˆ–å…¨éƒ¨è¢«æ©ç çš„åºåˆ—ä¸­æ¢å¤åŸå§‹æ–‡æœ¬ã€‚åœ¨é¢„è®­ç»ƒæ±‡æ€»ï¼Œä¸ä¼šå°†æ‰€æœ‰çš„æ–‡æœ¬éƒ½æ›¿æ¢ä¸º <code>[MASK]</code>ï¼Œè€Œæ˜¯éšæœºé€‰æ‹©ä¸€éƒ¨åˆ†è¯å…ƒè¿›è¡Œæ©ç å¤„ç†ï¼Œè¿™æ ·æ¨¡å‹å¯ä»¥å­¦ä¹ åœ¨ä¸åŒç¨‹åº¦çš„ä¿¡æ¯ç¼ºå¤±ä¸‹è¿›è¡Œæ–‡æœ¬æ¢å¤ã€‚æ­¤æ—¶çš„çŠ¶æ€è½¬ç§»å¯ä»¥æè¿°ä¸ºï¼š</p>$$
q(x_t\mid x_0) = \text{Cat}(x_t; a_t x_0 + (1 - a_t) e_m)
$$<p>å…¶ä¸­ $e_m$ æ˜¯å›ºå®šåœ¨ <code>[MASK]</code> å¤„çš„ one-hot å‘é‡ï¼Œè¿™ä¸ªå½¢å¼ç›¸å½“äºé€æ¸å°†è¾“å…¥æ–‡æœ¬è½¬æ¢ä¸º <code>[MASK]</code> åºåˆ—ã€‚</p>$$
q(\mathbf{x}_s | \mathbf{x}_t, \mathbf{x}_0) = \begin{cases} \text{Cat}(\mathbf{x}_s; \mathbf{x}_t), & \text{å¦‚æœ } \mathbf{x}_t \neq m, \\ \text{Cat}\left(\mathbf{x}_s; \frac{(1-\alpha_s)m + (\alpha_s - \alpha_t)\mathbf{x}_0}{1-\alpha_t}\right), & \text{å¦‚æœ } \mathbf{x}_t = m. \end{cases}
$$<p>è¿™ä¸ªå…¬å¼åæ˜ äº†æ©ç ï¼ˆmaskingï¼‰è¿‡ç¨‹çš„ä¸¤ä¸ªå…³é”®å±æ€§ï¼š</p><ol><li>å¦‚æœå½“å‰è¯å…ƒ $\mathbf{x}_t$ æ²¡æœ‰è¢«æ©ç ï¼Œé‚£ä¹ˆå…¶åéªŒæ˜¯ç¡®å®šæ€§çš„ï¼š$\mathbf{x}_s = \mathbf{x}_t$ã€‚</li><li>å¦‚æœè¯å…ƒè¢«æ©ç ï¼Œé‚£ä¹ˆå…¶åéªŒæ˜¯æ©ç å‘é‡ $m$ å’ŒåŸå§‹è¯å…ƒ $\mathbf{x}_0$ ä¹‹é—´çš„çº¿æ€§æ’å€¼ï¼Œå¹¶ç”±å™ªå£°è°ƒåº¦å‚æ•° $\alpha_s$ å’Œ $\alpha_t$ è¿›è¡Œç¼©æ”¾ã€‚</li></ol><p>è®¾ $f_\theta(\mathbf{x}_t)$ ä¸ºç¥ç»ç½‘ç»œçš„è¾“å‡ºï¼Œç”¨äºä»å¸¦å™ªè¾“å…¥ $\mathbf{x}_t$ é¢„æµ‹åŸå§‹è¯å…ƒ $\mathbf{x}_0$ã€‚ä¸Šè¿°çš„é€†å‘è½¬ç§»å¯ä»¥é‡å†™ä¸ºï¼š</p>$$
p_\theta(\mathbf{x}_s | \mathbf{x}_t) = \begin{cases} \text{Cat}(\mathbf{x}_s; \mathbf{x}_t), & \text{å¦‚æœ } \mathbf{x}_t \neq m, \\ \text{Cat}\left(\mathbf{x}_s; \frac{(1-\alpha_s)m + (\alpha_s - \alpha_t)f_\theta(\mathbf{x}_t)}{1-\alpha_t}\right), & \text{å¦‚æœ } \mathbf{x}_t = m. \end{cases}
$$<h3 id=42-block-diffusion-model>4.2. Block Diffusion Model<a hidden class=anchor aria-hidden=true href=#42-block-diffusion-model>#</a></h3><p>ä½ è‚¯å®šå‘ç°äº†ï¼ŒMasked Diffusion Model æ¯æ¬¡åªèƒ½å¯¹ä¸€ä¸ªæ¬¡å…ƒçš„ <code>[MASK]</code> é™å™ªï¼Œè¿™ä¼¼ä¹å’Œ BERT æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚å› æ­¤æœ‰äº†è¿™ä¸ªæ”¹è¿›ã€‚å¯¹äºä¸€ä¸ªæ–‡æœ¬åºåˆ— $x_1, x_2, \cdots, x_L$ï¼Œ Block Diffusion Model å°†å…¶åˆ†ä¸º $B$ ä¸ª Blockï¼š</p>$$
\{x^{(0)}, x^{(1)}, \cdots, x^{(B)}\}
$$<p>å…¶ä¸­æ¯ä¸ª block çš„é•¿åº¦ä¸º $L$ã€‚æ•´æ®µæ–‡æœ¬è¢«åˆ’åˆ†ä¸ºæŒ‰å—è‡ªå›å½’çš„å½¢å¼ï¼š</p>$$
\log p_theta(x) = \sum^B_b \log p_\theta(x^{(b)} \mid x^{(0:b-1)})
$$<p>å¯¹äºå—å†…ï¼Œæˆ‘ä»¬é€šè¿‡ diffusion å¹¶è¡Œçš„åŒæ—¶é¢„æµ‹æ•´ä¸ªå—çš„æ‰€æœ‰tokenã€‚</p>$$
p_\theta(x^{(b)}_s \mid x^{(b)}_t, x^{(<b)}) =\sum_{x^{(b)}} q(x^{(b)}_s \mid x^{(b)}_t, x^{(b)}) p_\theta(x^{(b)} \mid x^{(b)}_t, x^{(<b)}) $$<p>å…·ä½“è€Œè¨€ï¼Œæ¨¡å‹ä½¿ç”¨ Transformerï¼Œé‡‡ç”¨ BLock Causal Attention Mask æœºåˆ¶ï¼Œå³åœ¨å—å†…ä½¿ç”¨è‡ªæ³¨æ„åŠ›ï¼Œå—é—´ä½¿ç”¨å› æœæ³¨æ„åŠ›ã€‚</p><h3 id=43-flexible-length-masked-diffusion>4.3. Flexible-Length Masked Diffusion<a hidden class=anchor aria-hidden=true href=#43-flexible-length-masked-diffusion>#</a></h3><p>æ™®é€šçš„ token ä¸€èˆ¬åªæœ‰ <code>[TRUTH]</code> å’Œ <code>[MASK]</code> ä¸¤ç§çŠ¶æ€ã€‚è€Œ Flexible-Length Masked Diffusion åˆ™è¿›å…¥äº†ç¬¬ä¸‰ç§çŠ¶æ€ <code>[EMPTY]</code>ã€‚è¯¥æ–¹æ³•ä¼šå¼•å…¥ä¸€ä¸ªè¾…åŠ©ç½‘ç»œ $g_\theta$ï¼Œåˆ¤æ–­æ¯ä¸ªå·²çŸ¥ Token ä¹‹å‰éœ€è¦æ’å…¥ä½ ä¸ª <code>[MASK]</code>ã€‚å› æ­¤è¯¥æ–¹æ³•åˆ™æ˜¯ä¸€ä¸ªä¸€ä¸ªä¸¤é˜¶æ®µè¿‡ç¨‹ã€‚</p><ol><li>Insertion é˜¶æ®µï¼šä½¿ç”¨ $g_\theta$ æ’å…¥ <code>[MASK]</code>ã€‚</li><li>unmasking é˜¶æ®µï¼šä½¿ç”¨ diffusion æ¨¡å‹å°† <code>[MASK]</code> è½¬æ¢ä¸ºçœŸå® Tokenï¼Œå…¶ä¸­å¦‚æœç½‘ç»œè®¤ä¸ºè¿™ä¸ª token ä¸éœ€è¦ï¼Œå¯ä»¥å°†å…¶å˜ä¸º <code>[EMPTY]</code></li></ol><p>è®­ç»ƒä¸­ï¼Œæ‰€æœ‰çš„æ–‡æœ¬å…ˆæ˜¯ <code>[EMPTY]</code>ï¼Œæˆ‘ä»¬å…ˆè®­ç»ƒæ¨¡å‹æ’å…¥ <code>[MASK]</code>ï¼Œç„¶åå†è®­ç»ƒ diffusion æ¨¡å‹å°† <code>[MASK]</code> è½¬æ¢ä¸ºçœŸå® Tokenã€‚ä»è€Œè®©æ¨¡å‹è·å¾—äº†åˆ¤æ–­æ–‡æœ¬é•¿åº¦çš„èƒ½åŠ›ã€‚</p><h2 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>#</a></h2><p>[1] <a href=https://arxiv.org/abs/2506.13759>Discrete Diffusion in Large Language and Multimodal Models: A Survey</a></p><p>[2] <a href=https://arxiv.org/pdf/2006.11239>Denoising Diffusion Probabilistic Models</a></p><p>[3] <a href=https://arxiv.org/pdf/2406.07524>Simple and Effective Masked Diffusion Language Models</a></p><p>[4] <a href=https://arxiv.org/abs/2502.09992>Large Language Diffusion Models</a></p><h2 id=appendix>Appendix<a hidden class=anchor aria-hidden=true href=#appendix>#</a></h2><h3 id=appendix-a-diffusion-training-è¿‡ç¨‹çš„æ¨å¯¼>Appendix A. diffusion training è¿‡ç¨‹çš„æ¨å¯¼<a hidden class=anchor aria-hidden=true href=#appendix-a-diffusion-training-è¿‡ç¨‹çš„æ¨å¯¼>#</a></h3>$$
\begin{aligned}
L_\text{VLB}
&= \mathbb{E}_{q(\mathbf{x}_{0:T})} \Big[ \log\frac{q(\mathbf{x}_{1:T}\vert\mathbf{x}_0)}{p_\theta(\mathbf{x}_{0:T})} \Big] \\
&= \mathbb{E}_q \Big[ \log\frac{\prod_{t=1}^T q(\mathbf{x}_t\vert\mathbf{x}_{t-1})}{ p_\theta(\mathbf{x}_T) \prod_{t=1}^T p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t) } \Big] \\
&= \mathbb{E}_q \Big[ -\log p_\theta(\mathbf{x}_T) + \sum_{t=1}^T \log \frac{q(\mathbf{x}_t\vert\mathbf{x}_{t-1})}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} \Big] \\
&= \mathbb{E}_q \Big[ -\log p_\theta(\mathbf{x}_T) + \sum_{t=2}^T \log \frac{q(\mathbf{x}_t\vert\mathbf{x}_{t-1})}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} + \log\frac{q(\mathbf{x}_1 \vert \mathbf{x}_0)}{p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)} \Big] \\
&= \mathbb{E}_q \Big[ -\log p_\theta(\mathbf{x}_T) + \sum_{t=2}^T \log \Big( \frac{q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)}\cdot \frac{q(\mathbf{x}_t \vert \mathbf{x}_0)}{q(\mathbf{x}_{t-1}\vert\mathbf{x}_0)} \Big) + \log \frac{q(\mathbf{x}_1 \vert \mathbf{x}_0)}{p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)} \Big] \\
&= \mathbb{E}_q \Big[ -\log p_\theta(\mathbf{x}_T) + \sum_{t=2}^T \log \frac{q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} + \sum_{t=2}^T \log \frac{q(\mathbf{x}_t \vert \mathbf{x}_0)}{q(\mathbf{x}_{t-1} \vert \mathbf{x}_0)} + \log\frac{q(\mathbf{x}_1 \vert \mathbf{x}_0)}{p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)} \Big] \\
&= \mathbb{E}_q \Big[ -\log p_\theta(\mathbf{x}_T) + \sum_{t=2}^T \log \frac{q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} + \log\frac{q(\mathbf{x}_T \vert \mathbf{x}_0)}{q(\mathbf{x}_1 \vert \mathbf{x}_0)} + \log \frac{q(\mathbf{x}_1 \vert \mathbf{x}_0)}{p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)} \Big]\\
&= \mathbb{E}_q \Big[ \log\frac{q(\mathbf{x}_T \vert \mathbf{x}_0)}{p_\theta(\mathbf{x}_T)} + \sum_{t=2}^T \log \frac{q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0)}{p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t)} - \log p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1) \Big] \\
&= \mathbb{E}_q [\underbrace{D_\text{KL}(q(\mathbf{x}_T \vert \mathbf{x}_0) \parallel p_\theta(\mathbf{x}_T))}_{L_T} + \sum_{t=2}^T \underbrace{D_\text{KL}(q(\mathbf{x}_{t-1} \vert \mathbf{x}_t, \mathbf{x}_0) \parallel p_\theta(\mathbf{x}_{t-1} \vert\mathbf{x}_t))}_{L_{t-1}} \underbrace{- \log p_\theta(\mathbf{x}_0 \vert \mathbf{x}_1)}_{L_0} ]
\end{aligned}
$$</div><footer class=post-footer><ul class=post-tags><li><a href=https://wangjv0812.cn/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/>ç¥ç»ç½‘ç»œ</a></li><li><a href=https://wangjv0812.cn/tags/%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/>ç”Ÿæˆæ¨¡å‹</a></li><li><a href=https://wangjv0812.cn/tags/diffusion/>Diffusion</a></li><li><a href=https://wangjv0812.cn/tags/%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B/>è¯­è¨€æ¨¡å‹</a></li></ul><nav class=paginav><a class=prev href=https://wangjv0812.cn/2025/11/lumine-training-an-agent-to-play-genshin/><span class=title>Â« Prev</span><br><span>Lumine: Training an Agent to play Genshin</span>
</a><a class=next href=https://wangjv0812.cn/2025/10/geodesic-and-lie-algebra-in-so3/><span class=title>Next Â»</span><br><span>Geodesic and Lie Algebra in SO(3)</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://wangjv0812.cn/>WangJV Blog</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>