<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Variational Bayesian Inference | WangJV Blog</title><meta name=keywords content="Variational Inference,Bayesian Inference,KL Divergence,ELBO"><meta name=description content="1. åŠ¨æœº
å¯¹äºä¸€ä¸ªçŠ¶æ€ $x$ï¼Œåœ¨é€šè¿‡ä¼ æ„Ÿå™¨è¿›è¡Œä¸€æ¬¡è§‚æµ‹ $y$ åï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥è®¡ç®—å‡ºåéªŒåˆ†å¸ƒ $p(x\mid y)$ï¼Œå³åœ¨è§‚æµ‹åˆ° $y$ çš„æƒ…å†µä¸‹ï¼ŒçŠ¶æ€ $x$ çš„åˆ†å¸ƒã€‚ä¸ºäº†è®¡ç®—åéªŒåˆ†å¸ƒçš„å½¢å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è´å¶æ–¯å…¬å¼ï¼š
$$
\begin{aligned}
p(x\mid y)
&= \frac{p(y\mid x) p(x)}{p(y)}\\
&= \frac{p(y\mid x) p(x)}{\int p(y\mid x) p(x) \mathrm{d}x}
\end{aligned}
$$å¯¹äºçŠ¶æ€ä¼°è®¡é—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä½¿å¾— $p(x\mid y)$ æœ€å¤§çš„çŠ¶æ€ $x$ã€‚ ç”±äº $p(y)$ æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å¿½ç•¥ï¼Œåªéœ€è¦æœ€å¤§åŒ–åˆ†å­éƒ¨åˆ†ã€‚ä½†æ˜¯ä¸€äº›åº”ç”¨åœºæ™¯ä¸­ï¼Œè¿˜éœ€è¦æˆ‘ä»¬è®¡ç®—å‡ºå…·ä½“çš„åéªŒåˆ†å¸ƒçš„å½¢å¼ã€‚ä½†æ˜¯è¿™å¾€å¾€éå¸¸çš„éš¾ï¼Œè¾¹ç¼˜ä¼¼ç„¶ $p(y)$ çš„è®¡ç®—å¾€å¾€æ˜¯å‡ ä¹ä¸å¯èƒ½çš„ã€‚å› æ­¤ä¸€ä¸ªæˆ–è®¸å¯è¡Œçš„åŠæ³•æ˜¯ï¼Œä½¿ç”¨ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åˆ†å¸ƒ $q(x)$ ä»£æ›¿åéªŒåˆ†å¸ƒã€‚é‚£ä¹ˆåŸæœ¬çš„è´å¶æ–¯é—®é¢˜å˜æˆä¸€ä¸ªå˜åˆ†ä¼˜åŒ–é—®é¢˜ï¼Œä¸å¦¨ç”¨ KL æ•£åº¦è¡¡é‡å·®å¼‚ã€‚
2. KL æ•£åº¦çš„ä¸å¯¹ç§°æ€§
ä½†æ˜¯ä¸€ä¸ªå¾ˆæ ¸å¿ƒçš„é—®é¢˜æ˜¯ï¼ŒKL æ•£åº¦ä¸å…·æœ‰å¯¹ç§°æ€§ï¼Œ$D_{KL}(p\| q) \neq D_{KL}(q\| p)$ï¼Œåœ¨å®é™…æ“ä½œä¸­ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿä¸å¦¨å…ˆè§‚å¯Ÿè¿™ä¸¤ä¸ªå¯¹ç§°çš„ KL æ•£åº¦çš„å…·ä½“å½¢å¼ï¼š
$$
\begin{aligned}
D_{KL}(p \| q)
&= -\int p(x\mid y) \log \frac{q(x)}{p(x\mid y)} \mathrm{d}x\\
&= -\int p(x\mid y) \log q(x) \mathrm{d}x + \int p(x\mid y) \log p(x\mid y) \mathrm{d}x
\end{aligned}
$$å…¶ä¸­ï¼Œ$\int p(x\mid y) \log q(x) \mathrm{d}x$ å®è´¨ä¸Šæ˜¯ $p$ ä¸ $q$ ä¹‹é—´çš„äº¤å‰ç†µï¼Œä¸å¦¨å®šä¹‰ $H(p, q) = \int p(x\mid y) \log q(x) \mathrm{d}x$ã€‚è€Œ $\int p(x\mid y) \log p(x\mid y) \mathrm{d}x$ åˆ™æ˜¯å…³äº $p$ çš„ç†µã€‚$p$ çš„ç†µå®è´¨ä¸Šæ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œå› æ­¤å®è´¨ä¸Šï¼š"><meta name=author content="WangJV"><link rel=canonical href=https://wangjv0812.cn/2025/10/variational-bayesian-inference/><link crossorigin=anonymous href=https://wangjv0812.cn/assets/css/stylesheet.2211ca3164be7830024f6aad2b3a2e520843a64f8f048445c3401c1249aa051d.css integrity="sha256-IhHKMWS+eDACT2qtKzouUghDpk+PBIRFw0AcEkmqBR0=" rel="preload stylesheet" as=style><link rel=icon href=https://wangjv0812.cn/icon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://wangjv0812.cn/icon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wangjv0812.cn/icon/favicon-32x32.png><link rel=apple-touch-icon href=https://wangjv0812.cn/icon/apple-touch-icon.png><link rel=mask-icon href=https://wangjv0812.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://wangjv0812.cn/2025/10/variational-bayesian-inference/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=icon type=image/png sizes=32x32 href=https://wangjv0812.cn/icon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://wangjv0812.cn/icon/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=https://wangjv0812.cn/icon/apple-touch-icon.png><link rel=manifest href=https://wangjv0812.cn/icon/site.webmanifest><script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["\\(","\\)"],["$","$"]],processEscapes:!0,processEnvironments:!0,tags:"ams"},chtml:{scale:1,minScale:.5,matchFontHeight:!1,displayAlign:"center",displayIndent:"0",mtextInheritFont:!1,merrorInheritFont:!0,mathmlSpacing:!1,skipHtmlTags:["script","noscript","style","textarea","pre","code","a"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"},svg:{scale:1,minScale:.5,mtextInheritFont:!1,merrorInheritFont:!0,mathmlSpacing:!1,skipHtmlTags:["script","noscript","style","textarea","pre","code","a"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"},options:{enableMenu:!0,menuOptions:{settings:{zoom:"Click"}}},loader:{load:["ui/safe","a11y/assistive-mml"]},startup:{ready(){MathJax.startup.defaultReady();const e=new ResizeObserver(e=>{MathJax.typesetPromise()});e.observe(document.body)}}},window.innerWidth<=768&&(MathJax.chtml=MathJax.chtml||{},MathJax.chtml.scale=.9)</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><style>.MathJax{outline:0}@media(max-width:768px){.MathJax{font-size:90%!important}.MathJax_Display{overflow-x:auto;overflow-y:hidden;padding:0!important;margin:1em 0!important}.MathJax_CHTML{line-height:1.2!important}}mjx-container[jax=CHTML][display=true]{overflow-x:auto;overflow-y:hidden;padding:1px 0}</style><meta property="og:url" content="https://wangjv0812.cn/2025/10/variational-bayesian-inference/"><meta property="og:site_name" content="WangJV Blog"><meta property="og:title" content="Variational Bayesian Inference"><meta property="og:description" content="1. åŠ¨æœº å¯¹äºä¸€ä¸ªçŠ¶æ€ $x$ï¼Œåœ¨é€šè¿‡ä¼ æ„Ÿå™¨è¿›è¡Œä¸€æ¬¡è§‚æµ‹ $y$ åï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥è®¡ç®—å‡ºåéªŒåˆ†å¸ƒ $p(x\mid y)$ï¼Œå³åœ¨è§‚æµ‹åˆ° $y$ çš„æƒ…å†µä¸‹ï¼ŒçŠ¶æ€ $x$ çš„åˆ†å¸ƒã€‚ä¸ºäº†è®¡ç®—åéªŒåˆ†å¸ƒçš„å½¢å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è´å¶æ–¯å…¬å¼ï¼š
$$ \begin{aligned} p(x\mid y) &= \frac{p(y\mid x) p(x)}{p(y)}\\ &= \frac{p(y\mid x) p(x)}{\int p(y\mid x) p(x) \mathrm{d}x} \end{aligned} $$å¯¹äºçŠ¶æ€ä¼°è®¡é—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä½¿å¾— $p(x\mid y)$ æœ€å¤§çš„çŠ¶æ€ $x$ã€‚ ç”±äº $p(y)$ æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å¿½ç•¥ï¼Œåªéœ€è¦æœ€å¤§åŒ–åˆ†å­éƒ¨åˆ†ã€‚ä½†æ˜¯ä¸€äº›åº”ç”¨åœºæ™¯ä¸­ï¼Œè¿˜éœ€è¦æˆ‘ä»¬è®¡ç®—å‡ºå…·ä½“çš„åéªŒåˆ†å¸ƒçš„å½¢å¼ã€‚ä½†æ˜¯è¿™å¾€å¾€éå¸¸çš„éš¾ï¼Œè¾¹ç¼˜ä¼¼ç„¶ $p(y)$ çš„è®¡ç®—å¾€å¾€æ˜¯å‡ ä¹ä¸å¯èƒ½çš„ã€‚å› æ­¤ä¸€ä¸ªæˆ–è®¸å¯è¡Œçš„åŠæ³•æ˜¯ï¼Œä½¿ç”¨ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åˆ†å¸ƒ $q(x)$ ä»£æ›¿åéªŒåˆ†å¸ƒã€‚é‚£ä¹ˆåŸæœ¬çš„è´å¶æ–¯é—®é¢˜å˜æˆä¸€ä¸ªå˜åˆ†ä¼˜åŒ–é—®é¢˜ï¼Œä¸å¦¨ç”¨ KL æ•£åº¦è¡¡é‡å·®å¼‚ã€‚
2. KL æ•£åº¦çš„ä¸å¯¹ç§°æ€§ ä½†æ˜¯ä¸€ä¸ªå¾ˆæ ¸å¿ƒçš„é—®é¢˜æ˜¯ï¼ŒKL æ•£åº¦ä¸å…·æœ‰å¯¹ç§°æ€§ï¼Œ$D_{KL}(p\| q) \neq D_{KL}(q\| p)$ï¼Œåœ¨å®é™…æ“ä½œä¸­ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿä¸å¦¨å…ˆè§‚å¯Ÿè¿™ä¸¤ä¸ªå¯¹ç§°çš„ KL æ•£åº¦çš„å…·ä½“å½¢å¼ï¼š
$$ \begin{aligned} D_{KL}(p \| q) &= -\int p(x\mid y) \log \frac{q(x)}{p(x\mid y)} \mathrm{d}x\\ &= -\int p(x\mid y) \log q(x) \mathrm{d}x + \int p(x\mid y) \log p(x\mid y) \mathrm{d}x \end{aligned} $$å…¶ä¸­ï¼Œ$\int p(x\mid y) \log q(x) \mathrm{d}x$ å®è´¨ä¸Šæ˜¯ $p$ ä¸ $q$ ä¹‹é—´çš„äº¤å‰ç†µï¼Œä¸å¦¨å®šä¹‰ $H(p, q) = \int p(x\mid y) \log q(x) \mathrm{d}x$ã€‚è€Œ $\int p(x\mid y) \log p(x\mid y) \mathrm{d}x$ åˆ™æ˜¯å…³äº $p$ çš„ç†µã€‚$p$ çš„ç†µå®è´¨ä¸Šæ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œå› æ­¤å®è´¨ä¸Šï¼š"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-10-28T23:35:25+08:00"><meta property="article:modified_time" content="2025-10-28T23:35:25+08:00"><meta property="article:tag" content="Variational Inference"><meta property="article:tag" content="Bayesian Inference"><meta property="article:tag" content="KL Divergence"><meta property="article:tag" content="ELBO"><meta property="og:image" content="https://wangjv0812.cn/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://wangjv0812.cn/"><meta name=twitter:title content="Variational Bayesian Inference"><meta name=twitter:description content="1. åŠ¨æœº
å¯¹äºä¸€ä¸ªçŠ¶æ€ $x$ï¼Œåœ¨é€šè¿‡ä¼ æ„Ÿå™¨è¿›è¡Œä¸€æ¬¡è§‚æµ‹ $y$ åï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥è®¡ç®—å‡ºåéªŒåˆ†å¸ƒ $p(x\mid y)$ï¼Œå³åœ¨è§‚æµ‹åˆ° $y$ çš„æƒ…å†µä¸‹ï¼ŒçŠ¶æ€ $x$ çš„åˆ†å¸ƒã€‚ä¸ºäº†è®¡ç®—åéªŒåˆ†å¸ƒçš„å½¢å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è´å¶æ–¯å…¬å¼ï¼š
$$
\begin{aligned}
p(x\mid y)
&= \frac{p(y\mid x) p(x)}{p(y)}\\
&= \frac{p(y\mid x) p(x)}{\int p(y\mid x) p(x) \mathrm{d}x}
\end{aligned}
$$å¯¹äºçŠ¶æ€ä¼°è®¡é—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä½¿å¾— $p(x\mid y)$ æœ€å¤§çš„çŠ¶æ€ $x$ã€‚ ç”±äº $p(y)$ æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å¿½ç•¥ï¼Œåªéœ€è¦æœ€å¤§åŒ–åˆ†å­éƒ¨åˆ†ã€‚ä½†æ˜¯ä¸€äº›åº”ç”¨åœºæ™¯ä¸­ï¼Œè¿˜éœ€è¦æˆ‘ä»¬è®¡ç®—å‡ºå…·ä½“çš„åéªŒåˆ†å¸ƒçš„å½¢å¼ã€‚ä½†æ˜¯è¿™å¾€å¾€éå¸¸çš„éš¾ï¼Œè¾¹ç¼˜ä¼¼ç„¶ $p(y)$ çš„è®¡ç®—å¾€å¾€æ˜¯å‡ ä¹ä¸å¯èƒ½çš„ã€‚å› æ­¤ä¸€ä¸ªæˆ–è®¸å¯è¡Œçš„åŠæ³•æ˜¯ï¼Œä½¿ç”¨ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åˆ†å¸ƒ $q(x)$ ä»£æ›¿åéªŒåˆ†å¸ƒã€‚é‚£ä¹ˆåŸæœ¬çš„è´å¶æ–¯é—®é¢˜å˜æˆä¸€ä¸ªå˜åˆ†ä¼˜åŒ–é—®é¢˜ï¼Œä¸å¦¨ç”¨ KL æ•£åº¦è¡¡é‡å·®å¼‚ã€‚
2. KL æ•£åº¦çš„ä¸å¯¹ç§°æ€§
ä½†æ˜¯ä¸€ä¸ªå¾ˆæ ¸å¿ƒçš„é—®é¢˜æ˜¯ï¼ŒKL æ•£åº¦ä¸å…·æœ‰å¯¹ç§°æ€§ï¼Œ$D_{KL}(p\| q) \neq D_{KL}(q\| p)$ï¼Œåœ¨å®é™…æ“ä½œä¸­ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿä¸å¦¨å…ˆè§‚å¯Ÿè¿™ä¸¤ä¸ªå¯¹ç§°çš„ KL æ•£åº¦çš„å…·ä½“å½¢å¼ï¼š
$$
\begin{aligned}
D_{KL}(p \| q)
&= -\int p(x\mid y) \log \frac{q(x)}{p(x\mid y)} \mathrm{d}x\\
&= -\int p(x\mid y) \log q(x) \mathrm{d}x + \int p(x\mid y) \log p(x\mid y) \mathrm{d}x
\end{aligned}
$$å…¶ä¸­ï¼Œ$\int p(x\mid y) \log q(x) \mathrm{d}x$ å®è´¨ä¸Šæ˜¯ $p$ ä¸ $q$ ä¹‹é—´çš„äº¤å‰ç†µï¼Œä¸å¦¨å®šä¹‰ $H(p, q) = \int p(x\mid y) \log q(x) \mathrm{d}x$ã€‚è€Œ $\int p(x\mid y) \log p(x\mid y) \mathrm{d}x$ åˆ™æ˜¯å…³äº $p$ çš„ç†µã€‚$p$ çš„ç†µå®è´¨ä¸Šæ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œå› æ­¤å®è´¨ä¸Šï¼š"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wangjv0812.cn/posts/"},{"@type":"ListItem","position":2,"name":"Variational Bayesian Inference","item":"https://wangjv0812.cn/2025/10/variational-bayesian-inference/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Variational Bayesian Inference","name":"Variational Bayesian Inference","description":"1. åŠ¨æœº å¯¹äºä¸€ä¸ªçŠ¶æ€ $x$ï¼Œåœ¨é€šè¿‡ä¼ æ„Ÿå™¨è¿›è¡Œä¸€æ¬¡è§‚æµ‹ $y$ åï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥è®¡ç®—å‡ºåéªŒåˆ†å¸ƒ $p(x\\mid y)$ï¼Œå³åœ¨è§‚æµ‹åˆ° $y$ çš„æƒ…å†µä¸‹ï¼ŒçŠ¶æ€ $x$ çš„åˆ†å¸ƒã€‚ä¸ºäº†è®¡ç®—åéªŒåˆ†å¸ƒçš„å½¢å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è´å¶æ–¯å…¬å¼ï¼š\n$$ \\begin{aligned} p(x\\mid y) \u0026= \\frac{p(y\\mid x) p(x)}{p(y)}\\\\ \u0026= \\frac{p(y\\mid x) p(x)}{\\int p(y\\mid x) p(x) \\mathrm{d}x} \\end{aligned} $$å¯¹äºçŠ¶æ€ä¼°è®¡é—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä½¿å¾— $p(x\\mid y)$ æœ€å¤§çš„çŠ¶æ€ $x$ã€‚ ç”±äº $p(y)$ æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å¿½ç•¥ï¼Œåªéœ€è¦æœ€å¤§åŒ–åˆ†å­éƒ¨åˆ†ã€‚ä½†æ˜¯ä¸€äº›åº”ç”¨åœºæ™¯ä¸­ï¼Œè¿˜éœ€è¦æˆ‘ä»¬è®¡ç®—å‡ºå…·ä½“çš„åéªŒåˆ†å¸ƒçš„å½¢å¼ã€‚ä½†æ˜¯è¿™å¾€å¾€éå¸¸çš„éš¾ï¼Œè¾¹ç¼˜ä¼¼ç„¶ $p(y)$ çš„è®¡ç®—å¾€å¾€æ˜¯å‡ ä¹ä¸å¯èƒ½çš„ã€‚å› æ­¤ä¸€ä¸ªæˆ–è®¸å¯è¡Œçš„åŠæ³•æ˜¯ï¼Œä½¿ç”¨ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åˆ†å¸ƒ $q(x)$ ä»£æ›¿åéªŒåˆ†å¸ƒã€‚é‚£ä¹ˆåŸæœ¬çš„è´å¶æ–¯é—®é¢˜å˜æˆä¸€ä¸ªå˜åˆ†ä¼˜åŒ–é—®é¢˜ï¼Œä¸å¦¨ç”¨ KL æ•£åº¦è¡¡é‡å·®å¼‚ã€‚\n2. KL æ•£åº¦çš„ä¸å¯¹ç§°æ€§ ä½†æ˜¯ä¸€ä¸ªå¾ˆæ ¸å¿ƒçš„é—®é¢˜æ˜¯ï¼ŒKL æ•£åº¦ä¸å…·æœ‰å¯¹ç§°æ€§ï¼Œ$D_{KL}(p\\| q) \\neq D_{KL}(q\\| p)$ï¼Œåœ¨å®é™…æ“ä½œä¸­ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿä¸å¦¨å…ˆè§‚å¯Ÿè¿™ä¸¤ä¸ªå¯¹ç§°çš„ KL æ•£åº¦çš„å…·ä½“å½¢å¼ï¼š\n$$ \\begin{aligned} D_{KL}(p \\| q) \u0026= -\\int p(x\\mid y) \\log \\frac{q(x)}{p(x\\mid y)} \\mathrm{d}x\\\\ \u0026= -\\int p(x\\mid y) \\log q(x) \\mathrm{d}x + \\int p(x\\mid y) \\log p(x\\mid y) \\mathrm{d}x \\end{aligned} $$å…¶ä¸­ï¼Œ$\\int p(x\\mid y) \\log q(x) \\mathrm{d}x$ å®è´¨ä¸Šæ˜¯ $p$ ä¸ $q$ ä¹‹é—´çš„äº¤å‰ç†µï¼Œä¸å¦¨å®šä¹‰ $H(p, q) = \\int p(x\\mid y) \\log q(x) \\mathrm{d}x$ã€‚è€Œ $\\int p(x\\mid y) \\log p(x\\mid y) \\mathrm{d}x$ åˆ™æ˜¯å…³äº $p$ çš„ç†µã€‚$p$ çš„ç†µå®è´¨ä¸Šæ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œå› æ­¤å®è´¨ä¸Šï¼š\n","keywords":["Variational Inference","Bayesian Inference","KL Divergence","ELBO"],"articleBody":"1. åŠ¨æœº å¯¹äºä¸€ä¸ªçŠ¶æ€ $x$ï¼Œåœ¨é€šè¿‡ä¼ æ„Ÿå™¨è¿›è¡Œä¸€æ¬¡è§‚æµ‹ $y$ åï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥è®¡ç®—å‡ºåéªŒåˆ†å¸ƒ $p(x\\mid y)$ï¼Œå³åœ¨è§‚æµ‹åˆ° $y$ çš„æƒ…å†µä¸‹ï¼ŒçŠ¶æ€ $x$ çš„åˆ†å¸ƒã€‚ä¸ºäº†è®¡ç®—åéªŒåˆ†å¸ƒçš„å½¢å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è´å¶æ–¯å…¬å¼ï¼š\n$$ \\begin{aligned} p(x\\mid y) \u0026= \\frac{p(y\\mid x) p(x)}{p(y)}\\\\ \u0026= \\frac{p(y\\mid x) p(x)}{\\int p(y\\mid x) p(x) \\mathrm{d}x} \\end{aligned} $$å¯¹äºçŠ¶æ€ä¼°è®¡é—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä½¿å¾— $p(x\\mid y)$ æœ€å¤§çš„çŠ¶æ€ $x$ã€‚ ç”±äº $p(y)$ æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å¿½ç•¥ï¼Œåªéœ€è¦æœ€å¤§åŒ–åˆ†å­éƒ¨åˆ†ã€‚ä½†æ˜¯ä¸€äº›åº”ç”¨åœºæ™¯ä¸­ï¼Œè¿˜éœ€è¦æˆ‘ä»¬è®¡ç®—å‡ºå…·ä½“çš„åéªŒåˆ†å¸ƒçš„å½¢å¼ã€‚ä½†æ˜¯è¿™å¾€å¾€éå¸¸çš„éš¾ï¼Œè¾¹ç¼˜ä¼¼ç„¶ $p(y)$ çš„è®¡ç®—å¾€å¾€æ˜¯å‡ ä¹ä¸å¯èƒ½çš„ã€‚å› æ­¤ä¸€ä¸ªæˆ–è®¸å¯è¡Œçš„åŠæ³•æ˜¯ï¼Œä½¿ç”¨ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åˆ†å¸ƒ $q(x)$ ä»£æ›¿åéªŒåˆ†å¸ƒã€‚é‚£ä¹ˆåŸæœ¬çš„è´å¶æ–¯é—®é¢˜å˜æˆä¸€ä¸ªå˜åˆ†ä¼˜åŒ–é—®é¢˜ï¼Œä¸å¦¨ç”¨ KL æ•£åº¦è¡¡é‡å·®å¼‚ã€‚\n2. KL æ•£åº¦çš„ä¸å¯¹ç§°æ€§ ä½†æ˜¯ä¸€ä¸ªå¾ˆæ ¸å¿ƒçš„é—®é¢˜æ˜¯ï¼ŒKL æ•£åº¦ä¸å…·æœ‰å¯¹ç§°æ€§ï¼Œ$D_{KL}(p\\| q) \\neq D_{KL}(q\\| p)$ï¼Œåœ¨å®é™…æ“ä½œä¸­ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿä¸å¦¨å…ˆè§‚å¯Ÿè¿™ä¸¤ä¸ªå¯¹ç§°çš„ KL æ•£åº¦çš„å…·ä½“å½¢å¼ï¼š\n$$ \\begin{aligned} D_{KL}(p \\| q) \u0026= -\\int p(x\\mid y) \\log \\frac{q(x)}{p(x\\mid y)} \\mathrm{d}x\\\\ \u0026= -\\int p(x\\mid y) \\log q(x) \\mathrm{d}x + \\int p(x\\mid y) \\log p(x\\mid y) \\mathrm{d}x \\end{aligned} $$å…¶ä¸­ï¼Œ$\\int p(x\\mid y) \\log q(x) \\mathrm{d}x$ å®è´¨ä¸Šæ˜¯ $p$ ä¸ $q$ ä¹‹é—´çš„äº¤å‰ç†µï¼Œä¸å¦¨å®šä¹‰ $H(p, q) = \\int p(x\\mid y) \\log q(x) \\mathrm{d}x$ã€‚è€Œ $\\int p(x\\mid y) \\log p(x\\mid y) \\mathrm{d}x$ åˆ™æ˜¯å…³äº $p$ çš„ç†µã€‚$p$ çš„ç†µå®è´¨ä¸Šæ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œå› æ­¤å®è´¨ä¸Šï¼š\n$$ \\begin{aligned} \\arg \\min_q D_{KL}(p \\| q) \u0026= \\arg \\max \\int p(x\\mid y) \\log q(x) \\mathrm{d}x\\\\ \u0026= \\arg \\max H(p, q) \\end{aligned} $$å› æ­¤ä¼˜åŒ– $D_{KL}(p \\| q)$ å®è´¨ä¸Šç›¸å½“äºä¼˜åŒ– $p$ ä¸ $q$ ä¹‹é—´çš„äº¤å‰ç†µã€‚è§‚å¯Ÿäº¤å‰ç†µçš„å½¢å¼ä¸éš¾å‘ç°ï¼Œæˆ‘ä»¬äº‹å®ä¸Šæ˜¯åœ¨ä¸€ä¸ªå›ºå®šçš„æƒé‡ $p$ ä¸‹ï¼Œæœ€å¤§åŒ– $-\\log q$ã€‚å› æ­¤åˆ†å¸ƒ $p$ ä¸èƒ½å·æ‡’ï¼Œéœ€è¦åœ¨ $p$ æ‰€æœ‰è¶³å¤Ÿå¤§çš„åœ°æ–¹è®© $q$ ä¹Ÿè¶³å¤Ÿå¤§ã€‚æˆ‘ä»¬ä¸éš¾æ¨å¯¼å‡ºï¼Œ$D_{KL}(p \\| q)$ ä¼šå¼ºè¿« $q$ å°½å¯èƒ½çš„è¦†ç›– $p$ çš„æ‰€æœ‰é«˜æ¦‚ç‡åŒºåŸŸã€‚\nåœ¨è¿™ä¸ªç†è§£çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬ä¸å¦¨è§‚å¯Ÿ $D_{KL}(q\\| p)$ï¼Œæœ‰ï¼š\n$$ \\begin{aligned} D_{KL}(q\\| p) \u0026= -\\int q(x) \\log \\frac{p(x\\mid y)}{q(x)} \\mathrm{d}x\\\\ \u0026= -\\int q(x) \\log p(x\\mid y) \\mathrm{d}x + \\int q(x) \\log q(x) \\mathrm{d}x \\end{aligned} $$å› æ­¤ï¼Œä¼˜åŒ–\nåŒæ ·åœ°ï¼Œå®šä¹‰ $H(q, p) = \\int q(x) \\log p(x\\mid y) \\mathrm{d}x$ï¼Œq çš„ç†µæœ‰ $H(q) =-\\int q(x) \\log q(x) \\mathrm{d}x$ã€‚é‚£ä¹ˆä¼˜åŒ–è¿™ä¸ªå½¢å¼ä¸‹çš„ KL æ•£åº¦çš„å½¢å¼å¯ä»¥å†™æˆï¼š\n$$ \\begin{aligned} \\arg \\min_q D_{KL}(q\\| p) \u0026= \\argmax_q H(q, p)\\\\ \u0026= \\argmax_q \\int q(x) \\log p(x\\mid y) \\mathrm{d}x + \\int q(x) \\log q(x) \\mathrm{d}x\\\\ \u0026= \\argmax_q H(q, p) + H(q) \\end{aligned} $$ç±»ä¼¼çš„è§’åº¦åˆ†æï¼Œä¼˜åŒ– $D_{KL}(p \\| q)$ å®è´¨ä¸Šæ˜¯åœ¨æœ€å¤§åŒ– $q$ ä¸ $p$ çš„äº¤å‰ç†µçš„åŸºç¡€ä¸Šå¢åŠ ä¸€ä¸ªè´Ÿç†µçš„æ­£åˆ™åŒ–ï¼Œäº¤å‰ç†µ $H(q, p)$ å®è´¨ä¸Šæ˜¯åœ¨å›ºå®šäº†ä¿¡æ¯åˆ†å¸ƒ $\\log p$ çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ä¼˜åŒ–æƒé‡åˆ†å¸ƒ $q$ æ¥æœ€å¤§åŒ–æœŸæœ›ã€‚æ­¤æ—¶ $q$ æœ‰æ›´å¤§çš„è‡ªç”±åº¦ï¼Œå¯ä»¥ä¸éœ€è¦å°½å¯èƒ½çš„å®Œå…¨è¦†ç›–ï¼Œå¯¹äºæ— æ³•å®Œç¾è¦†ç›–çš„åŒºåŸŸæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡é™ä½æƒé‡å¿½ç•¥æ‰ã€‚ä½†æ˜¯è¿™å¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœåªç”¨äº¤å‰ç†µæŸå¤±ï¼Œ$q$ æœ‰ä¸€ä¸ªè®¨å·§çš„æ–¹æ³•ï¼Œå¯ä»¥å­¦ä¹ ä¸€ä¸ª Dirac Distributionï¼Œç›´æ¥æŠŠæ‰€æœ‰çš„æ¦‚ç‡è´¨é‡éƒ½é›†ä¸­åœ¨ $p$ çš„æœ€å¤§å€¼å¤„ã€‚ä¸ºäº†é¿å…è¿™ä¸ªæƒ…å†µå‡ºç°ï¼Œè´Ÿç†µæ­£åˆ™åŒ– $H(q)$ åˆ™å¼ºè¿«æ¨¡ $q$ ä¸é‚£ä¹ˆé›†ä¸­ï¼Œå­¦ä¹ ä¸€ä¸ªæ›´ â€œå®½â€ çš„åˆ†å¸ƒã€‚å› æ­¤ï¼Œ$D_{KL}(q\\| p)$ ä¼šå¼ºè¿« $q$ å°½å¯èƒ½åœ°é›†ä¸­åœ¨ $p$ çš„æŸä¸€ä¸ªé«˜æ¦‚ç‡åŒºåŸŸï¼Œè€Œå¿½ç•¥æ‰å…¶ä»–çš„é«˜æ¦‚ç‡åŒºåŸŸã€‚\nå¦‚æœ $p(x)$ æ˜¯ä¸€ä¸ªå¤šå³°åˆ†å¸ƒï¼Œé‚£ä¹ˆé€‰æ‹©ä¸åŒçš„ KL æ•£åº¦å¯¹ $q(x)$ çš„å½±å“å¾ˆæ˜æ˜¾ï¼š\nå…¶ä¸­ å›¾(a) æ˜¯é€šè¿‡ $D_{KL}(p\\| q)$ é©±åŠ¨å­¦ä¹ çš„ $q(x)$ï¼Œè€Œ (b) å’Œ (c) åˆ™æ˜¯åœ¨ä¸åŒåˆå§‹ä¸‹é€šè¿‡ $D_{KL}(q\\| p)$ å­¦ä¹ çš„ $q(x)$ã€‚å¯ä»¥çœ‹åˆ° (a) ä¸­çš„ $q(x)$ è¦†ç›–äº† $p(x)$ çš„æ‰€æœ‰é«˜æ¦‚ç‡åŒºåŸŸï¼Œè€Œ (b) å’Œ (c) åˆ™åˆ†åˆ«é›†ä¸­åœ¨ $p(x)$ çš„ä¸åŒå³°å€¼å¤„ã€‚\nä»è¿™ä¸ªè§’åº¦åˆ†æï¼Œä¸éš¾å¾—å‡ºè¿™æ ·çš„ç»“è®ºï¼š\nå¦‚æœæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„æ¨¡å‹ $q$ éœ€è¦å°½å¯èƒ½çš„è¦†ç›–çœŸå®åˆ†å¸ƒ $p$ï¼Œä¸ºæ­¤å¯ä»¥ç‰ºç‰²æ¨¡å‹ä¸€å®šçš„å‡†ç¡®æ€§ï¼Œåˆ™åº”è¯¥é€‰æ‹© $D_{KL}(p\\| q)$ã€‚ å¦‚æœæˆ‘ä»¬å¸Œæœ›æ¨¡å‹ $q$ å°½å¯èƒ½çš„å‡†ç¡®ï¼Œä¸ºäº†å‡†ç¡®æ€§å¯ä»¥æ”¾å¼ƒä¸€äº› corner caseï¼Œåˆ™å¯ä»¥é€‰æ‹© $D_{KL}(q\\| p)$ã€‚ å› ä¸º $q$ æ˜¯è§£æçš„ï¼Œ$D_{KL}(q\\| p)$ é€šå¸¸æ›´å®¹æ˜“è®¡ç®—ã€‚ 3. Bayesian æ¨æ–­å’Œ ELBO å¯¹äº Bayesian Inference é—®é¢˜ï¼Œæˆ‘ä»¬æ— æ³•è®¡ç®—åéªŒåˆ†å¸ƒ $p(x\\mid y)$ï¼Œä¹Ÿæ— æ³•å¾ˆå®¹æ˜“çš„å¯¹å…¶é‡‡æ ·ã€‚æƒ³ç›´æ¥è®¡ç®— $D_{KL}(p \\| q)$ æ˜¯éå¸¸å›°éš¾çš„ã€‚å› æ­¤æˆ‘ä»¬é€‰æ‹©ä¼˜åŒ– $D_{KL}(q\\| p)$ã€‚ä½†æ˜¯è¿™ä¸ªå½¢å¼æ— æ³•ç›´æ¥è®¡ç®—ï¼Œä¸å¦¨å±•å¼€è¿™ä¸ªå½¢å¼åˆ†æï¼š\n$$ \\begin{aligned} D_{KL}(q\\| p) \u0026= -\\int q(x) \\log \\frac{p(x\\mid y)}{q(x)} \\mathrm{d}x\\\\ \u0026= -\\int q(x) \\bigg[\\log p(x\\mid y) - \\log q(x)\\bigg] \\mathrm{d}x\\\\ \u0026= -\\int q(x) \\bigg[\\log p(y\\mid x) + \\log p(x) - \\log p(y)- \\log q(x)\\bigg] \\mathrm{d}x\\\\ \u0026= \\mathbb{E}_{x\\sim q}\\bigg[\\log p(y\\mid x) + \\log p(x) - \\log q(x)\\bigg] - \\mathbb{E}_{x\\sim q}\\bigg[\\log p(y)\\bigg] \\end{aligned} $$å…¶ä¸­ï¼Œæ˜¾ç„¶æœ‰ï¼š\n$$ \\begin{aligned} \\mathbb{E}_{x\\sim q}\\big[ \\log p(y)\\big] = \\log p(y) \\end{aligned} $$é‚£ä¹ˆï¼Œè¿™ä¸ªå½¢å¼å¯ä»¥å˜æ¢ä¸ºï¼š\n$$ \\begin{aligned} D_{KL}(q\\| p) \u0026= \\mathbb{E}_{x\\sim q}\\bigg[\\log p(y\\mid x)\\bigg] - D_{KL}(q(x) \\| p(x)) - \\log p(y) \\end{aligned} $$æ˜¾ç„¶ $\\log p(y)$ æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œå› æ­¤ä¼˜åŒ– $D_{KL}(q\\| p)$ ç­‰ä»·äºä¼˜åŒ–ï¼š\n$$ D_{KL}(q\\| p) \\sim \\mathbb{E}_{x\\sim q}\\bigg[\\log p(y\\mid x)\\bigg] - D_{KL}(q(x) \\| p(x)) $$è¿™ä¸ªå½¢å¼å°±æ˜¯ ELBO (Evidence Lower Bound)ã€‚æˆ‘ä»¬å¯ä»¥å®šä¹‰ï¼š\n$$ \\text{ELBO}(q) = \\mathbb{E}_{x\\sim q}\\bigg[\\log p(y\\mid x)\\bigg] - D_{KL}(q(x) \\| p(x)) $$å¯¹äº ELBOï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ªç­‰ä»·çš„å½¢å¼ã€‚è§‚å¯Ÿä¸Šé¢çš„æ¨å¯¼è¿‡ç¨‹ï¼Œä¸éš¾å‘ç°ï¼š\n$$ \\text{ELBO}(q) = \\mathbb{E}_{x\\sim q}\\bigg[\\log \\frac{p(x, y)}{q(x)}\\bigg] $$æ­¤æ—¶ï¼Œ$\\text{ELBO}(q)$ çš„å½¢å¼æˆ‘ä»¬éƒ½æœ‰å·²ç»äº†è§£äº†ã€‚å¯¹äºä¸€ä¸ªå—åˆ°å‚æ•°æ§åˆ¶åˆ†å¸ƒæ— $q$ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼˜åŒ–ä¸Šé¢çš„å½¢å¼æ¥è·å¾—å¯¹åéªŒæœ€ä¼˜çš„ä¼°è®¡ã€‚\n4. Factorized Variational Inference 4.1. å¯¹äº $D_{KL}(q\\|p)$ çš„ Factorized Variational Inference ä½†æ˜¯æ­¤æ—¶å¯¹äºå…·ä½“å¦‚ä½•ä¼˜åŒ– ELBO è¿˜æ²¡æœ‰ç»™å‡ºä¸€ä¸ªå…·ä½“çš„æ–¹æ³•ã€‚ä¸‹é¢æˆ‘ä»¬è¦å¼•å…¥ä¸€ä¸ªæ¯”è¾ƒå¼±çš„ç®€åŒ–å‡è®¾ã€‚æˆ‘ä»¬å‡è®¾çŠ¶æ€ $x$ ä¹‹é—´ä¸æ˜¯å®Œå…¨è€¦åˆçš„ï¼Œå¯ä»¥åˆ†è§£æˆå‡ ä¸ªç‹¬ç«‹çš„å­çŠ¶æ€ $x = (x_1, x_2, \\ldots, x_n)$ã€‚é‚£ä¹ˆå‡è®¾çš„æ¨¡å‹åˆ†å¸ƒ $q(x)$ å¯ä»¥å†™ä½œï¼š\n$$ q(x) = \\prod_{i=1}^n q_i(x_i) $$è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬æ²¡æœ‰å¯¹ $q(x)$ çš„å…·ä½“å½¢å¼åšä»»ä½•å‡è®¾ï¼Œåªå‡è®¾ $q(x)$ ä¹‹é—´æœ‰å¯ä»¥åˆ†è§£çš„ç‹¬ç«‹åˆ†é‡ã€‚å°†å‡è®¾çš„ $q(x)$ çš„åˆ†è§£å½¢å¼å¸¦å…¥ ELBO ä¸­ï¼Œæœ‰ï¼š\n$$ \\begin{aligned} \\text{ELBO}(q) \u0026= \\mathbb{E}_{x\\sim q}\\bigg[\\log \\frac{p(x, y)}{q(x)}\\bigg]\\\\ \u0026= \\int \\prod_{i=1}^n q_i(x_i) \\bigg[\\log p(x, y) - \\sum_i \\log q_i(x_i) \\bigg] \\mathrm{d}x \\end{aligned} $$æ­¤å¤„ä¸å¦¨ç”¨ç”¨ Fubiniâ€™s theoremï¼Œå°† $x_j$ çš„åˆ†é‡æå–å‡ºæ¥ï¼Œå…ˆå¯¹ $x_j$ ç§¯åˆ†ï¼š\n$$ \\begin{aligned} \\text{ELBO}(q) \u0026= \\int_{x_j} q_j(x_j) \\int_{x_{i\\neq j}} \\prod_{i\\neq j} q_i(x_i) \\bigg[\\log p(x, y) - \\sum_{i\\neq j} \\log q_i(x_i) - \\log q_j(x_j) \\bigg] \\mathrm{d}x_{i\\neq j} \\mathrm{d}x_j\\\\ \u0026= \\int_{x_j} q_j(x_j) \\bigg \\{\\int_{x_{i\\neq j}} \\prod_{i\\neq j} q_i(x_i) \\bigg[\\log p(x, y)\\bigg] \\mathrm{d}x_{i\\neq j} \\\\ \u0026- \\int_{x_{i\\neq j}} \\prod_{i\\neq j} q_i(x_i) \\bigg[\\sum_{i\\neq j} \\log q_i(x_i) \\bigg] \\mathrm{d}x_{i\\neq j} - \\int_{x_{i\\neq j}} \\prod_{i\\neq j} q_i(x_i) \\bigg[ \\log q_j(x_j) \\bigg] \\mathrm{d}x_{i\\neq j} \\bigg \\}\\mathrm{d}x_j\\\\ \\end{aligned} $$å…¶ä¸­ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç° $\\int_{x_{i\\neq j}} \\prod_{i\\neq j} q_i(x_i) \\bigg[\\sum_{i\\neq j} \\log q_i(x_i) \\bigg] \\mathrm{d}x_{i\\neq j}$ æ˜¯ä¸€ä¸ªä¸ $x_j$ æ— å…³çš„å¸¸æ•°ï¼Œä¸å¦¨ç›´æ¥è®°ä½œ $C$ã€‚æ­¤å¤–è¿˜æœ‰ï¼š\n$$ \\begin{aligned} \\int_{x_{i\\neq j}} \\prod_{i\\neq j} q_i(x_i) \\bigg[ \\log qq_j(x_j) \\bigg] \\mathrm{d}x_{i\\neq j} \u0026= \\mathbb{E}_{x\\sim \\prod_{i\\neq j} q_i(x_i)} \\bigg[\\log q_j(x_j)\\bigg]\\\\ \u0026= \\log q_j(x_j) \\end{aligned} $$é‚£ä¹ˆä¸Šé¢çš„å½¢å¼å¯ä»¥åŒ–ç®€ä¸ºï¼š\n$$ \\begin{aligned} \\text{ELBO}(q) \u0026= \\int_{x_j} q_j(x_j) \\left \\{\\int_{x_{i\\neq j}} \\log p(x, y) \\left(\\prod_{i\\neq j} q_i(x_i) \\mathrm{d}x_i\\right) - \\log q_j(x_j) \\right\\}\\mathrm{d}x_j \\end{aligned} $$ä¸éš¾çœ‹å‡ºï¼Œä¸Šå¼ä¸­çš„ç¬¬ä¸€é¡¹æ˜¯ä¸€ä¸ªæœŸæœ›çš„å½¢å¼ï¼Œé‚£ä¹ˆæœ‰ï¼š\n$$ \\int_{x_{i\\neq j}} \\log p(x, y) \\left(\\prod_{i\\neq j} q_i(x_i) \\mathrm{d}x_i\\right) = \\mathbf{E}_{x\\sim \\prod_{i\\neq j} q_i(x_i)} \\big[\\log p(x, y)\\big] $$é‚£ä¹ˆæ ¹æ®ç»å°”å…¹æ›¼åˆ†å¸ƒï¼Œå¯ä»¥å®šä¹‰ä¸€å®šå­˜åœ¨ä¸€ä¸ªåˆ†å¸ƒ $q^*(x_j, y)$ï¼Œæ»¡è¶³ï¼š\n$$ \\log q^*(x_j, y) = \\mathbf{E}_{x\\sim \\prod_{i\\neq j} q_i(x_i)} \\big[\\log p(x, y)\\big] + C' $$é‚£ä¹ˆ $\\text{ELBO}(q)$ å¯ä»¥å†™æˆè¿™æ ·çš„å½¢å¼ï¼š\n$$ \\begin{aligned} \\text{ELBO}(q) = \\int_{x_j} q_j(x_j) \\left[\\log q^*(x_j, y) - \\log q_j(x_j) \\right]\\mathrm{d}x_j \\end{aligned} $$ä½ ä¸€å®šæ³¨æ„åˆ°äº†ï¼Œè¿™äº‹å®ä¸Šæ˜¯ä¸€ä¸ª KL æ•£åº¦ï¼é‚£ä¹ˆå¯ä»¥å†™ä½œï¼š\n$$ \\text{ELBO}(q) = -D_{KL}\\big(q_j(x_j) \\| q^*(x_j, y)\\big) $$å¯¹ä¸Šé¢çš„å½¢å¼æ±‚æœ€ä¼˜ï¼Œäº‹å®ä¸Šå°±æ˜¯å¸Œæœ›ï¼š\n$$ D_{KL}\\big(q_j(x_j) \\| q^*(x_j, y)\\big) = 0 $$é‚£ä¹ˆæœ‰ï¼š\n$$ \\begin{aligned} \\log q_j(x_j) \u0026= \\log q^*(x_j, y)\\\\ \u0026= \\mathbf{E}_{x\\sim \\prod_{i\\neq j} q_i(x_i)} \\big[\\log p(x, y)\\big] + C' \\end{aligned} $$coolï¼æˆ‘ä»¬æˆåŠŸçš„å°†ä¸€ä¸ªæœ€ä¼˜åŒ–é—®é¢˜å˜ä¸ºäº†ä¸€ä¸ªå¯ä»¥ Monto Carlo ç”šè‡³ç›´æ¥è§£æçš„è§£å†³çš„æœŸæœ›é—®é¢˜ã€‚ä½†æ˜¯ç°åœ¨è¿˜é¢ä¸´ä¸€ä¸ªå°éº»çƒ¦ã€‚æˆ‘ä»¬åœ¨è®¡ç®—ç¬¬ $i$ ä¸ªå­—ç©ºé—´çš„åˆ†å¸ƒæ—¶ï¼Œä»¥æ¥äºå…¶ä»–æ‰€æœ‰å­—ç©ºé—´çš„åˆ†å¸ƒã€‚è¿™ä¼¼ä¹æˆäº†ä¸€ä¸ªå…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹çš„æ­»å±€ã€‚ä½†æ˜¯ç²¾é€šæ•°å€¼åˆ†æçš„ä½ ä¸€å®šä¸é™Œç”Ÿï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå¯¹æ‰€æœ‰å­ç©ºé—´çš„åˆ†å¸ƒåšä¸€ä¸ªè¶³å¤Ÿçš„åˆå§‹ï¼Œä¹‹åè¿­ä»£è®¡ç®—å³å¯ã€‚\n","wordCount":"770","inLanguage":"en","image":"https://wangjv0812.cn/","datePublished":"2025-10-28T23:35:25+08:00","dateModified":"2025-10-28T23:35:25+08:00","author":{"@type":"Person","name":"WangJV"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wangjv0812.cn/2025/10/variational-bayesian-inference/"},"publisher":{"@type":"Organization","name":"WangJV Blog","logo":{"@type":"ImageObject","url":"https://wangjv0812.cn/icon/favicon-32x32.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wangjv0812.cn/ accesskey=h title="WangJV Blog (Alt + H)"><img src=https://wangjv0812.cn/icon/translucent-icon.png alt aria-label=logo height=35>WangJV Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wangjv0812.cn/ title=Home><span>Home</span></a></li><li><a href=https://wangjv0812.cn/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://wangjv0812.cn/resources/ title=Resources><span>Resources</span></a></li><li><a href=https://wangjv0812.cn/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://wangjv0812.cn/search/ title="ğŸ” Search (Alt + /)" accesskey=/><span>ğŸ” Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wangjv0812.cn/>Home</a>&nbsp;Â»&nbsp;<a href=https://wangjv0812.cn/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Variational Bayesian Inference</h1><div class=post-meta><span title='2025-10-28 23:35:25 +0800 +0800'>October 28, 2025</span>&nbsp;Â·&nbsp;WangJV&nbsp;|&nbsp;<a href=https://github.com/WangJV0812/WangJV-Blog-Source/tree/master/content/posts/Variational%20Bayesian%20Inference/index.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#1-åŠ¨æœº>1. åŠ¨æœº</a></li><li><a href=#2-kl-æ•£åº¦çš„ä¸å¯¹ç§°æ€§>2. KL æ•£åº¦çš„ä¸å¯¹ç§°æ€§</a></li><li><a href=#3-bayesian-æ¨æ–­å’Œ-elbo>3. Bayesian æ¨æ–­å’Œ ELBO</a></li><li><a href=#4-factorized-variational-inference>4. Factorized Variational Inference</a><ul><li><a href=#41-å¯¹äº--çš„-factorized-variational-inference>4.1. å¯¹äº çš„ Factorized Variational Inference</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=1-åŠ¨æœº>1. åŠ¨æœº<a hidden class=anchor aria-hidden=true href=#1-åŠ¨æœº>#</a></h2><p>å¯¹äºä¸€ä¸ªçŠ¶æ€ $x$ï¼Œåœ¨é€šè¿‡ä¼ æ„Ÿå™¨è¿›è¡Œä¸€æ¬¡è§‚æµ‹ $y$ åï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥è®¡ç®—å‡ºåéªŒåˆ†å¸ƒ $p(x\mid y)$ï¼Œå³åœ¨è§‚æµ‹åˆ° $y$ çš„æƒ…å†µä¸‹ï¼ŒçŠ¶æ€ $x$ çš„åˆ†å¸ƒã€‚ä¸ºäº†è®¡ç®—åéªŒåˆ†å¸ƒçš„å½¢å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è´å¶æ–¯å…¬å¼ï¼š</p>$$
\begin{aligned}
p(x\mid y)
&= \frac{p(y\mid x) p(x)}{p(y)}\\
&= \frac{p(y\mid x) p(x)}{\int p(y\mid x) p(x) \mathrm{d}x}
\end{aligned}
$$<p>å¯¹äºçŠ¶æ€ä¼°è®¡é—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä½¿å¾— $p(x\mid y)$ æœ€å¤§çš„çŠ¶æ€ $x$ã€‚ ç”±äº $p(y)$ æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å¿½ç•¥ï¼Œåªéœ€è¦æœ€å¤§åŒ–åˆ†å­éƒ¨åˆ†ã€‚ä½†æ˜¯ä¸€äº›åº”ç”¨åœºæ™¯ä¸­ï¼Œè¿˜éœ€è¦æˆ‘ä»¬è®¡ç®—å‡ºå…·ä½“çš„åéªŒåˆ†å¸ƒçš„å½¢å¼ã€‚ä½†æ˜¯è¿™å¾€å¾€éå¸¸çš„éš¾ï¼Œè¾¹ç¼˜ä¼¼ç„¶ $p(y)$ çš„è®¡ç®—å¾€å¾€æ˜¯å‡ ä¹ä¸å¯èƒ½çš„ã€‚å› æ­¤ä¸€ä¸ªæˆ–è®¸å¯è¡Œçš„åŠæ³•æ˜¯ï¼Œä½¿ç”¨ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åˆ†å¸ƒ $q(x)$ ä»£æ›¿åéªŒåˆ†å¸ƒã€‚é‚£ä¹ˆåŸæœ¬çš„è´å¶æ–¯é—®é¢˜å˜æˆä¸€ä¸ªå˜åˆ†ä¼˜åŒ–é—®é¢˜ï¼Œä¸å¦¨ç”¨ KL æ•£åº¦è¡¡é‡å·®å¼‚ã€‚</p><h2 id=2-kl-æ•£åº¦çš„ä¸å¯¹ç§°æ€§>2. KL æ•£åº¦çš„ä¸å¯¹ç§°æ€§<a hidden class=anchor aria-hidden=true href=#2-kl-æ•£åº¦çš„ä¸å¯¹ç§°æ€§>#</a></h2><p>ä½†æ˜¯ä¸€ä¸ªå¾ˆæ ¸å¿ƒçš„é—®é¢˜æ˜¯ï¼ŒKL æ•£åº¦ä¸å…·æœ‰å¯¹ç§°æ€§ï¼Œ$D_{KL}(p\| q) \neq D_{KL}(q\| p)$ï¼Œåœ¨å®é™…æ“ä½œä¸­ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿä¸å¦¨å…ˆè§‚å¯Ÿè¿™ä¸¤ä¸ªå¯¹ç§°çš„ KL æ•£åº¦çš„å…·ä½“å½¢å¼ï¼š</p>$$
\begin{aligned}
D_{KL}(p \| q)
&= -\int p(x\mid y) \log \frac{q(x)}{p(x\mid y)} \mathrm{d}x\\
&= -\int p(x\mid y) \log q(x) \mathrm{d}x + \int p(x\mid y) \log p(x\mid y) \mathrm{d}x
\end{aligned}
$$<p>å…¶ä¸­ï¼Œ$\int p(x\mid y) \log q(x) \mathrm{d}x$ å®è´¨ä¸Šæ˜¯ $p$ ä¸ $q$ ä¹‹é—´çš„äº¤å‰ç†µï¼Œä¸å¦¨å®šä¹‰ $H(p, q) = \int p(x\mid y) \log q(x) \mathrm{d}x$ã€‚è€Œ $\int p(x\mid y) \log p(x\mid y) \mathrm{d}x$ åˆ™æ˜¯å…³äº $p$ çš„ç†µã€‚$p$ çš„ç†µå®è´¨ä¸Šæ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œå› æ­¤å®è´¨ä¸Šï¼š</p>$$
\begin{aligned}
\arg \min_q D_{KL}(p \| q)
&= \arg \max \int p(x\mid y) \log q(x) \mathrm{d}x\\
&= \arg \max H(p, q)
\end{aligned}
$$<p>å› æ­¤ä¼˜åŒ– $D_{KL}(p \| q)$ å®è´¨ä¸Šç›¸å½“äºä¼˜åŒ– $p$ ä¸ $q$ ä¹‹é—´çš„äº¤å‰ç†µã€‚è§‚å¯Ÿäº¤å‰ç†µçš„å½¢å¼ä¸éš¾å‘ç°ï¼Œæˆ‘ä»¬äº‹å®ä¸Šæ˜¯åœ¨ä¸€ä¸ªå›ºå®šçš„æƒé‡ $p$ ä¸‹ï¼Œæœ€å¤§åŒ– $-\log q$ã€‚å› æ­¤åˆ†å¸ƒ $p$ ä¸èƒ½å·æ‡’ï¼Œéœ€è¦åœ¨ $p$ æ‰€æœ‰è¶³å¤Ÿå¤§çš„åœ°æ–¹è®© $q$ ä¹Ÿè¶³å¤Ÿå¤§ã€‚æˆ‘ä»¬ä¸éš¾æ¨å¯¼å‡ºï¼Œ<strong>$D_{KL}(p \| q)$ ä¼šå¼ºè¿« $q$ å°½å¯èƒ½çš„è¦†ç›– $p$ çš„æ‰€æœ‰é«˜æ¦‚ç‡åŒºåŸŸã€‚</strong></p><p>åœ¨è¿™ä¸ªç†è§£çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬ä¸å¦¨è§‚å¯Ÿ $D_{KL}(q\| p)$ï¼Œæœ‰ï¼š</p>$$
\begin{aligned}
D_{KL}(q\| p)
&= -\int q(x) \log \frac{p(x\mid y)}{q(x)} \mathrm{d}x\\
&= -\int q(x) \log p(x\mid y) \mathrm{d}x + \int q(x) \log q(x) \mathrm{d}x
\end{aligned}
$$<p>å› æ­¤ï¼Œä¼˜åŒ–</p><p>åŒæ ·åœ°ï¼Œå®šä¹‰ $H(q, p) = \int q(x) \log p(x\mid y) \mathrm{d}x$ï¼Œq çš„ç†µæœ‰ $H(q) =-\int q(x) \log q(x) \mathrm{d}x$ã€‚é‚£ä¹ˆä¼˜åŒ–è¿™ä¸ªå½¢å¼ä¸‹çš„ KL æ•£åº¦çš„å½¢å¼å¯ä»¥å†™æˆï¼š</p>$$
\begin{aligned}
\arg \min_q D_{KL}(q\| p)
&= \argmax_q H(q, p)\\
&= \argmax_q \int q(x) \log p(x\mid y) \mathrm{d}x + \int q(x) \log q(x) \mathrm{d}x\\
&= \argmax_q H(q, p) + H(q)
\end{aligned}
$$<p>ç±»ä¼¼çš„è§’åº¦åˆ†æï¼Œä¼˜åŒ– $D_{KL}(p \| q)$ å®è´¨ä¸Šæ˜¯åœ¨æœ€å¤§åŒ– $q$ ä¸ $p$ çš„äº¤å‰ç†µçš„åŸºç¡€ä¸Šå¢åŠ ä¸€ä¸ªè´Ÿç†µçš„æ­£åˆ™åŒ–ï¼Œäº¤å‰ç†µ $H(q, p)$ å®è´¨ä¸Šæ˜¯åœ¨å›ºå®šäº†ä¿¡æ¯åˆ†å¸ƒ $\log p$ çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ä¼˜åŒ–æƒé‡åˆ†å¸ƒ $q$ æ¥æœ€å¤§åŒ–æœŸæœ›ã€‚æ­¤æ—¶ $q$ æœ‰æ›´å¤§çš„è‡ªç”±åº¦ï¼Œå¯ä»¥ä¸éœ€è¦å°½å¯èƒ½çš„å®Œå…¨è¦†ç›–ï¼Œå¯¹äºæ— æ³•å®Œç¾è¦†ç›–çš„åŒºåŸŸæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡é™ä½æƒé‡å¿½ç•¥æ‰ã€‚ä½†æ˜¯è¿™å¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœåªç”¨äº¤å‰ç†µæŸå¤±ï¼Œ$q$ æœ‰ä¸€ä¸ªè®¨å·§çš„æ–¹æ³•ï¼Œå¯ä»¥å­¦ä¹ ä¸€ä¸ª Dirac Distributionï¼Œç›´æ¥æŠŠæ‰€æœ‰çš„æ¦‚ç‡è´¨é‡éƒ½é›†ä¸­åœ¨ $p$ çš„æœ€å¤§å€¼å¤„ã€‚ä¸ºäº†é¿å…è¿™ä¸ªæƒ…å†µå‡ºç°ï¼Œè´Ÿç†µæ­£åˆ™åŒ– $H(q)$ åˆ™å¼ºè¿«æ¨¡ $q$ ä¸é‚£ä¹ˆé›†ä¸­ï¼Œå­¦ä¹ ä¸€ä¸ªæ›´ â€œå®½â€ çš„åˆ†å¸ƒã€‚å› æ­¤ï¼Œ<strong>$D_{KL}(q\| p)$ ä¼šå¼ºè¿« $q$ å°½å¯èƒ½åœ°é›†ä¸­åœ¨ $p$ çš„æŸä¸€ä¸ªé«˜æ¦‚ç‡åŒºåŸŸï¼Œè€Œå¿½ç•¥æ‰å…¶ä»–çš„é«˜æ¦‚ç‡åŒºåŸŸã€‚</strong></p><p>å¦‚æœ $p(x)$ æ˜¯ä¸€ä¸ªå¤šå³°åˆ†å¸ƒï¼Œé‚£ä¹ˆé€‰æ‹©ä¸åŒçš„ KL æ•£åº¦å¯¹ $q(x)$ çš„å½±å“å¾ˆæ˜æ˜¾ï¼š</p><p><img alt="comparison of alternative KL Divergence" loading=lazy src=https://wangjv0812.cn/2025/10/variational-bayesian-inference/Images/Comparison_of_Alternative_KL.png></p><p>å…¶ä¸­ å›¾(a) æ˜¯é€šè¿‡ $D_{KL}(p\| q)$ é©±åŠ¨å­¦ä¹ çš„ $q(x)$ï¼Œè€Œ (b) å’Œ (c) åˆ™æ˜¯åœ¨ä¸åŒåˆå§‹ä¸‹é€šè¿‡ $D_{KL}(q\| p)$ å­¦ä¹ çš„ $q(x)$ã€‚å¯ä»¥çœ‹åˆ° (a) ä¸­çš„ $q(x)$ è¦†ç›–äº† $p(x)$ çš„æ‰€æœ‰é«˜æ¦‚ç‡åŒºåŸŸï¼Œè€Œ (b) å’Œ (c) åˆ™åˆ†åˆ«é›†ä¸­åœ¨ $p(x)$ çš„ä¸åŒå³°å€¼å¤„ã€‚</p><p>ä»è¿™ä¸ªè§’åº¦åˆ†æï¼Œä¸éš¾å¾—å‡ºè¿™æ ·çš„ç»“è®ºï¼š</p><ol><li>å¦‚æœæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„æ¨¡å‹ $q$ éœ€è¦å°½å¯èƒ½çš„è¦†ç›–çœŸå®åˆ†å¸ƒ $p$ï¼Œä¸ºæ­¤å¯ä»¥ç‰ºç‰²æ¨¡å‹ä¸€å®šçš„å‡†ç¡®æ€§ï¼Œåˆ™åº”è¯¥é€‰æ‹© $D_{KL}(p\| q)$ã€‚</li><li>å¦‚æœæˆ‘ä»¬å¸Œæœ›æ¨¡å‹ $q$ å°½å¯èƒ½çš„å‡†ç¡®ï¼Œä¸ºäº†å‡†ç¡®æ€§å¯ä»¥æ”¾å¼ƒä¸€äº› corner caseï¼Œåˆ™å¯ä»¥é€‰æ‹© $D_{KL}(q\| p)$ã€‚</li><li>å› ä¸º $q$ æ˜¯è§£æçš„ï¼Œ$D_{KL}(q\| p)$ é€šå¸¸æ›´å®¹æ˜“è®¡ç®—ã€‚</li></ol><h2 id=3-bayesian-æ¨æ–­å’Œ-elbo>3. Bayesian æ¨æ–­å’Œ ELBO<a hidden class=anchor aria-hidden=true href=#3-bayesian-æ¨æ–­å’Œ-elbo>#</a></h2><p>å¯¹äº Bayesian Inference é—®é¢˜ï¼Œæˆ‘ä»¬æ— æ³•è®¡ç®—åéªŒåˆ†å¸ƒ $p(x\mid y)$ï¼Œä¹Ÿæ— æ³•å¾ˆå®¹æ˜“çš„å¯¹å…¶é‡‡æ ·ã€‚æƒ³ç›´æ¥è®¡ç®— $D_{KL}(p \| q)$ æ˜¯éå¸¸å›°éš¾çš„ã€‚å› æ­¤æˆ‘ä»¬é€‰æ‹©ä¼˜åŒ– $D_{KL}(q\| p)$ã€‚ä½†æ˜¯è¿™ä¸ªå½¢å¼æ— æ³•ç›´æ¥è®¡ç®—ï¼Œä¸å¦¨å±•å¼€è¿™ä¸ªå½¢å¼åˆ†æï¼š</p>$$
\begin{aligned}
D_{KL}(q\| p)
&= -\int q(x) \log \frac{p(x\mid y)}{q(x)} \mathrm{d}x\\
&= -\int q(x) \bigg[\log p(x\mid y) - \log q(x)\bigg] \mathrm{d}x\\
&= -\int q(x) \bigg[\log p(y\mid x) + \log p(x) - \log p(y)- \log q(x)\bigg] \mathrm{d}x\\
&= \mathbb{E}_{x\sim q}\bigg[\log p(y\mid x) + \log p(x) - \log q(x)\bigg] - \mathbb{E}_{x\sim q}\bigg[\log p(y)\bigg]
\end{aligned}
$$<p>å…¶ä¸­ï¼Œæ˜¾ç„¶æœ‰ï¼š</p>$$
\begin{aligned}
\mathbb{E}_{x\sim q}\big[ \log p(y)\big] = \log p(y)
\end{aligned}
$$<p>é‚£ä¹ˆï¼Œè¿™ä¸ªå½¢å¼å¯ä»¥å˜æ¢ä¸ºï¼š</p>$$
\begin{aligned}
D_{KL}(q\| p)
&= \mathbb{E}_{x\sim q}\bigg[\log p(y\mid x)\bigg] - D_{KL}(q(x) \| p(x)) - \log p(y)
\end{aligned}
$$<p>æ˜¾ç„¶ $\log p(y)$ æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œå› æ­¤ä¼˜åŒ– $D_{KL}(q\| p)$ ç­‰ä»·äºä¼˜åŒ–ï¼š</p>$$
D_{KL}(q\| p) \sim \mathbb{E}_{x\sim q}\bigg[\log p(y\mid x)\bigg] - D_{KL}(q(x) \| p(x))
$$<p>è¿™ä¸ªå½¢å¼å°±æ˜¯ ELBO (Evidence Lower Bound)ã€‚æˆ‘ä»¬å¯ä»¥å®šä¹‰ï¼š</p>$$
\text{ELBO}(q) = \mathbb{E}_{x\sim q}\bigg[\log p(y\mid x)\bigg] - D_{KL}(q(x) \| p(x))
$$<p>å¯¹äº ELBOï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ªç­‰ä»·çš„å½¢å¼ã€‚è§‚å¯Ÿä¸Šé¢çš„æ¨å¯¼è¿‡ç¨‹ï¼Œä¸éš¾å‘ç°ï¼š</p>$$
\text{ELBO}(q) = \mathbb{E}_{x\sim q}\bigg[\log \frac{p(x, y)}{q(x)}\bigg]
$$<p>æ­¤æ—¶ï¼Œ$\text{ELBO}(q)$ çš„å½¢å¼æˆ‘ä»¬éƒ½æœ‰å·²ç»äº†è§£äº†ã€‚å¯¹äºä¸€ä¸ªå—åˆ°å‚æ•°æ§åˆ¶åˆ†å¸ƒæ— $q$ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼˜åŒ–ä¸Šé¢çš„å½¢å¼æ¥è·å¾—å¯¹åéªŒæœ€ä¼˜çš„ä¼°è®¡ã€‚</p><h2 id=4-factorized-variational-inference>4. Factorized Variational Inference<a hidden class=anchor aria-hidden=true href=#4-factorized-variational-inference>#</a></h2><h3 id=41-å¯¹äº--çš„-factorized-variational-inference>4.1. å¯¹äº $D_{KL}(q\|p)$ çš„ Factorized Variational Inference<a hidden class=anchor aria-hidden=true href=#41-å¯¹äº--çš„-factorized-variational-inference>#</a></h3><p>ä½†æ˜¯æ­¤æ—¶å¯¹äºå…·ä½“å¦‚ä½•ä¼˜åŒ– ELBO è¿˜æ²¡æœ‰ç»™å‡ºä¸€ä¸ªå…·ä½“çš„æ–¹æ³•ã€‚ä¸‹é¢æˆ‘ä»¬è¦å¼•å…¥ä¸€ä¸ªæ¯”è¾ƒå¼±çš„ç®€åŒ–å‡è®¾ã€‚æˆ‘ä»¬å‡è®¾çŠ¶æ€ $x$ ä¹‹é—´ä¸æ˜¯å®Œå…¨è€¦åˆçš„ï¼Œå¯ä»¥åˆ†è§£æˆå‡ ä¸ªç‹¬ç«‹çš„å­çŠ¶æ€ $x = (x_1, x_2, \ldots, x_n)$ã€‚é‚£ä¹ˆå‡è®¾çš„æ¨¡å‹åˆ†å¸ƒ $q(x)$ å¯ä»¥å†™ä½œï¼š</p>$$
q(x) = \prod_{i=1}^n q_i(x_i)
$$<p>è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬æ²¡æœ‰å¯¹ $q(x)$ çš„å…·ä½“å½¢å¼åšä»»ä½•å‡è®¾ï¼Œåªå‡è®¾ $q(x)$ ä¹‹é—´æœ‰å¯ä»¥åˆ†è§£çš„ç‹¬ç«‹åˆ†é‡ã€‚å°†å‡è®¾çš„ $q(x)$ çš„åˆ†è§£å½¢å¼å¸¦å…¥ ELBO ä¸­ï¼Œæœ‰ï¼š</p>$$
\begin{aligned}
\text{ELBO}(q)
&= \mathbb{E}_{x\sim q}\bigg[\log \frac{p(x, y)}{q(x)}\bigg]\\
&= \int \prod_{i=1}^n q_i(x_i) \bigg[\log p(x, y) - \sum_i \log q_i(x_i) \bigg] \mathrm{d}x
\end{aligned}
$$<p>æ­¤å¤„ä¸å¦¨ç”¨ç”¨ Fubini&rsquo;s theoremï¼Œå°† $x_j$ çš„åˆ†é‡æå–å‡ºæ¥ï¼Œå…ˆå¯¹ $x_j$ ç§¯åˆ†ï¼š</p>$$
\begin{aligned}
\text{ELBO}(q)
&= \int_{x_j} q_j(x_j) \int_{x_{i\neq j}} \prod_{i\neq j} q_i(x_i) \bigg[\log p(x, y) - \sum_{i\neq j} \log q_i(x_i) - \log q_j(x_j) \bigg] \mathrm{d}x_{i\neq j} \mathrm{d}x_j\\
&= \int_{x_j} q_j(x_j) \bigg \{\int_{x_{i\neq j}} \prod_{i\neq j} q_i(x_i) \bigg[\log p(x, y)\bigg] \mathrm{d}x_{i\neq j} \\
&- \int_{x_{i\neq j}} \prod_{i\neq j} q_i(x_i) \bigg[\sum_{i\neq j} \log q_i(x_i) \bigg] \mathrm{d}x_{i\neq j} - \int_{x_{i\neq j}} \prod_{i\neq j} q_i(x_i) \bigg[ \log q_j(x_j) \bigg] \mathrm{d}x_{i\neq j} \bigg \}\mathrm{d}x_j\\
\end{aligned}
$$<p>å…¶ä¸­ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç° $\int_{x_{i\neq j}} \prod_{i\neq j} q_i(x_i) \bigg[\sum_{i\neq j} \log q_i(x_i) \bigg] \mathrm{d}x_{i\neq j}$ æ˜¯ä¸€ä¸ªä¸ $x_j$ æ— å…³çš„å¸¸æ•°ï¼Œä¸å¦¨ç›´æ¥è®°ä½œ $C$ã€‚æ­¤å¤–è¿˜æœ‰ï¼š</p>$$
\begin{aligned}
\int_{x_{i\neq j}} \prod_{i\neq j} q_i(x_i) \bigg[ \log qq_j(x_j) \bigg] \mathrm{d}x_{i\neq j}
&= \mathbb{E}_{x\sim \prod_{i\neq j} q_i(x_i)} \bigg[\log q_j(x_j)\bigg]\\
&= \log q_j(x_j)
\end{aligned}
$$<p>é‚£ä¹ˆä¸Šé¢çš„å½¢å¼å¯ä»¥åŒ–ç®€ä¸ºï¼š</p>$$
\begin{aligned}
\text{ELBO}(q)
&= \int_{x_j} q_j(x_j) \left \{\int_{x_{i\neq j}} \log p(x, y) \left(\prod_{i\neq j} q_i(x_i) \mathrm{d}x_i\right) - \log q_j(x_j) \right\}\mathrm{d}x_j
\end{aligned}
$$<p>ä¸éš¾çœ‹å‡ºï¼Œä¸Šå¼ä¸­çš„ç¬¬ä¸€é¡¹æ˜¯ä¸€ä¸ªæœŸæœ›çš„å½¢å¼ï¼Œé‚£ä¹ˆæœ‰ï¼š</p>$$
\int_{x_{i\neq j}} \log p(x, y) \left(\prod_{i\neq j} q_i(x_i) \mathrm{d}x_i\right) = \mathbf{E}_{x\sim \prod_{i\neq j} q_i(x_i)} \big[\log p(x, y)\big]
$$<p>é‚£ä¹ˆæ ¹æ®ç»å°”å…¹æ›¼åˆ†å¸ƒï¼Œå¯ä»¥å®šä¹‰ä¸€å®šå­˜åœ¨ä¸€ä¸ªåˆ†å¸ƒ $q^*(x_j, y)$ï¼Œæ»¡è¶³ï¼š</p>$$
\log q^*(x_j, y) = \mathbf{E}_{x\sim \prod_{i\neq j} q_i(x_i)} \big[\log p(x, y)\big] + C'
$$<p>é‚£ä¹ˆ $\text{ELBO}(q)$ å¯ä»¥å†™æˆè¿™æ ·çš„å½¢å¼ï¼š</p>$$
\begin{aligned}
\text{ELBO}(q) = \int_{x_j} q_j(x_j) \left[\log q^*(x_j, y) - \log q_j(x_j) \right]\mathrm{d}x_j
\end{aligned}
$$<p>ä½ ä¸€å®šæ³¨æ„åˆ°äº†ï¼Œè¿™äº‹å®ä¸Šæ˜¯ä¸€ä¸ª KL æ•£åº¦ï¼é‚£ä¹ˆå¯ä»¥å†™ä½œï¼š</p>$$
\text{ELBO}(q) = -D_{KL}\big(q_j(x_j) \| q^*(x_j, y)\big)
$$<p>å¯¹ä¸Šé¢çš„å½¢å¼æ±‚æœ€ä¼˜ï¼Œäº‹å®ä¸Šå°±æ˜¯å¸Œæœ›ï¼š</p>$$
D_{KL}\big(q_j(x_j) \| q^*(x_j, y)\big) = 0
$$<p>é‚£ä¹ˆæœ‰ï¼š</p>$$
\begin{aligned}
\log q_j(x_j)
&= \log q^*(x_j, y)\\
&= \mathbf{E}_{x\sim \prod_{i\neq j} q_i(x_i)} \big[\log p(x, y)\big] + C'
\end{aligned}
$$<p>coolï¼æˆ‘ä»¬æˆåŠŸçš„å°†ä¸€ä¸ªæœ€ä¼˜åŒ–é—®é¢˜å˜ä¸ºäº†ä¸€ä¸ªå¯ä»¥ Monto Carlo ç”šè‡³ç›´æ¥è§£æçš„è§£å†³çš„æœŸæœ›é—®é¢˜ã€‚ä½†æ˜¯ç°åœ¨è¿˜é¢ä¸´ä¸€ä¸ªå°éº»çƒ¦ã€‚æˆ‘ä»¬åœ¨è®¡ç®—ç¬¬ $i$ ä¸ªå­—ç©ºé—´çš„åˆ†å¸ƒæ—¶ï¼Œä»¥æ¥äºå…¶ä»–æ‰€æœ‰å­—ç©ºé—´çš„åˆ†å¸ƒã€‚è¿™ä¼¼ä¹æˆäº†ä¸€ä¸ªå…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹çš„æ­»å±€ã€‚ä½†æ˜¯ç²¾é€šæ•°å€¼åˆ†æçš„ä½ ä¸€å®šä¸é™Œç”Ÿï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå¯¹æ‰€æœ‰å­ç©ºé—´çš„åˆ†å¸ƒåšä¸€ä¸ªè¶³å¤Ÿçš„åˆå§‹ï¼Œä¹‹åè¿­ä»£è®¡ç®—å³å¯ã€‚</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://wangjv0812.cn/tags/variational-inference/>Variational Inference</a></li><li><a href=https://wangjv0812.cn/tags/bayesian-inference/>Bayesian Inference</a></li><li><a href=https://wangjv0812.cn/tags/kl-divergence/>KL Divergence</a></li><li><a href=https://wangjv0812.cn/tags/elbo/>ELBO</a></li></ul><nav class=paginav><a class=prev href=https://wangjv0812.cn/2025/10/geodesic-and-lie-algebra-in-so3/><span class=title>Â« Prev</span><br><span>Geodesic and Lie Algebra in SO(3)</span>
</a><a class=next href=https://wangjv0812.cn/2025/10/variational-autoencoder/><span class=title>Next Â»</span><br><span>Variational AutoEncoder</span></a></nav></footer><script src=https://giscus.app/client.js data-repo=WangJV0812/WangJV-Blog-Pages data-repo-id=R_kgDOPZMmQw data-category=comments data-category-id=DIC_kwDOPZMmQ84Czj63 data-mapping=url data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2025 <a href=https://wangjv0812.cn/>WangJV Blog</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>