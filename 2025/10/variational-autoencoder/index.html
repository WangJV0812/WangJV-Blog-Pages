<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Variational AutoEncoder | WangJV Blog</title><meta name=keywords content="unsupervised learning,æ•°æ®ç”Ÿæˆ,VAE"><meta name=description content="1. åŠ¨æœºå’Œæ¨å¯¼
å¯¹äºæ— ç›‘ç£çš„æ ·æœ¬ç”Ÿæˆé—®é¢˜ï¼Œæˆ‘ä»¬ä¹‹å‰å·²ç»æåˆ°è¿‡å¾ˆå¤šæ¬¡ï¼Œå¯¹äºä¸€ç³»åˆ—åŒç±»å‹çš„æ•°æ® $\{x_1, x_2, \cdots, x_n\}$ï¼Œæˆ‘ä»¬å‡è®¾å­˜åœ¨ä¸€ä¸ªç†æƒ³çš„åˆ†å¸ƒ $p(x)$ï¼Œè¿™äº›æ•°æ®éƒ½æ˜¯ä»è¿™ä¸ªåˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ°çš„ã€‚ä½†æ˜¯æƒ³ç›´æ¥å­¦ä¹ è¿™ä¸ªåˆ†å¸ƒéå¸¸éš¾ã€‚é‚£ä¹ˆæ˜¯å¦æœ‰å¯èƒ½é€šè¿‡ä¸€ä¸ªè¶³å¤Ÿå¤æ‚çš„ç¥ç»ç½‘ç»œæ¥è¿‘ä¼¼è¿™ä¸ªç†æƒ³åˆ†å¸ƒï¼Ÿæ­¤å¤–ï¼Œæœ‰ä¸€å®šç¥ç»ç»éªŒçš„æœ‹å‹å¾€å¾€æœ‰ä¸€ä¸ªä¿¡å¿µï¼šâ€œå‹ç¼©å³æ™ºèƒ½â€ã€‚é‚£ä¹ˆæ˜¯å¦å¯ä»¥å…ˆå­¦ä¹ ä¸€ä¸ªç¼–ç å™¨ $p(z\mid x)$ å°†åŸæœ‰çš„éšæœºå‘é‡ $x$ å˜æ¢åˆ°ä¸€ä¸ªä½ç»´çš„æ½œç©ºé—´ $z$ï¼Œç„¶åå†é€šè¿‡ä¸€ä¸ªè§£ç å™¨ $p(x\mid z)$ å°†æ½œç©ºé—´çš„å‘é‡ $z$ é‡æ–°æ˜ å°„å›åŸå§‹ç©ºé—´ï¼Œä»è€Œå®ç°å¯¹æ•°æ®çš„ç”Ÿæˆå’Œé‡æ„ï¼Ÿ
å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVariational AutoEncoderï¼‰å°±æ˜¯è¿™ä¸ªæ€è·¯çš„å…·ä½“å®ç°ã€‚æ˜¾ç„¶ï¼Œé€šè¿‡è§£ç å™¨é‡å»ºåˆ†å¸ƒ $p(x)$ å¯ä»¥æè¿°ä¸ºï¼š
$$
p_\theta(x) = \int p_\theta(x\mid z) p(z) \, dz
$$é‚£ä¹ˆè®­ç»ƒ $p_\theta(x)$ çš„ä¸€ä¸ªæ˜¾ç„¶çš„æ–¹æ³•æ˜¯ä¼˜åŒ–å…¶ä¸çœŸå®åˆ†å¸ƒ $p(x)$ ä¹‹é—´çš„ KL æ•£åº¦ï¼š
$$
\theta^* = \arg \min_\theta D_{KL}\bigg(p(x) \| p_\theta(x)\bigg)
$$ä¸å¦¨å±•å¼€ KL æ•£åº¦ï¼Œå®¹æ˜“å‘ç°ï¼š
$$
\begin{aligned}
\theta^*
&= \arg \min_\theta D_{KL}\left(p(x) \| p_\theta(x)\right)\\
&= \arg \min_\theta \bigg\{\mathbb{E}_{x\sim p(x)}\left[\log p(x) \right]- \mathbb{E}_{x\sim p(x)}\left[\log p_\theta(x)\right]\bigg\}
\end{aligned}
$$å…¶ä¸­ $\mathbb{E}_{x\sim p(x)}\left[\log p(x) \right]$ å®é™…ä¸Šæ˜¯çœŸå®åˆ†å¸ƒ $p(x)$ çš„ç†µï¼Œä¸åŒ…å«å¯ä»¥ä¼˜åŒ–çš„å‚æ•°ã€‚å¯ä»¥ç›´æ¥æ‰”æ‰ã€‚é‚£ä¹ˆä¼˜åŒ–ç›®æ ‡å¯ä»¥å†™ä½œï¼š
$$
\theta^* = \arg \max_\theta \mathbb{E}_{x\sim p(x)}\left[\log p_\theta(x)\right]
$$ç¦»æ•£çš„ï¼Œå¯¹äºä¸€æ‰¹æ•°æ® $\{x_1, x_2, \cdots, x_n\}$ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¼˜åŒ–ç›®æ ‡æ”¹å†™ä¸ºï¼š"><meta name=author content="WangJV"><link rel=canonical href=https://wangjv0812.cn/2025/10/variational-autoencoder/><link crossorigin=anonymous href=https://wangjv0812.cn/assets/css/stylesheet.2211ca3164be7830024f6aad2b3a2e520843a64f8f048445c3401c1249aa051d.css integrity="sha256-IhHKMWS+eDACT2qtKzouUghDpk+PBIRFw0AcEkmqBR0=" rel="preload stylesheet" as=style><link rel=icon href=https://wangjv0812.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wangjv0812.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wangjv0812.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://wangjv0812.cn/apple-touch-icon.png><link rel=mask-icon href=https://wangjv0812.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://wangjv0812.cn/2025/10/variational-autoencoder/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["\\(","\\)"],["$","$"]],processEscapes:!0,processEnvironments:!0,tags:"ams"},chtml:{scale:1,minScale:.5,matchFontHeight:!1,displayAlign:"center",displayIndent:"0",mtextInheritFont:!1,merrorInheritFont:!0,mathmlSpacing:!1,skipHtmlTags:["script","noscript","style","textarea","pre","code","a"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"},svg:{scale:1,minScale:.5,mtextInheritFont:!1,merrorInheritFont:!0,mathmlSpacing:!1,skipHtmlTags:["script","noscript","style","textarea","pre","code","a"],ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"},options:{enableMenu:!0,menuOptions:{settings:{zoom:"Click"}}},loader:{load:["ui/safe","a11y/assistive-mml"]},startup:{ready(){MathJax.startup.defaultReady();const e=new ResizeObserver(e=>{MathJax.typesetPromise()});e.observe(document.body)}}},window.innerWidth<=768&&(MathJax.chtml=MathJax.chtml||{},MathJax.chtml.scale=.9)</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><style>.MathJax{outline:0}@media(max-width:768px){.MathJax{font-size:90%!important}.MathJax_Display{overflow-x:auto;overflow-y:hidden;padding:0!important;margin:1em 0!important}.MathJax_CHTML{line-height:1.2!important}}mjx-container[jax=CHTML][display=true]{overflow-x:auto;overflow-y:hidden;padding:1px 0}</style><meta property="og:url" content="https://wangjv0812.cn/2025/10/variational-autoencoder/"><meta property="og:site_name" content="WangJV Blog"><meta property="og:title" content="Variational AutoEncoder"><meta property="og:description" content="1. åŠ¨æœºå’Œæ¨å¯¼ å¯¹äºæ— ç›‘ç£çš„æ ·æœ¬ç”Ÿæˆé—®é¢˜ï¼Œæˆ‘ä»¬ä¹‹å‰å·²ç»æåˆ°è¿‡å¾ˆå¤šæ¬¡ï¼Œå¯¹äºä¸€ç³»åˆ—åŒç±»å‹çš„æ•°æ® $\{x_1, x_2, \cdots, x_n\}$ï¼Œæˆ‘ä»¬å‡è®¾å­˜åœ¨ä¸€ä¸ªç†æƒ³çš„åˆ†å¸ƒ $p(x)$ï¼Œè¿™äº›æ•°æ®éƒ½æ˜¯ä»è¿™ä¸ªåˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ°çš„ã€‚ä½†æ˜¯æƒ³ç›´æ¥å­¦ä¹ è¿™ä¸ªåˆ†å¸ƒéå¸¸éš¾ã€‚é‚£ä¹ˆæ˜¯å¦æœ‰å¯èƒ½é€šè¿‡ä¸€ä¸ªè¶³å¤Ÿå¤æ‚çš„ç¥ç»ç½‘ç»œæ¥è¿‘ä¼¼è¿™ä¸ªç†æƒ³åˆ†å¸ƒï¼Ÿæ­¤å¤–ï¼Œæœ‰ä¸€å®šç¥ç»ç»éªŒçš„æœ‹å‹å¾€å¾€æœ‰ä¸€ä¸ªä¿¡å¿µï¼šâ€œå‹ç¼©å³æ™ºèƒ½â€ã€‚é‚£ä¹ˆæ˜¯å¦å¯ä»¥å…ˆå­¦ä¹ ä¸€ä¸ªç¼–ç å™¨ $p(z\mid x)$ å°†åŸæœ‰çš„éšæœºå‘é‡ $x$ å˜æ¢åˆ°ä¸€ä¸ªä½ç»´çš„æ½œç©ºé—´ $z$ï¼Œç„¶åå†é€šè¿‡ä¸€ä¸ªè§£ç å™¨ $p(x\mid z)$ å°†æ½œç©ºé—´çš„å‘é‡ $z$ é‡æ–°æ˜ å°„å›åŸå§‹ç©ºé—´ï¼Œä»è€Œå®ç°å¯¹æ•°æ®çš„ç”Ÿæˆå’Œé‡æ„ï¼Ÿ
å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVariational AutoEncoderï¼‰å°±æ˜¯è¿™ä¸ªæ€è·¯çš„å…·ä½“å®ç°ã€‚æ˜¾ç„¶ï¼Œé€šè¿‡è§£ç å™¨é‡å»ºåˆ†å¸ƒ $p(x)$ å¯ä»¥æè¿°ä¸ºï¼š
$$ p_\theta(x) = \int p_\theta(x\mid z) p(z) \, dz $$é‚£ä¹ˆè®­ç»ƒ $p_\theta(x)$ çš„ä¸€ä¸ªæ˜¾ç„¶çš„æ–¹æ³•æ˜¯ä¼˜åŒ–å…¶ä¸çœŸå®åˆ†å¸ƒ $p(x)$ ä¹‹é—´çš„ KL æ•£åº¦ï¼š
$$ \theta^* = \arg \min_\theta D_{KL}\bigg(p(x) \| p_\theta(x)\bigg) $$ä¸å¦¨å±•å¼€ KL æ•£åº¦ï¼Œå®¹æ˜“å‘ç°ï¼š
$$ \begin{aligned} \theta^* &= \arg \min_\theta D_{KL}\left(p(x) \| p_\theta(x)\right)\\ &= \arg \min_\theta \bigg\{\mathbb{E}_{x\sim p(x)}\left[\log p(x) \right]- \mathbb{E}_{x\sim p(x)}\left[\log p_\theta(x)\right]\bigg\} \end{aligned} $$å…¶ä¸­ $\mathbb{E}_{x\sim p(x)}\left[\log p(x) \right]$ å®é™…ä¸Šæ˜¯çœŸå®åˆ†å¸ƒ $p(x)$ çš„ç†µï¼Œä¸åŒ…å«å¯ä»¥ä¼˜åŒ–çš„å‚æ•°ã€‚å¯ä»¥ç›´æ¥æ‰”æ‰ã€‚é‚£ä¹ˆä¼˜åŒ–ç›®æ ‡å¯ä»¥å†™ä½œï¼š
$$ \theta^* = \arg \max_\theta \mathbb{E}_{x\sim p(x)}\left[\log p_\theta(x)\right] $$ç¦»æ•£çš„ï¼Œå¯¹äºä¸€æ‰¹æ•°æ® $\{x_1, x_2, \cdots, x_n\}$ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¼˜åŒ–ç›®æ ‡æ”¹å†™ä¸ºï¼š"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-10-23T21:24:00+08:00"><meta property="article:modified_time" content="2025-10-23T21:24:00+08:00"><meta property="article:tag" content="Unsupervised Learning"><meta property="article:tag" content="æ•°æ®ç”Ÿæˆ"><meta property="article:tag" content="VAE"><meta property="og:image" content="https://wangjv0812.cn/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://wangjv0812.cn/"><meta name=twitter:title content="Variational AutoEncoder"><meta name=twitter:description content="1. åŠ¨æœºå’Œæ¨å¯¼
å¯¹äºæ— ç›‘ç£çš„æ ·æœ¬ç”Ÿæˆé—®é¢˜ï¼Œæˆ‘ä»¬ä¹‹å‰å·²ç»æåˆ°è¿‡å¾ˆå¤šæ¬¡ï¼Œå¯¹äºä¸€ç³»åˆ—åŒç±»å‹çš„æ•°æ® $\{x_1, x_2, \cdots, x_n\}$ï¼Œæˆ‘ä»¬å‡è®¾å­˜åœ¨ä¸€ä¸ªç†æƒ³çš„åˆ†å¸ƒ $p(x)$ï¼Œè¿™äº›æ•°æ®éƒ½æ˜¯ä»è¿™ä¸ªåˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ°çš„ã€‚ä½†æ˜¯æƒ³ç›´æ¥å­¦ä¹ è¿™ä¸ªåˆ†å¸ƒéå¸¸éš¾ã€‚é‚£ä¹ˆæ˜¯å¦æœ‰å¯èƒ½é€šè¿‡ä¸€ä¸ªè¶³å¤Ÿå¤æ‚çš„ç¥ç»ç½‘ç»œæ¥è¿‘ä¼¼è¿™ä¸ªç†æƒ³åˆ†å¸ƒï¼Ÿæ­¤å¤–ï¼Œæœ‰ä¸€å®šç¥ç»ç»éªŒçš„æœ‹å‹å¾€å¾€æœ‰ä¸€ä¸ªä¿¡å¿µï¼šâ€œå‹ç¼©å³æ™ºèƒ½â€ã€‚é‚£ä¹ˆæ˜¯å¦å¯ä»¥å…ˆå­¦ä¹ ä¸€ä¸ªç¼–ç å™¨ $p(z\mid x)$ å°†åŸæœ‰çš„éšæœºå‘é‡ $x$ å˜æ¢åˆ°ä¸€ä¸ªä½ç»´çš„æ½œç©ºé—´ $z$ï¼Œç„¶åå†é€šè¿‡ä¸€ä¸ªè§£ç å™¨ $p(x\mid z)$ å°†æ½œç©ºé—´çš„å‘é‡ $z$ é‡æ–°æ˜ å°„å›åŸå§‹ç©ºé—´ï¼Œä»è€Œå®ç°å¯¹æ•°æ®çš„ç”Ÿæˆå’Œé‡æ„ï¼Ÿ
å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVariational AutoEncoderï¼‰å°±æ˜¯è¿™ä¸ªæ€è·¯çš„å…·ä½“å®ç°ã€‚æ˜¾ç„¶ï¼Œé€šè¿‡è§£ç å™¨é‡å»ºåˆ†å¸ƒ $p(x)$ å¯ä»¥æè¿°ä¸ºï¼š
$$
p_\theta(x) = \int p_\theta(x\mid z) p(z) \, dz
$$é‚£ä¹ˆè®­ç»ƒ $p_\theta(x)$ çš„ä¸€ä¸ªæ˜¾ç„¶çš„æ–¹æ³•æ˜¯ä¼˜åŒ–å…¶ä¸çœŸå®åˆ†å¸ƒ $p(x)$ ä¹‹é—´çš„ KL æ•£åº¦ï¼š
$$
\theta^* = \arg \min_\theta D_{KL}\bigg(p(x) \| p_\theta(x)\bigg)
$$ä¸å¦¨å±•å¼€ KL æ•£åº¦ï¼Œå®¹æ˜“å‘ç°ï¼š
$$
\begin{aligned}
\theta^*
&= \arg \min_\theta D_{KL}\left(p(x) \| p_\theta(x)\right)\\
&= \arg \min_\theta \bigg\{\mathbb{E}_{x\sim p(x)}\left[\log p(x) \right]- \mathbb{E}_{x\sim p(x)}\left[\log p_\theta(x)\right]\bigg\}
\end{aligned}
$$å…¶ä¸­ $\mathbb{E}_{x\sim p(x)}\left[\log p(x) \right]$ å®é™…ä¸Šæ˜¯çœŸå®åˆ†å¸ƒ $p(x)$ çš„ç†µï¼Œä¸åŒ…å«å¯ä»¥ä¼˜åŒ–çš„å‚æ•°ã€‚å¯ä»¥ç›´æ¥æ‰”æ‰ã€‚é‚£ä¹ˆä¼˜åŒ–ç›®æ ‡å¯ä»¥å†™ä½œï¼š
$$
\theta^* = \arg \max_\theta \mathbb{E}_{x\sim p(x)}\left[\log p_\theta(x)\right]
$$ç¦»æ•£çš„ï¼Œå¯¹äºä¸€æ‰¹æ•°æ® $\{x_1, x_2, \cdots, x_n\}$ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¼˜åŒ–ç›®æ ‡æ”¹å†™ä¸ºï¼š"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wangjv0812.cn/posts/"},{"@type":"ListItem","position":2,"name":"Variational AutoEncoder","item":"https://wangjv0812.cn/2025/10/variational-autoencoder/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Variational AutoEncoder","name":"Variational AutoEncoder","description":"1. åŠ¨æœºå’Œæ¨å¯¼ å¯¹äºæ— ç›‘ç£çš„æ ·æœ¬ç”Ÿæˆé—®é¢˜ï¼Œæˆ‘ä»¬ä¹‹å‰å·²ç»æåˆ°è¿‡å¾ˆå¤šæ¬¡ï¼Œå¯¹äºä¸€ç³»åˆ—åŒç±»å‹çš„æ•°æ® $\\{x_1, x_2, \\cdots, x_n\\}$ï¼Œæˆ‘ä»¬å‡è®¾å­˜åœ¨ä¸€ä¸ªç†æƒ³çš„åˆ†å¸ƒ $p(x)$ï¼Œè¿™äº›æ•°æ®éƒ½æ˜¯ä»è¿™ä¸ªåˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ°çš„ã€‚ä½†æ˜¯æƒ³ç›´æ¥å­¦ä¹ è¿™ä¸ªåˆ†å¸ƒéå¸¸éš¾ã€‚é‚£ä¹ˆæ˜¯å¦æœ‰å¯èƒ½é€šè¿‡ä¸€ä¸ªè¶³å¤Ÿå¤æ‚çš„ç¥ç»ç½‘ç»œæ¥è¿‘ä¼¼è¿™ä¸ªç†æƒ³åˆ†å¸ƒï¼Ÿæ­¤å¤–ï¼Œæœ‰ä¸€å®šç¥ç»ç»éªŒçš„æœ‹å‹å¾€å¾€æœ‰ä¸€ä¸ªä¿¡å¿µï¼šâ€œå‹ç¼©å³æ™ºèƒ½â€ã€‚é‚£ä¹ˆæ˜¯å¦å¯ä»¥å…ˆå­¦ä¹ ä¸€ä¸ªç¼–ç å™¨ $p(z\\mid x)$ å°†åŸæœ‰çš„éšæœºå‘é‡ $x$ å˜æ¢åˆ°ä¸€ä¸ªä½ç»´çš„æ½œç©ºé—´ $z$ï¼Œç„¶åå†é€šè¿‡ä¸€ä¸ªè§£ç å™¨ $p(x\\mid z)$ å°†æ½œç©ºé—´çš„å‘é‡ $z$ é‡æ–°æ˜ å°„å›åŸå§‹ç©ºé—´ï¼Œä»è€Œå®ç°å¯¹æ•°æ®çš„ç”Ÿæˆå’Œé‡æ„ï¼Ÿ\nå˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVariational AutoEncoderï¼‰å°±æ˜¯è¿™ä¸ªæ€è·¯çš„å…·ä½“å®ç°ã€‚æ˜¾ç„¶ï¼Œé€šè¿‡è§£ç å™¨é‡å»ºåˆ†å¸ƒ $p(x)$ å¯ä»¥æè¿°ä¸ºï¼š\n$$ p_\\theta(x) = \\int p_\\theta(x\\mid z) p(z) \\, dz $$é‚£ä¹ˆè®­ç»ƒ $p_\\theta(x)$ çš„ä¸€ä¸ªæ˜¾ç„¶çš„æ–¹æ³•æ˜¯ä¼˜åŒ–å…¶ä¸çœŸå®åˆ†å¸ƒ $p(x)$ ä¹‹é—´çš„ KL æ•£åº¦ï¼š\n$$ \\theta^* = \\arg \\min_\\theta D_{KL}\\bigg(p(x) \\| p_\\theta(x)\\bigg) $$ä¸å¦¨å±•å¼€ KL æ•£åº¦ï¼Œå®¹æ˜“å‘ç°ï¼š\n$$ \\begin{aligned} \\theta^* \u0026= \\arg \\min_\\theta D_{KL}\\left(p(x) \\| p_\\theta(x)\\right)\\\\ \u0026= \\arg \\min_\\theta \\bigg\\{\\mathbb{E}_{x\\sim p(x)}\\left[\\log p(x) \\right]- \\mathbb{E}_{x\\sim p(x)}\\left[\\log p_\\theta(x)\\right]\\bigg\\} \\end{aligned} $$å…¶ä¸­ $\\mathbb{E}_{x\\sim p(x)}\\left[\\log p(x) \\right]$ å®é™…ä¸Šæ˜¯çœŸå®åˆ†å¸ƒ $p(x)$ çš„ç†µï¼Œä¸åŒ…å«å¯ä»¥ä¼˜åŒ–çš„å‚æ•°ã€‚å¯ä»¥ç›´æ¥æ‰”æ‰ã€‚é‚£ä¹ˆä¼˜åŒ–ç›®æ ‡å¯ä»¥å†™ä½œï¼š\n$$ \\theta^* = \\arg \\max_\\theta \\mathbb{E}_{x\\sim p(x)}\\left[\\log p_\\theta(x)\\right] $$ç¦»æ•£çš„ï¼Œå¯¹äºä¸€æ‰¹æ•°æ® $\\{x_1, x_2, \\cdots, x_n\\}$ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¼˜åŒ–ç›®æ ‡æ”¹å†™ä¸ºï¼š\n","keywords":["unsupervised learning","æ•°æ®ç”Ÿæˆ","VAE"],"articleBody":"1. åŠ¨æœºå’Œæ¨å¯¼ å¯¹äºæ— ç›‘ç£çš„æ ·æœ¬ç”Ÿæˆé—®é¢˜ï¼Œæˆ‘ä»¬ä¹‹å‰å·²ç»æåˆ°è¿‡å¾ˆå¤šæ¬¡ï¼Œå¯¹äºä¸€ç³»åˆ—åŒç±»å‹çš„æ•°æ® $\\{x_1, x_2, \\cdots, x_n\\}$ï¼Œæˆ‘ä»¬å‡è®¾å­˜åœ¨ä¸€ä¸ªç†æƒ³çš„åˆ†å¸ƒ $p(x)$ï¼Œè¿™äº›æ•°æ®éƒ½æ˜¯ä»è¿™ä¸ªåˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ°çš„ã€‚ä½†æ˜¯æƒ³ç›´æ¥å­¦ä¹ è¿™ä¸ªåˆ†å¸ƒéå¸¸éš¾ã€‚é‚£ä¹ˆæ˜¯å¦æœ‰å¯èƒ½é€šè¿‡ä¸€ä¸ªè¶³å¤Ÿå¤æ‚çš„ç¥ç»ç½‘ç»œæ¥è¿‘ä¼¼è¿™ä¸ªç†æƒ³åˆ†å¸ƒï¼Ÿæ­¤å¤–ï¼Œæœ‰ä¸€å®šç¥ç»ç»éªŒçš„æœ‹å‹å¾€å¾€æœ‰ä¸€ä¸ªä¿¡å¿µï¼šâ€œå‹ç¼©å³æ™ºèƒ½â€ã€‚é‚£ä¹ˆæ˜¯å¦å¯ä»¥å…ˆå­¦ä¹ ä¸€ä¸ªç¼–ç å™¨ $p(z\\mid x)$ å°†åŸæœ‰çš„éšæœºå‘é‡ $x$ å˜æ¢åˆ°ä¸€ä¸ªä½ç»´çš„æ½œç©ºé—´ $z$ï¼Œç„¶åå†é€šè¿‡ä¸€ä¸ªè§£ç å™¨ $p(x\\mid z)$ å°†æ½œç©ºé—´çš„å‘é‡ $z$ é‡æ–°æ˜ å°„å›åŸå§‹ç©ºé—´ï¼Œä»è€Œå®ç°å¯¹æ•°æ®çš„ç”Ÿæˆå’Œé‡æ„ï¼Ÿ\nå˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVariational AutoEncoderï¼‰å°±æ˜¯è¿™ä¸ªæ€è·¯çš„å…·ä½“å®ç°ã€‚æ˜¾ç„¶ï¼Œé€šè¿‡è§£ç å™¨é‡å»ºåˆ†å¸ƒ $p(x)$ å¯ä»¥æè¿°ä¸ºï¼š\n$$ p_\\theta(x) = \\int p_\\theta(x\\mid z) p(z) \\, dz $$é‚£ä¹ˆè®­ç»ƒ $p_\\theta(x)$ çš„ä¸€ä¸ªæ˜¾ç„¶çš„æ–¹æ³•æ˜¯ä¼˜åŒ–å…¶ä¸çœŸå®åˆ†å¸ƒ $p(x)$ ä¹‹é—´çš„ KL æ•£åº¦ï¼š\n$$ \\theta^* = \\arg \\min_\\theta D_{KL}\\bigg(p(x) \\| p_\\theta(x)\\bigg) $$ä¸å¦¨å±•å¼€ KL æ•£åº¦ï¼Œå®¹æ˜“å‘ç°ï¼š\n$$ \\begin{aligned} \\theta^* \u0026= \\arg \\min_\\theta D_{KL}\\left(p(x) \\| p_\\theta(x)\\right)\\\\ \u0026= \\arg \\min_\\theta \\bigg\\{\\mathbb{E}_{x\\sim p(x)}\\left[\\log p(x) \\right]- \\mathbb{E}_{x\\sim p(x)}\\left[\\log p_\\theta(x)\\right]\\bigg\\} \\end{aligned} $$å…¶ä¸­ $\\mathbb{E}_{x\\sim p(x)}\\left[\\log p(x) \\right]$ å®é™…ä¸Šæ˜¯çœŸå®åˆ†å¸ƒ $p(x)$ çš„ç†µï¼Œä¸åŒ…å«å¯ä»¥ä¼˜åŒ–çš„å‚æ•°ã€‚å¯ä»¥ç›´æ¥æ‰”æ‰ã€‚é‚£ä¹ˆä¼˜åŒ–ç›®æ ‡å¯ä»¥å†™ä½œï¼š\n$$ \\theta^* = \\arg \\max_\\theta \\mathbb{E}_{x\\sim p(x)}\\left[\\log p_\\theta(x)\\right] $$ç¦»æ•£çš„ï¼Œå¯¹äºä¸€æ‰¹æ•°æ® $\\{x_1, x_2, \\cdots, x_n\\}$ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¼˜åŒ–ç›®æ ‡æ”¹å†™ä¸ºï¼š\n$$ \\theta^* = \\arg \\max_\\theta \\frac{1}{n}\\sum_{i=1}^n \\log p_\\theta(x_i) $$ä½†æ˜¯æ­¤æ—¶ï¼Œè®¡ç®— $\\log p_\\theta(x_i)$ ä»ç„¶æ˜¯ä¸€ä¸ªéš¾ç‚¹ã€‚ä¸å¦¨å°† $\\log p_\\theta(x_i)$ çš„å½¢å¼å±•å¼€ï¼Œæœ‰ï¼š\n$$ \\log p_\\theta(x_i) = \\log \\int p_\\theta(x_i, z) \\, dz $$æƒ³ç›´æ¥è®¡ç®—è¿™ä¸ªç§¯åˆ†å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œä¸€ä¸ªæ˜¾ç„¶çš„æ€è·¯æ˜¯ Monto Carlo ç§¯åˆ†ï¼Œå°†è¿™ä¸ªç§¯åˆ†çš„å½¢å¼è½¬æ¢ä¸ºä¸€ä¸ªå¯ä»¥å¯¹éšæœºå˜é‡æœ‰æ•ˆé‡‡æ ·çš„æœŸæœ›çš„å½¢å¼ï¼Œé€šè¿‡ä¸æ–­å¯¹éšæœºå˜é‡é‡‡æ ·ï¼Œå°±å¯ä»¥å¾ˆå®¹æ˜“çš„è®¡ç®—å‡ºç§¯åˆ†çš„ç»“æœäº†ã€‚\nç›¯ç€è¿™ä¸ªå¼å­ï¼Œä¸éš¾å‘ç°ï¼Œæ—¢ç„¶æ˜¯å¯¹ $z$ åšç§¯åˆ†ï¼Œé‚£ä¹ˆè¿™ä¸ªæœŸæœ›æ‰€ä¾èµ–çš„éšæœºå˜é‡ä¸€å®šæ˜¯å…³äº $z$ çš„ã€‚æ­¤æ—¶æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œè¦ä¹ˆç›´æ¥ä½¿ç”¨ $p(z)$ï¼Œè¦ä¹ˆä½¿ç”¨ç¼–ç å™¨ $p_\\psi(z\\mid x_i)$ã€‚å¦‚æœé€‰æ‹© $p(z)$ï¼Œé‚£ä¹ˆä¸Šé¢çš„å½¢å¼å¯ä»¥å†™æˆï¼š\n$$ \\begin{aligned} \\log p_\\theta(x_i) \u0026= \\log \\int p_\\theta(x_i, z) \\, dz\\\\ \u0026= \\log \\mathbb{E}_{z\\sim p(z)}\\left[p_\\theta(x_i \\mid z)\\right] \\end{aligned} $$è¿™ç›¸å½“äºå¸Œæœ›è®­ç»ƒå‡ºä¸€ä¸ª â€œè¿‡äºå¼ºå¤§â€ çš„ç¼–ç ã€‚å¸Œæœ›è®­ç»ƒå‡ºä¸€ä¸ªä»ä»»æ„çš„ $z$ åˆ° $x$ çš„æ˜ å°„ã€‚æˆ‘ä»¬æŠ›å¼ƒäº†ç¼–ç å™¨å¸¦æ¥çš„ï¼Œä»æ•°æ® $x_i$ åˆ° $z_i$ ä¹‹é—´çš„ä¿¡æ¯ã€‚å¦‚æœç›´æ¥è¿™æ ·è®­ç»ƒï¼Œä¼šå¯¼è‡´ $z_i$ åˆ° $x_i$ çš„æ˜ å°„æ˜¯å®Œå…¨éšæœºçš„ï¼Œæ¨¡å‹æ— æ³•å­¦ä¹ åˆ°ä¸€ä¸ªç¨³å®šã€è¿ç»­ä¸”æœ‰æ„ä¹‰çš„æ˜ å°„å…³ç³»ã€‚å› æ­¤æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ç¼–ç å™¨ $p_\\psi(z\\mid x_i)$ æ¥æ„é€ æœŸæœ›ï¼Œä¿ç•™ä¸€äº›ä»æ•°æ® $x_i$ åˆ°æ½œå˜é‡ $z$ çš„ä¿¡æ¯ã€‚é‚£ä¹ˆä¸Šé¢çš„å½¢å¼å¯ä»¥å†™æˆï¼š\n$$ \\begin{aligned} \\log p_\\theta(x_i) \u0026= \\log \\int p_\\theta(x_i, z) \\, dz\\\\ \u0026= \\log \\int p_\\psi(z \\mid x_i) \\frac{p_\\theta(x_i, z)}{p_\\psi(z \\mid x_i)} \\, dz\\\\ \u0026= \\log \\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)}\\left[\\frac{p_\\theta(x_i, z)}{p_\\psi(z \\mid x_i)}\\right] \\end{aligned} $$æˆ‘ä»¬çŸ¥é“ï¼Œ$\\log$ æ˜¯ä¸€ä¸ªå‡¹å‡½æ•°ï¼Œè€ŒæœŸæœ›ç®—å­æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŠ æ€§æ“ä½œã€‚é‚£æ ¹æ® Jensen ä¸ç­‰å¼ï¼Œæœ‰ï¼š\n$$ \\begin{aligned} \\log p_\\theta(x_i) \u0026= \\log \\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)}\\left[\\frac{p_\\theta(x_i, z)}{p_\\psi(z \\mid x_i)}\\right]\\\\ \u0026\\geq \\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)}\\left[\\log \\frac{p_\\theta(x_i, z)}{p_\\psi(z \\mid x_i)}\\right]\\\\ \u0026= \\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)}\\bigg[\\log p_\\theta(x_i \\mid z) + \\log p(z) - \\log p_\\psi(z \\mid x_i)\\bigg]\\\\ \u0026= \\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)} \\bigg[\\log p_\\theta(x_i \\mid z)\\bigg] - \\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)} \\bigg[\\log \\frac{p_\\psi(z \\mid x_i)}{p(z)}\\bigg]\\\\ \u0026= \\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)} \\bigg[\\log p_\\theta(x_i \\mid z)\\bigg] - D_{KL}\\bigg(p_\\psi(z \\mid x_i) \\| p(z)\\bigg) \\end{aligned} $$è¿™ä¸ªå½¢å¼äº‹å®ä¸Šå°±æ˜¯ ELBOï¼ˆEvidence Lower Boundï¼‰çš„å½¢å¼ã€‚å¯¹äºä¸Šé¢è¿™ä¸ªå½¢å¼ï¼Œæˆ‘ä»¬åšè¿™æ ·çš„ç†è§£ï¼š\n$$ \\begin{array}{ll} \\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)} \\bigg[\\log p_\\theta(x_i \\mid z)\\bigg]\u0026 é‡æ„é¡¹\\\\ D_{KL}\\bigg(p_\\psi(z \\mid x_i) \\| p(z)\\bigg)\u0026 KL æ•£åº¦é¡¹\\\\ \\end{array} $$2. å·¥ç¨‹å®è·µ VAE å‡è®¾æ½œå˜é‡å±‚çš„å…ˆéªŒåˆ†å¸ƒ $p(z)$ æ˜¯ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒ $\\mathcal{N}(0, I)$ï¼Œé‚£ä¹ˆä¸€ä¸ªåˆç†çš„å‡è®¾æ˜¯ç¼–ç å™¨ $p_\\psi(z\\mid x)$ å¿…ç„¶å¾ˆæ¥è¿‘äºé«˜æ–¯åˆ†å¸ƒï¼Œä¸å¦¨å°†å…¶å»ºè®¾ä¸ºä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒæ—ã€‚æ­¤å¤–ä¸ºäº†æ–¹ä¾¿å¤„ç†ï¼Œä¸å¦¨åŒæ ·è®¤å®šè§£ç å™¨ $p_\\theta(x\\mid z)$ ä¹Ÿæ˜¯ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒæ—ã€‚é‚£ä¹ˆåœ¨å·¥ç¨‹ä¸Šæˆ‘ä»¬å¯ä»¥åšè¿™æ ·çš„å¤„ç†ï¼š\nå¯¹äºç¼–ç å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œè¾“å…¥æ•°æ® $x$ï¼Œè¾“å‡ºé«˜æ–¯åˆ†å¸ƒæ— $p(z\\mid x)$ çš„å‡å€¼ $\\mu_\\psi(x)$ å’Œæ–¹å·® $\\sigma_\\psi(x)$ã€‚ å¯¹äºè§£ç å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œè¾“å…¥æ½œå˜é‡ $z$ï¼Œè¾“å‡ºé«˜æ–¯åˆ†å¸ƒæ— $p(x\\mid z)$ çš„å‡å€¼ $\\mu_\\theta(z)$ å’Œæ–¹å·® $\\sigma_\\theta(z)$ã€‚ é‚£ä¹ˆå¯¹äºç¬¬ä¸€é¡¹ï¼Œé‡æ„é¡¹å¯ä»¥å†™ä½œï¼š\n$$ \\begin{aligned} \\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)} \\bigg[\\log p_\\theta(x_i \\mid z)\\bigg] \u0026= \\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)} \\bigg[\\log \\mathcal{N}(x_i \\mid \\mu_\\theta(z), \\sigma_\\theta(z))\\bigg]\\\\ \u0026\\sim - \\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)} \\bigg[\\log \\sigma_\\theta(z)\\bigg] - \\frac{1}{2}\\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)} \\bigg[\\frac{(x_i - \\mu_\\theta(z))^2}{\\sigma_\\theta(z)^2}\\bigg] \\end{aligned} $$å¯¹äº KL æ•£åº¦é¡¹ï¼Œç”±äº Gaussian åˆ†å¸ƒçš„ KL æ•£åº¦æœ‰ä¸€ä¸ªè§£æè§£ï¼Œå› æ­¤å¯ä»¥ç›´æ¥å†™ä½œï¼š\n$$ \\begin{aligned} D_{KL}\\bigg(p_\\psi(z \\mid x_i) \\| p(z)\\bigg) \u0026= D_{KL}\\bigg(\\mathcal{N}(\\mu_\\psi(x_i), \\sigma_\\psi(x_i)) \\| \\mathcal{N}(0, I)\\bigg)\\\\ \u0026= \\frac{1}{2} \\sum_{j=1}^d \\left( \\sigma_\\psi(x_i)_j^2 + \\mu_\\psi(x_i)_j^2 - 1 - \\log \\sigma_\\psi(x_i)_j^2 \\right) \\end{aligned} $$æœ€ç»ˆçš„ Loss å½¢å¼å¯ä»¥å†™ä½œï¼š\n$$ \\begin{aligned} L_{VAE}(x_i) \u0026=\\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)} \\bigg[\\log p_\\theta(x_i \\mid z)\\bigg] - D_{KL}\\bigg(p_\\psi(z \\mid x_i) \\| p(z)\\bigg)\\\\ \u0026\\sim - \\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)} \\bigg[\\log \\sigma_\\theta(z)\\bigg]- \\frac{1}{2}\\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)} \\bigg[\\frac{(x_i - \\mu_\\theta(z))^2}{\\sigma_\\theta(z)^2}\\bigg] - \\frac{1}{2} \\sum_{j=1}^d \\left( \\sigma_\\ psi(x_i)_j^2 + \\mu_\\psi(x_i)_j^2 - 1 - \\log \\sigma_\\psi(x_i)_j^2 \\right) \\end{aligned} $$å¯¹è¿™ä¸ªå½¢å¼å—ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç›´è§‚çš„ç†è§£ï¼š\n$\\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)} \\bigg[\\log \\sigma_\\theta(z)\\bigg]$ æ˜¯ä¸€ä¸ªæ­£åˆ™åŒ–é¡¹ï¼Œé¼“åŠ±æ¨¡å‹å°½å¯èƒ½çš„ç¼©å°é¢„æµ‹å‡ºçš„åæ–¹å·®çš„å¤§å°ï¼Œè®©è§£ç å™¨é¢„æµ‹å‡ºçš„ç»“æœæ›´åŠ ç¡®å®šã€‚ $\\frac{1}{2}\\mathbb{E}_{z\\sim p_\\psi(z\\mid x_i)} \\bigg[\\frac{(x_i - \\mu_\\theta(z))^2}{\\sigma_\\theta(z)^2}\\bigg]$ æ˜¯ä¸€ä¸ªç”±ä¸ç¡®å®šæ€§ ï¼ˆ$\\sigma$ï¼‰ åŠ æƒçš„é‡æ„è¯¯å·®ï¼Œäº‹å®ä¸Šå°±æ˜¯ä¸€ä¸ª MLEã€‚ $D_{KL}\\bigg(p_\\psi(z \\mid x_i) \\| p(z)\\bigg)$ ä¹Ÿæ˜¯ä¸€ä¸ªæ­£åˆ™åŒ–é¡¹ï¼Œå®ƒé¼“åŠ±æ¨¡å‹å°½å¯èƒ½çš„è´´è¿‘é«˜æ–¯åˆ†å¸ƒã€‚å…·ä½“ä¸ºä»€ä¹ˆè¦è¿™æ ·æˆ‘ä»¬åç»­ä¼šè®¨è®ºã€‚ æ­¤æ—¶ï¼Œç®—æ³•æµç¨‹æ˜¯è¿™æ ·çš„ï¼š\nä»æ•°æ®é›†ä¸­ä»»é€‰ä¸€ä¸ªæ ·æœ¬ $x_i$ é€šè¿‡ç¼–ç å™¨ï¼Œè®¡ç®—å‡ºä¸€ç»„æ½œå˜é‡çš„åˆ†å¸ƒå‚æ•° $\\mu_\\psi(x_i), \\sigma_\\psi(x_i)$ æ ¹æ® $\\mu_\\psi(x_i), \\sigma_\\psi(x_i)$ æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¡ç®—å‡º KL æ•£åº¦é¡¹ åŒæ ·æ ¹æ® $\\mu_\\psi(x_i), \\sigma_\\psi(x_i)$ï¼Œæˆ‘ä»¬è·å¾—äº†æœŸæœ›æ‰€ä¾èµ–çš„åˆ†å¸ƒ $p_\\psi(z\\mid x) \\sim \\mathcal N(\\mu_\\psi(x_i), \\sigma_\\psi(x_i))$ã€‚ å¯¹ $\\mathcal N(\\mu_\\psi(x_i), \\sigma_\\psi(x_i))$ é‡‡æ ·ï¼Œå³å¯è®¡ç®—å‡ºé‡æ„é¡¹ è®¡ç®— Lossï¼Œæ›´æ–°å‚æ•° 3. è®¨è®º è¦ç†è§£ VAE ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡ï¼Œéœ€è¦å…ˆç†è§£æ­¤å‰ AutoEncoder é¢å¯¹ç€ä»€ä¹ˆé—®é¢˜:\nAutoEncoder è®­ç»ƒå¸¸å¸¸é¢ä¸´å­¦ä¹ å‡ºæ’ç­‰æ˜ å°„è¿™ä¸ªé—®é¢˜ï¼Œå³ç¼–ç å™¨å’Œè§£ç å™¨å¹¶æ²¡æœ‰å­¦ä¹ åˆ°ä»»ä½•æœ‰æ„ä¹‰çš„å¯¹æ•°æ®çš„å‹ç¼©å’Œé‡æ„ï¼Œè€Œæ˜¯ç®€å•çš„å°†å¯¹åº”å…³ç³»è®°å¿†äº†ä¸‹æ¥ã€‚ æˆ‘ä»¬å¸Œæœ› Encoder å­¦ä¹ åˆ°çš„æµ…å˜é‡ä¹‹é—´æ˜¯è¿ç»­ã€ç¨ å¯†ä¸”å¯æ’å€¼çš„ï¼Œä½†æ˜¯æ¨¡å‹å¾€å¾€ä¸éšäººæ‰€æ„¿ã€‚å¯¹äºæ¨¡å‹è€Œè¨€ï¼Œæœ€çœäº‹çš„æ–¹æ³•æ˜¯å°†ä¸åŒæ¨¡å¼ä¹‹é—´çš„æµ…å˜é‡å°½å¯èƒ½çš„æ‹‰è¿œé¿å…æ··æ·†ï¼Œä¸åŒæ¨¡å¼çš„æµ…å˜é‡ä¹‹é—´å°±å‡ºç°äº†å¾ˆå¤šæ— æ„ä¹‰çš„ç©ºéš™ï¼Œå¯¼è‡´å·®å€¼æ¯«æ— æ„ä¹‰ã€‚ ä¸ºäº†è§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¹¶ä¸ç›´æ¥å°† Encoder çš„è¾“å‡ºäº¤ç»™ Decoder æ¥è§£ç ï¼Œè€Œæ˜¯è®© Encoder è¾“å‡ºä¸€ä¸ªåˆ†å¸ƒï¼Œä¹‹ååœ¨è¿™ä¸ªåˆ†å¸ƒä¸­åšä¸€æ¬¡é‡‡æ ·ï¼Œå°†é‡‡æ ·äº¤ç»™ Decoder æ¥è§£ç ã€‚è¿™æ ·ä»æ ¹æœ¬ä¸Šæœç»äº†å­¦ä¹ æ’ç­‰æ˜ å°„çš„å¯èƒ½æ€§ã€‚\næ›´ä¸ºå·§å¦™çš„æ˜¯ VAE åŒæ ·å¾ˆå¥½çš„è§£å†³äº†ç¬¬äºŒä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ä¸å¦¨æ€è€ƒä¸€ä¸‹ï¼Œå¦‚æœå»æ‰ KL æ•£åº¦é¡¹ä¼šæ€æ ·ï¼Ÿäº‹å®ä¸Šæ¨¡å‹ä¼šå¤©ç„¶çš„å°† Latent Space çš„åæ–¹å·®æ¸å°ï¼Œæ¶ˆé™¤ä¸ç¡®å®šæ€§ï¼Œè¿™æ ·é¢„æµ‹çš„ç»“æœä¼šæ›´åŠ ç®€å•ç¡®å®šã€‚ç”±æ­¤é€€åŒ–ä¸ºä¸€ä¸ªç»å…¸çš„ AEã€‚é‚£ä¹ˆæ­¤æ—¶ä¸åŒæ¨¡å¼çš„æµ…å˜é‡å±‚ä¹‹é—´çš„ç©ºéš™ä¼šå˜å¤§ï¼Œå·®å€¼æ•ˆæœå°±ä¼šå¾ˆå·®ã€‚KL æ•£åº¦é¡¹äº‹å®ä¸Šå¼ºåˆ¶ä¿è¯äº† Latent Space å…·æœ‰è¶³å¤Ÿçš„éšæœºæ€§ï¼ˆåæ–¹å·®æ¥è¿‘ Iï¼‰ï¼ŒåŒæ—¶è¿˜ä¿è¯ Latent Space åˆ†å¸ƒçš„å‡å€¼è¿˜å¾—è¶³å¤Ÿ â€œç¨ å¯†â€ çš„åˆ†å¸ƒåœ¨åŸç‚¹é™„è¿‘ã€‚è¿™ä¸ªæ–¹æ³•å¼ºè¿«æ¨¡å‹å­¦ä¹ åˆ°ä¸€ä¸ªè¿ç»­ã€ç¨ å¯†ä¸”å¯æ’å€¼çš„ Latent Spaceï¼Œä»è€Œä¿è¯äº†å·®å€¼çš„æœ‰æ•ˆæ€§å’Œå­¦ä¹ çš„æ•ˆç‡ã€‚æ—¶æ˜¯ä¸Šï¼ŒVAE ä¸­çš„ Variational æ­£æ˜¯æŒ‡çš„è¿™ç§é€šè¿‡ KL æ•£åº¦æ¥æ­£åˆ™åŒ–æ½œå˜é‡åˆ†å¸ƒçš„æ€æƒ³ã€‚\nReferences ","wordCount":"537","inLanguage":"en","image":"https://wangjv0812.cn/","datePublished":"2025-10-23T21:24:00+08:00","dateModified":"2025-10-23T21:24:00+08:00","author":{"@type":"Person","name":"WangJV"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wangjv0812.cn/2025/10/variational-autoencoder/"},"publisher":{"@type":"Organization","name":"WangJV Blog","logo":{"@type":"ImageObject","url":"https://wangjv0812.cn/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wangjv0812.cn/ accesskey=h title="WangJV Blog (Alt + H)">WangJV Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wangjv0812.cn/ title=Home><span>Home</span></a></li><li><a href=https://wangjv0812.cn/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://wangjv0812.cn/resources/ title=Resources><span>Resources</span></a></li><li><a href=https://wangjv0812.cn/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://wangjv0812.cn/search/ title="ğŸ” Search (Alt + /)" accesskey=/><span>ğŸ” Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wangjv0812.cn/>Home</a>&nbsp;Â»&nbsp;<a href=https://wangjv0812.cn/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Variational AutoEncoder</h1><div class=post-meta><span title='2025-10-23 21:24:00 +0800 +0800'>October 23, 2025</span>&nbsp;Â·&nbsp;WangJV&nbsp;|&nbsp;<a href=https://github.com/WangJV0812/WangJV-Blog-Source/tree/master/content/posts/Variational%20Auto%20Encoder/index.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#1-åŠ¨æœºå’Œæ¨å¯¼>1. åŠ¨æœºå’Œæ¨å¯¼</a></li><li><a href=#2-å·¥ç¨‹å®è·µ>2. å·¥ç¨‹å®è·µ</a></li><li><a href=#3-è®¨è®º>3. è®¨è®º</a></li><li><a href=#references>References</a></li></ul></nav></div></details></div><div class=post-content><h2 id=1-åŠ¨æœºå’Œæ¨å¯¼>1. åŠ¨æœºå’Œæ¨å¯¼<a hidden class=anchor aria-hidden=true href=#1-åŠ¨æœºå’Œæ¨å¯¼>#</a></h2><p>å¯¹äºæ— ç›‘ç£çš„æ ·æœ¬ç”Ÿæˆé—®é¢˜ï¼Œæˆ‘ä»¬ä¹‹å‰å·²ç»æåˆ°è¿‡å¾ˆå¤šæ¬¡ï¼Œå¯¹äºä¸€ç³»åˆ—åŒç±»å‹çš„æ•°æ® $\{x_1, x_2, \cdots, x_n\}$ï¼Œæˆ‘ä»¬å‡è®¾å­˜åœ¨ä¸€ä¸ªç†æƒ³çš„åˆ†å¸ƒ $p(x)$ï¼Œè¿™äº›æ•°æ®éƒ½æ˜¯ä»è¿™ä¸ªåˆ†å¸ƒä¸­é‡‡æ ·å¾—åˆ°çš„ã€‚ä½†æ˜¯æƒ³ç›´æ¥å­¦ä¹ è¿™ä¸ªåˆ†å¸ƒéå¸¸éš¾ã€‚é‚£ä¹ˆæ˜¯å¦æœ‰å¯èƒ½é€šè¿‡ä¸€ä¸ªè¶³å¤Ÿå¤æ‚çš„ç¥ç»ç½‘ç»œæ¥è¿‘ä¼¼è¿™ä¸ªç†æƒ³åˆ†å¸ƒï¼Ÿæ­¤å¤–ï¼Œæœ‰ä¸€å®šç¥ç»ç»éªŒçš„æœ‹å‹å¾€å¾€æœ‰ä¸€ä¸ªä¿¡å¿µï¼šâ€œ<em>å‹ç¼©å³æ™ºèƒ½</em>â€ã€‚é‚£ä¹ˆæ˜¯å¦å¯ä»¥å…ˆå­¦ä¹ ä¸€ä¸ªç¼–ç å™¨ $p(z\mid x)$ å°†åŸæœ‰çš„éšæœºå‘é‡ $x$ å˜æ¢åˆ°ä¸€ä¸ªä½ç»´çš„æ½œç©ºé—´ $z$ï¼Œç„¶åå†é€šè¿‡ä¸€ä¸ªè§£ç å™¨ $p(x\mid z)$ å°†æ½œç©ºé—´çš„å‘é‡ $z$ é‡æ–°æ˜ å°„å›åŸå§‹ç©ºé—´ï¼Œä»è€Œå®ç°å¯¹æ•°æ®çš„ç”Ÿæˆå’Œé‡æ„ï¼Ÿ</p><p>å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVariational AutoEncoderï¼‰å°±æ˜¯è¿™ä¸ªæ€è·¯çš„å…·ä½“å®ç°ã€‚æ˜¾ç„¶ï¼Œé€šè¿‡è§£ç å™¨é‡å»ºåˆ†å¸ƒ $p(x)$ å¯ä»¥æè¿°ä¸ºï¼š</p>$$
p_\theta(x) = \int p_\theta(x\mid z) p(z) \, dz
$$<p>é‚£ä¹ˆè®­ç»ƒ $p_\theta(x)$ çš„ä¸€ä¸ªæ˜¾ç„¶çš„æ–¹æ³•æ˜¯ä¼˜åŒ–å…¶ä¸çœŸå®åˆ†å¸ƒ $p(x)$ ä¹‹é—´çš„ KL æ•£åº¦ï¼š</p>$$
\theta^* = \arg \min_\theta D_{KL}\bigg(p(x) \| p_\theta(x)\bigg)
$$<p>ä¸å¦¨å±•å¼€ KL æ•£åº¦ï¼Œå®¹æ˜“å‘ç°ï¼š</p>$$
\begin{aligned}
\theta^*
&= \arg \min_\theta D_{KL}\left(p(x) \| p_\theta(x)\right)\\
&= \arg \min_\theta \bigg\{\mathbb{E}_{x\sim p(x)}\left[\log p(x) \right]- \mathbb{E}_{x\sim p(x)}\left[\log p_\theta(x)\right]\bigg\}
\end{aligned}
$$<p>å…¶ä¸­ $\mathbb{E}_{x\sim p(x)}\left[\log p(x) \right]$ å®é™…ä¸Šæ˜¯çœŸå®åˆ†å¸ƒ $p(x)$ çš„ç†µï¼Œä¸åŒ…å«å¯ä»¥ä¼˜åŒ–çš„å‚æ•°ã€‚å¯ä»¥ç›´æ¥æ‰”æ‰ã€‚é‚£ä¹ˆä¼˜åŒ–ç›®æ ‡å¯ä»¥å†™ä½œï¼š</p>$$
\theta^* = \arg \max_\theta \mathbb{E}_{x\sim p(x)}\left[\log p_\theta(x)\right]
$$<p>ç¦»æ•£çš„ï¼Œå¯¹äºä¸€æ‰¹æ•°æ® $\{x_1, x_2, \cdots, x_n\}$ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¼˜åŒ–ç›®æ ‡æ”¹å†™ä¸ºï¼š</p>$$
\theta^* = \arg \max_\theta \frac{1}{n}\sum_{i=1}^n \log p_\theta(x_i)
$$<p>ä½†æ˜¯æ­¤æ—¶ï¼Œè®¡ç®— $\log p_\theta(x_i)$ ä»ç„¶æ˜¯ä¸€ä¸ªéš¾ç‚¹ã€‚ä¸å¦¨å°† $\log p_\theta(x_i)$ çš„å½¢å¼å±•å¼€ï¼Œæœ‰ï¼š</p>$$
\log p_\theta(x_i) = \log \int p_\theta(x_i, z) \, dz
$$<p>æƒ³ç›´æ¥è®¡ç®—è¿™ä¸ªç§¯åˆ†å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œä¸€ä¸ªæ˜¾ç„¶çš„æ€è·¯æ˜¯ Monto Carlo ç§¯åˆ†ï¼Œå°†è¿™ä¸ªç§¯åˆ†çš„å½¢å¼è½¬æ¢ä¸ºä¸€ä¸ªå¯ä»¥å¯¹éšæœºå˜é‡æœ‰æ•ˆé‡‡æ ·çš„æœŸæœ›çš„å½¢å¼ï¼Œé€šè¿‡ä¸æ–­å¯¹éšæœºå˜é‡é‡‡æ ·ï¼Œå°±å¯ä»¥å¾ˆå®¹æ˜“çš„è®¡ç®—å‡ºç§¯åˆ†çš„ç»“æœäº†ã€‚</p><p>ç›¯ç€è¿™ä¸ªå¼å­ï¼Œä¸éš¾å‘ç°ï¼Œæ—¢ç„¶æ˜¯å¯¹ $z$ åšç§¯åˆ†ï¼Œé‚£ä¹ˆè¿™ä¸ªæœŸæœ›æ‰€ä¾èµ–çš„éšæœºå˜é‡ä¸€å®šæ˜¯å…³äº $z$ çš„ã€‚æ­¤æ—¶æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œè¦ä¹ˆç›´æ¥ä½¿ç”¨ $p(z)$ï¼Œè¦ä¹ˆä½¿ç”¨ç¼–ç å™¨ $p_\psi(z\mid x_i)$ã€‚å¦‚æœé€‰æ‹© $p(z)$ï¼Œé‚£ä¹ˆä¸Šé¢çš„å½¢å¼å¯ä»¥å†™æˆï¼š</p>$$
\begin{aligned}
\log p_\theta(x_i)
&= \log \int p_\theta(x_i, z) \, dz\\
&= \log \mathbb{E}_{z\sim p(z)}\left[p_\theta(x_i \mid z)\right]
\end{aligned}
$$<p>è¿™ç›¸å½“äºå¸Œæœ›è®­ç»ƒå‡ºä¸€ä¸ª â€œè¿‡äºå¼ºå¤§â€ çš„ç¼–ç ã€‚å¸Œæœ›è®­ç»ƒå‡ºä¸€ä¸ªä»ä»»æ„çš„ $z$ åˆ° $x$ çš„æ˜ å°„ã€‚æˆ‘ä»¬æŠ›å¼ƒäº†ç¼–ç å™¨å¸¦æ¥çš„ï¼Œä»æ•°æ® $x_i$ åˆ° $z_i$ ä¹‹é—´çš„ä¿¡æ¯ã€‚å¦‚æœç›´æ¥è¿™æ ·è®­ç»ƒï¼Œä¼šå¯¼è‡´ $z_i$ åˆ° $x_i$ çš„æ˜ å°„æ˜¯å®Œå…¨éšæœºçš„ï¼Œæ¨¡å‹æ— æ³•å­¦ä¹ åˆ°ä¸€ä¸ªç¨³å®šã€è¿ç»­ä¸”æœ‰æ„ä¹‰çš„æ˜ å°„å…³ç³»ã€‚å› æ­¤æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ç¼–ç å™¨ $p_\psi(z\mid x_i)$ æ¥æ„é€ æœŸæœ›ï¼Œä¿ç•™ä¸€äº›ä»æ•°æ® $x_i$ åˆ°æ½œå˜é‡ $z$ çš„ä¿¡æ¯ã€‚é‚£ä¹ˆä¸Šé¢çš„å½¢å¼å¯ä»¥å†™æˆï¼š</p>$$
\begin{aligned}
\log p_\theta(x_i)
&= \log \int p_\theta(x_i, z) \, dz\\
&= \log \int p_\psi(z \mid x_i) \frac{p_\theta(x_i, z)}{p_\psi(z \mid x_i)} \, dz\\
&= \log \mathbb{E}_{z\sim p_\psi(z\mid x_i)}\left[\frac{p_\theta(x_i, z)}{p_\psi(z \mid x_i)}\right]
\end{aligned}
$$<p>æˆ‘ä»¬çŸ¥é“ï¼Œ$\log$ æ˜¯ä¸€ä¸ªå‡¹å‡½æ•°ï¼Œè€ŒæœŸæœ›ç®—å­æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŠ æ€§æ“ä½œã€‚é‚£æ ¹æ® Jensen ä¸ç­‰å¼ï¼Œæœ‰ï¼š</p>$$
\begin{aligned}
\log p_\theta(x_i)
&= \log \mathbb{E}_{z\sim p_\psi(z\mid x_i)}\left[\frac{p_\theta(x_i, z)}{p_\psi(z \mid x_i)}\right]\\
&\geq \mathbb{E}_{z\sim p_\psi(z\mid x_i)}\left[\log \frac{p_\theta(x_i, z)}{p_\psi(z \mid x_i)}\right]\\
&= \mathbb{E}_{z\sim p_\psi(z\mid x_i)}\bigg[\log p_\theta(x_i \mid z) + \log p(z) - \log p_\psi(z \mid x_i)\bigg]\\
&= \mathbb{E}_{z\sim p_\psi(z\mid x_i)} \bigg[\log p_\theta(x_i \mid z)\bigg] - \mathbb{E}_{z\sim p_\psi(z\mid x_i)} \bigg[\log \frac{p_\psi(z \mid x_i)}{p(z)}\bigg]\\
&= \mathbb{E}_{z\sim p_\psi(z\mid x_i)} \bigg[\log p_\theta(x_i \mid z)\bigg] - D_{KL}\bigg(p_\psi(z \mid x_i) \| p(z)\bigg)
\end{aligned}
$$<p>è¿™ä¸ªå½¢å¼äº‹å®ä¸Šå°±æ˜¯ ELBOï¼ˆEvidence Lower Boundï¼‰çš„å½¢å¼ã€‚å¯¹äºä¸Šé¢è¿™ä¸ªå½¢å¼ï¼Œæˆ‘ä»¬åšè¿™æ ·çš„ç†è§£ï¼š</p>$$
\begin{array}{ll}
\mathbb{E}_{z\sim p_\psi(z\mid x_i)} \bigg[\log p_\theta(x_i \mid z)\bigg]& é‡æ„é¡¹\\
D_{KL}\bigg(p_\psi(z \mid x_i) \| p(z)\bigg)& KL æ•£åº¦é¡¹\\
\end{array}
$$<h2 id=2-å·¥ç¨‹å®è·µ>2. å·¥ç¨‹å®è·µ<a hidden class=anchor aria-hidden=true href=#2-å·¥ç¨‹å®è·µ>#</a></h2><p>VAE å‡è®¾æ½œå˜é‡å±‚çš„å…ˆéªŒåˆ†å¸ƒ $p(z)$ æ˜¯ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒ $\mathcal{N}(0, I)$ï¼Œé‚£ä¹ˆä¸€ä¸ªåˆç†çš„å‡è®¾æ˜¯ç¼–ç å™¨ $p_\psi(z\mid x)$ å¿…ç„¶å¾ˆæ¥è¿‘äºé«˜æ–¯åˆ†å¸ƒï¼Œä¸å¦¨å°†å…¶å»ºè®¾ä¸ºä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒæ—ã€‚æ­¤å¤–ä¸ºäº†æ–¹ä¾¿å¤„ç†ï¼Œä¸å¦¨åŒæ ·è®¤å®šè§£ç å™¨ $p_\theta(x\mid z)$ ä¹Ÿæ˜¯ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒæ—ã€‚é‚£ä¹ˆåœ¨å·¥ç¨‹ä¸Šæˆ‘ä»¬å¯ä»¥åšè¿™æ ·çš„å¤„ç†ï¼š</p><ol><li>å¯¹äºç¼–ç å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œè¾“å…¥æ•°æ® $x$ï¼Œè¾“å‡ºé«˜æ–¯åˆ†å¸ƒæ— $p(z\mid x)$ çš„å‡å€¼ $\mu_\psi(x)$ å’Œæ–¹å·® $\sigma_\psi(x)$ã€‚</li><li>å¯¹äºè§£ç å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œè¾“å…¥æ½œå˜é‡ $z$ï¼Œè¾“å‡ºé«˜æ–¯åˆ†å¸ƒæ— $p(x\mid z)$ çš„å‡å€¼ $\mu_\theta(z)$ å’Œæ–¹å·® $\sigma_\theta(z)$ã€‚</li></ol><p>é‚£ä¹ˆå¯¹äºç¬¬ä¸€é¡¹ï¼Œé‡æ„é¡¹å¯ä»¥å†™ä½œï¼š</p>$$
\begin{aligned}
\mathbb{E}_{z\sim p_\psi(z\mid x_i)} \bigg[\log p_\theta(x_i \mid z)\bigg]
&= \mathbb{E}_{z\sim p_\psi(z\mid x_i)} \bigg[\log \mathcal{N}(x_i \mid \mu_\theta(z), \sigma_\theta(z))\bigg]\\
&\sim - \mathbb{E}_{z\sim p_\psi(z\mid x_i)} \bigg[\log \sigma_\theta(z)\bigg] - \frac{1}{2}\mathbb{E}_{z\sim p_\psi(z\mid x_i)} \bigg[\frac{(x_i - \mu_\theta(z))^2}{\sigma_\theta(z)^2}\bigg]
\end{aligned}
$$<p>å¯¹äº KL æ•£åº¦é¡¹ï¼Œç”±äº Gaussian åˆ†å¸ƒçš„ KL æ•£åº¦æœ‰ä¸€ä¸ªè§£æè§£ï¼Œå› æ­¤å¯ä»¥ç›´æ¥å†™ä½œï¼š</p>$$
\begin{aligned}
D_{KL}\bigg(p_\psi(z \mid x_i) \| p(z)\bigg)
&= D_{KL}\bigg(\mathcal{N}(\mu_\psi(x_i), \sigma_\psi(x_i)) \| \mathcal{N}(0, I)\bigg)\\
&= \frac{1}{2} \sum_{j=1}^d \left( \sigma_\psi(x_i)_j^2 + \mu_\psi(x_i)_j^2 - 1 - \log \sigma_\psi(x_i)_j^2 \right)
\end{aligned}
$$<p>æœ€ç»ˆçš„ Loss å½¢å¼å¯ä»¥å†™ä½œï¼š</p>$$
\begin{aligned}
L_{VAE}(x_i)
&=\mathbb{E}_{z\sim p_\psi(z\mid x_i)} \bigg[\log p_\theta(x_i \mid z)\bigg] - D_{KL}\bigg(p_\psi(z \mid x_i) \| p(z)\bigg)\\
&\sim - \mathbb{E}_{z\sim p_\psi(z\mid x_i)} \bigg[\log \sigma_\theta(z)\bigg]- \frac{1}{2}\mathbb{E}_{z\sim p_\psi(z\mid x_i)} \bigg[\frac{(x_i - \mu_\theta(z))^2}{\sigma_\theta(z)^2}\bigg] - \frac{1}{2} \sum_{j=1}^d \left( \sigma_\ psi(x_i)_j^2 + \mu_\psi(x_i)_j^2 - 1 - \log \sigma_\psi(x_i)_j^2 \right)
\end{aligned}
$$<p>å¯¹è¿™ä¸ªå½¢å¼å—ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç›´è§‚çš„ç†è§£ï¼š</p><ol><li>$\mathbb{E}_{z\sim p_\psi(z\mid x_i)} \bigg[\log \sigma_\theta(z)\bigg]$ æ˜¯ä¸€ä¸ªæ­£åˆ™åŒ–é¡¹ï¼Œé¼“åŠ±æ¨¡å‹å°½å¯èƒ½çš„ç¼©å°é¢„æµ‹å‡ºçš„åæ–¹å·®çš„å¤§å°ï¼Œè®©è§£ç å™¨é¢„æµ‹å‡ºçš„ç»“æœæ›´åŠ ç¡®å®šã€‚</li><li>$\frac{1}{2}\mathbb{E}_{z\sim p_\psi(z\mid x_i)} \bigg[\frac{(x_i - \mu_\theta(z))^2}{\sigma_\theta(z)^2}\bigg]$ æ˜¯ä¸€ä¸ªç”±ä¸ç¡®å®šæ€§ ï¼ˆ$\sigma$ï¼‰ åŠ æƒçš„é‡æ„è¯¯å·®ï¼Œäº‹å®ä¸Šå°±æ˜¯ä¸€ä¸ª MLEã€‚</li><li>$D_{KL}\bigg(p_\psi(z \mid x_i) \| p(z)\bigg)$ ä¹Ÿæ˜¯ä¸€ä¸ªæ­£åˆ™åŒ–é¡¹ï¼Œå®ƒé¼“åŠ±æ¨¡å‹å°½å¯èƒ½çš„è´´è¿‘é«˜æ–¯åˆ†å¸ƒã€‚å…·ä½“ä¸ºä»€ä¹ˆè¦è¿™æ ·æˆ‘ä»¬åç»­ä¼šè®¨è®ºã€‚</li></ol><p>æ­¤æ—¶ï¼Œç®—æ³•æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ol><li>ä»æ•°æ®é›†ä¸­ä»»é€‰ä¸€ä¸ªæ ·æœ¬ $x_i$</li><li>é€šè¿‡ç¼–ç å™¨ï¼Œè®¡ç®—å‡ºä¸€ç»„æ½œå˜é‡çš„åˆ†å¸ƒå‚æ•° $\mu_\psi(x_i), \sigma_\psi(x_i)$</li><li>æ ¹æ® $\mu_\psi(x_i), \sigma_\psi(x_i)$ æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¡ç®—å‡º KL æ•£åº¦é¡¹</li><li>åŒæ ·æ ¹æ® $\mu_\psi(x_i), \sigma_\psi(x_i)$ï¼Œæˆ‘ä»¬è·å¾—äº†æœŸæœ›æ‰€ä¾èµ–çš„åˆ†å¸ƒ $p_\psi(z\mid x) \sim \mathcal N(\mu_\psi(x_i), \sigma_\psi(x_i))$ã€‚</li><li>å¯¹ $\mathcal N(\mu_\psi(x_i), \sigma_\psi(x_i))$ é‡‡æ ·ï¼Œå³å¯è®¡ç®—å‡ºé‡æ„é¡¹</li><li>è®¡ç®— Lossï¼Œæ›´æ–°å‚æ•°</li></ol><h2 id=3-è®¨è®º>3. è®¨è®º<a hidden class=anchor aria-hidden=true href=#3-è®¨è®º>#</a></h2><p>è¦ç†è§£ VAE ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡ï¼Œéœ€è¦å…ˆç†è§£æ­¤å‰ AutoEncoder é¢å¯¹ç€ä»€ä¹ˆé—®é¢˜:</p><ol><li>AutoEncoder è®­ç»ƒå¸¸å¸¸é¢ä¸´å­¦ä¹ å‡ºæ’ç­‰æ˜ å°„è¿™ä¸ªé—®é¢˜ï¼Œå³ç¼–ç å™¨å’Œè§£ç å™¨å¹¶æ²¡æœ‰å­¦ä¹ åˆ°ä»»ä½•æœ‰æ„ä¹‰çš„å¯¹æ•°æ®çš„å‹ç¼©å’Œé‡æ„ï¼Œè€Œæ˜¯ç®€å•çš„å°†å¯¹åº”å…³ç³»è®°å¿†äº†ä¸‹æ¥ã€‚</li><li>æˆ‘ä»¬å¸Œæœ› Encoder å­¦ä¹ åˆ°çš„æµ…å˜é‡ä¹‹é—´æ˜¯è¿ç»­ã€ç¨ å¯†ä¸”å¯æ’å€¼çš„ï¼Œä½†æ˜¯æ¨¡å‹å¾€å¾€ä¸éšäººæ‰€æ„¿ã€‚å¯¹äºæ¨¡å‹è€Œè¨€ï¼Œæœ€çœäº‹çš„æ–¹æ³•æ˜¯å°†ä¸åŒæ¨¡å¼ä¹‹é—´çš„æµ…å˜é‡å°½å¯èƒ½çš„æ‹‰è¿œé¿å…æ··æ·†ï¼Œä¸åŒæ¨¡å¼çš„æµ…å˜é‡ä¹‹é—´å°±å‡ºç°äº†å¾ˆå¤šæ— æ„ä¹‰çš„ç©ºéš™ï¼Œå¯¼è‡´å·®å€¼æ¯«æ— æ„ä¹‰ã€‚</li></ol><p>ä¸ºäº†è§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¹¶ä¸ç›´æ¥å°† Encoder çš„è¾“å‡ºäº¤ç»™ Decoder æ¥è§£ç ï¼Œè€Œæ˜¯è®© Encoder è¾“å‡ºä¸€ä¸ªåˆ†å¸ƒï¼Œä¹‹ååœ¨è¿™ä¸ªåˆ†å¸ƒä¸­åšä¸€æ¬¡é‡‡æ ·ï¼Œå°†é‡‡æ ·äº¤ç»™ Decoder æ¥è§£ç ã€‚è¿™æ ·ä»æ ¹æœ¬ä¸Šæœç»äº†å­¦ä¹ æ’ç­‰æ˜ å°„çš„å¯èƒ½æ€§ã€‚</p><p>æ›´ä¸ºå·§å¦™çš„æ˜¯ VAE åŒæ ·å¾ˆå¥½çš„è§£å†³äº†ç¬¬äºŒä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ä¸å¦¨æ€è€ƒä¸€ä¸‹ï¼Œå¦‚æœå»æ‰ KL æ•£åº¦é¡¹ä¼šæ€æ ·ï¼Ÿäº‹å®ä¸Šæ¨¡å‹ä¼šå¤©ç„¶çš„å°† Latent Space çš„åæ–¹å·®æ¸å°ï¼Œæ¶ˆé™¤ä¸ç¡®å®šæ€§ï¼Œè¿™æ ·é¢„æµ‹çš„ç»“æœä¼šæ›´åŠ ç®€å•ç¡®å®šã€‚ç”±æ­¤é€€åŒ–ä¸ºä¸€ä¸ªç»å…¸çš„ AEã€‚é‚£ä¹ˆæ­¤æ—¶ä¸åŒæ¨¡å¼çš„æµ…å˜é‡å±‚ä¹‹é—´çš„ç©ºéš™ä¼šå˜å¤§ï¼Œå·®å€¼æ•ˆæœå°±ä¼šå¾ˆå·®ã€‚KL æ•£åº¦é¡¹äº‹å®ä¸Šå¼ºåˆ¶ä¿è¯äº† Latent Space å…·æœ‰è¶³å¤Ÿçš„éšæœºæ€§ï¼ˆåæ–¹å·®æ¥è¿‘ Iï¼‰ï¼ŒåŒæ—¶è¿˜ä¿è¯ Latent Space åˆ†å¸ƒçš„å‡å€¼è¿˜å¾—è¶³å¤Ÿ â€œç¨ å¯†â€ çš„åˆ†å¸ƒåœ¨åŸç‚¹é™„è¿‘ã€‚è¿™ä¸ªæ–¹æ³•å¼ºè¿«æ¨¡å‹å­¦ä¹ åˆ°ä¸€ä¸ªè¿ç»­ã€ç¨ å¯†ä¸”å¯æ’å€¼çš„ Latent Spaceï¼Œä»è€Œä¿è¯äº†å·®å€¼çš„æœ‰æ•ˆæ€§å’Œå­¦ä¹ çš„æ•ˆç‡ã€‚æ—¶æ˜¯ä¸Šï¼ŒVAE ä¸­çš„ Variational æ­£æ˜¯æŒ‡çš„è¿™ç§é€šè¿‡ KL æ•£åº¦æ¥æ­£åˆ™åŒ–æ½œå˜é‡åˆ†å¸ƒçš„æ€æƒ³ã€‚</p><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://wangjv0812.cn/tags/unsupervised-learning/>Unsupervised Learning</a></li><li><a href=https://wangjv0812.cn/tags/%E6%95%B0%E6%8D%AE%E7%94%9F%E6%88%90/>æ•°æ®ç”Ÿæˆ</a></li><li><a href=https://wangjv0812.cn/tags/vae/>VAE</a></li></ul><nav class=paginav><a class=next href=https://wangjv0812.cn/2025/10/denoising-score-matching/><span class=title>Next Â»</span><br><span>Denoising Score Matching</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://wangjv0812.cn/>WangJV Blog</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>